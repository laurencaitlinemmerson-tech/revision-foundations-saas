<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nursing Theory Quiz</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  
<style>
  @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap');

  * { font-family: 'Outfit', system-ui, sans-serif; }
  .mono { font-family: 'JetBrains Mono', monospace; }

  body { box-sizing: border-box; }
  html, body { height: 100%; margin: 0; overflow: auto; }

  .main-wrapper { min-height: 100%; width: 100%; }

  /* ---------- Background ---------- */
  .gradient-bg {
    background: linear-gradient(
      135deg,
      #1a0b2e 0%,
      #2d1b4e 25%,
      #4a1f6f 50%,
      #6b2d8f 75%,
      #8b3da0 100%
    );
    position: relative;
    overflow: hidden;
  }

  .gradient-bg::before {
    content: '';
    position: absolute;
    inset: 0;
    background:
      radial-gradient(circle at 20% 20%, rgba(167, 70, 224, 0.15) 0%, transparent 50%),
      radial-gradient(circle at 80% 80%, rgba(244, 114, 182, 0.15) 0%, transparent 50%);
    pointer-events: none;
  }

  .particle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    pointer-events: none;
    animation: float 20s infinite;
  }

  @keyframes float {
    0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.3; }
    25% { transform: translate(30px, -30px) scale(1.2); opacity: 0.6; }
    50% { transform: translate(-20px, -60px) scale(0.8); opacity: 0.4; }
    75% { transform: translate(40px, -90px) scale(1.1); opacity: 0.5; }
  }

  /* ---------- Glass Cards ---------- */
  .glass-card {
    background: rgba(30, 15, 50, 0.6);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(167, 70, 224, 0.2);
    box-shadow:
      0 8px 32px rgba(0, 0, 0, 0.4),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);
  }

  .glass-card:hover {
    border-color: rgba(167, 70, 224, 0.4);
  }

  /* ---------- Buttons ---------- */
  .btn-gradient {
    background: linear-gradient(135deg, #a746e0 0%, #f472b6 100%);
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(167, 70, 224, 0.4);
  }

  .btn-gradient:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 6px 25px rgba(167, 70, 224, 0.6);
  }

  .btn-gradient:focus-visible {
    outline: 3px solid rgba(167, 70, 224, 0.6);
    outline-offset: 2px;
  }

  .btn-secondary {
    background: rgba(148, 163, 184, 0.1);
    border: 1px solid rgba(148, 163, 184, 0.3);
    transition: all 0.3s ease;
  }

  .btn-secondary:hover:not(:disabled) {
    background: rgba(148, 163, 184, 0.2);
    border-color: rgba(148, 163, 184, 0.5);
  }

  .btn-secondary:focus-visible {
    outline: 3px solid rgba(148, 163, 184, 0.6);
    outline-offset: 2px;
  }

  /* ---------- Topic Cards ---------- */
  .topic-card {
    background: rgba(30, 15, 50, 0.4);
    border: 2px solid rgba(167, 70, 224, 0.2);
    transition: all 0.3s ease;
    cursor: pointer;
  }

  .topic-card:hover {
    border-color: rgba(167, 70, 224, 0.6);
    transform: translateY(-4px);
    box-shadow: 0 12px 32px rgba(167, 70, 224, 0.3);
  }

  .topic-card:focus-visible {
    outline: 3px solid rgba(167, 70, 224, 0.6);
    outline-offset: 2px;
  }

  .topic-card.selected {
    border-color: #a746e0;
    background: rgba(167, 70, 224, 0.2);
    box-shadow: 0 0 30px rgba(167, 70, 224, 0.4);
  }

  /* ---------- Checklist Items ---------- */
  .checklist-item {
    background: rgba(30, 15, 50, 0.4);
    border-left: 3px solid rgba(148, 163, 184, 0.3);
    transition: all 0.2s ease;
  }

  .checklist-item.checked {
    background: rgba(34, 197, 94, 0.15);
    border-left-color: #22c55e;
  }

  .checklist-item.critical {
    border-left-color: #ef4444;
    background: rgba(239, 68, 68, 0.1);
  }

  /* ---------- Tabs ---------- */
  .tab-button {
    transition: all 0.2s ease;
    border-bottom: 2px solid transparent;
  }

  .tab-button.active {
    border-bottom-color: #a746e0;
    color: #f472b6;
  }

  .tab-button:focus-visible {
    outline: 3px solid rgba(167, 70, 224, 0.6);
    outline-offset: 2px;
  }

  /* ---------- Inputs ---------- */
  input[type="checkbox"]:focus-visible,
  textarea:focus-visible,
  input:focus-visible {
    outline: 3px solid rgba(167, 70, 224, 0.6);
    outline-offset: 2px;
  }

  /* ---------- Navigator Drawer ---------- */
  .navigator-drawer {
    position: fixed;
    top: 0;
    right: -400px;
    width: 400px;
    height: 100%;
    background: rgba(20, 10, 35, 0.95);
    backdrop-filter: blur(20px);
    border-left: 1px solid rgba(167, 70, 224, 0.3);
    transition: right 0.3s ease;
    z-index: 1000;
    overflow-y: auto;
  }

  .navigator-drawer.open { right: 0; }

  .navigator-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
    z-index: 999;
  }

  .navigator-overlay.visible {
    opacity: 1;
    pointer-events: auto;
  }

  /* ---------- Animations ---------- */
  .fade-in { animation: fadeIn 0.4s ease-out; }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(12px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .timer-warning { animation: pulse 2s infinite; }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.6; }
  }

  .hint-reveal { animation: highlightPulse 2s ease-out; }

  @keyframes highlightPulse {
    0% { background: rgba(167, 70, 224, 0.4); transform: scale(1.02); }
    100% { background: rgba(30, 15, 50, 0.4); transform: scale(1); }
  }

  /* ---------- Red Pulsing Badge (Needs Work) ---------- */
  @keyframes redPulseGlow {
    0%, 100% {
      transform: scale(1);
      box-shadow: 0 0 0 rgba(239, 68, 68, 0);
      opacity: 1;
    }
    50% {
      transform: scale(1.04);
      box-shadow: 0 0 28px rgba(239, 68, 68, 0.45);
      opacity: 0.95;
    }
  }

  .pulse-red-badge {
    animation: redPulseGlow 1.3s ease-in-out infinite;
  }

/* Difficulty + Type Pills */
.pill-badge{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:8px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:800;
  letter-spacing:.04em;
  border:1px solid rgba(255,255,255,0.16);
  background: rgba(255,255,255,0.08);
  color: rgba(255,255,255,0.85);
  text-transform: uppercase;
}
.pill-badge .dot{
  width:8px; height:8px; border-radius:999px;
  background: rgba(255,255,255,0.55);
}
.pill-easy .dot{ background: rgba(34,197,94,0.95); }
.pill-medium .dot{ background: rgba(250,204,21,0.95); }
.pill-hard .dot{ background: rgba(244,63,94,0.95); }
.pill-mcq .dot{ background: rgba(34,211,238,0.95); }
.pill-tf .dot{ background: rgba(168,85,247,0.95); }
.pill-multiselect .dot{ background: rgba(236,72,153,0.95); }

</style>





  <style>@view-transition { navigation: auto; }</style>
</head>
 <body class="h-full">
  <div id="app" class="main-wrapper gradient-bg">
   <div id="particles"></div>
   <div id="navigator-overlay" class="navigator-overlay" onclick="closeNavigator()"></div>
   <div id="navigator-drawer" class="navigator-drawer">
    <div class="p-6">
     <div class="flex items-center justify-between mb-6">
      <h2 class="text-white text-xl font-bold flex items-center gap-2"><i data-lucide="grid-3x3" class="w-5 h-5"></i> Station Navigator</h2><button onclick="closeNavigator()" class="text-slate-400 hover:text-white"> <i data-lucide="x" class="w-6 h-6"></i> </button>
     </div>
     <div id="navigator-content"></div>
    </div>
   </div>
   <main id="main-content" class="relative p-4 md:p-6 lg:p-8 min-h-screen"></main>
  </div>
  <script>

function getQuestionTypeLabel(q){
  if(!q) return "MCQ";
  if(q.type === "multiselect") return "Multi-select";
  if(q.type === "tf") return "True/False";
  return "MCQ";
}
function getQuestionTypeClass(q){
  if(!q) return "pill-mcq";
  if(q.type === "multiselect") return "pill-multiselect";
  if(q.type === "tf") return "pill-tf";
  return "pill-mcq";
}
function getDifficultyClass(q){
  const d = (q && q.difficulty ? String(q.difficulty) : "medium").toLowerCase();
  if(d.includes("hard")) return "pill-hard";
  if(d.includes("easy")) return "pill-easy";
  return "pill-medium";
}


    // ==================== CONFIGURATION ====================
    const defaultConfig = {
      app_title: "Nursing Theory Quiz",
      app_subtitle: "Year 1 Revision Tool",
      primary_color: "#a746e0",
      secondary_color: "#f472b6",
      background_color: "#1a0b2e",
      text_color: "#f1f5f9",
      accent_color: "#22c55e",
      font_family: "Outfit",
      font_size: 16
    };
    
    let config = { ...defaultConfig };

    // ==================== TOPIC DEFINITIONS ====================
    // NOTE: This dictates the categories available
    const topics = [
      { id: 'cellBiology', name: 'Cell Biology', icon: 'microscope', color: '#a855f7' },
      { id: 'homeostasis', name: 'Homeostasis', icon: 'thermometer', color: '#ec4899' },
      { id: 'respiratory', name: 'Respiratory System', icon: 'wind', color: '#06b6d4' },
      { id: 'cardiovascular', name: 'Cardiovascular System', icon: 'heart', color: '#ef4444' },
      { id: 'childDevelopment', name: 'Child Development', icon: 'baby', color: '#f59e0b' },
      { id: 'genetics', name: 'Genetics & Chromosomes', icon: 'dna', color: '#10b981' },
      { id: 'fluidsElectrolytes', name: 'Fluids & Electrolytes', icon: 'droplet', color: '#0ea5e9' },
      { id: 'mentalHealth', name: 'Mental Health', icon: 'brain', color: '#8b5cf6' },
      { id: 'nutrition', name: 'Nutrition', icon: 'utensils', color: '#22c55e' },
      { id: 'giLiver', name: 'Nutrition & GI/Liver', icon: 'pill', color: '#f97316' },
      { id: 'endocrine', name: 'Endocrine', icon: 'activity', color: '#06b6d4' },
      { id: 'skin', name: 'Skin/Dermatology', icon: 'hand', color: '#f472b6' },
      { id: 'musculoskeletal', name: 'Musculoskeletal', icon: 'bone', color: '#64748b' },
      { id: 'renal', name: 'Renal System', icon: 'droplets', color: '#3b82f6' },
      { id: 'breastfeeding', name: 'Breastfeeding', icon: 'heart-handshake', color: '#ec4899' },
      { id: 'hospitalPrep', name: 'Hospital Preparation', icon: 'hospital', color: '#14b8a6' },
      { id: 'numeracy', name: 'Drug Calculations', icon: 'calculator', color: '#8b5cf6' },
    ];

    // Derived map for legacy helpers (Learning Resources panel)
    const questionBanks = Object.fromEntries(
      topics.map(t => [t.id, { name: t.name, icon: t.icon, color: t.color }])
    );
;

    // ==================== STATE MANAGEMENT ====================
    let currentView = 'selection';
    let selectedTopics = [];
    let sessionQuestions = [];
    let sessionStations = [];
    let currentIndex = 0;
    let sessionAnswers = [];
    let sessionSubmitted = [];
    let sessionMode = 'quiz';
    let oscePracticeMode = 'practice';
    let stationCount = 3;
    let timedMode = false;
    let timeRemaining = 0;
    let stationTimeRemaining = 0;
    let timerInterval = null;
    let timerPaused = false;
    let currentStationChecklist = {};
    let stationNotes = {};
    let flaggedStations = [];
    let currentTab = 'brief';
    let navigatorOpen = false;
    let hintRevealed = {};
    let medicationQuestions = []; // Track calculation questions specifically
    
    // Quiz Settings
    let quizQuestionCount = 10; // 10, 20, 30, 60, or 'all'
    let quizMode = 'practice'; // 'practice' or 'exam'
    let quizDifficulty = 'mixed'; // 'mixed', 'easy', 'medium', 'hard'

    // Timing
    // - Practice: optional per-question timer (1m or 3m)
    // - Exam: optional overall timer (default 45m) — more realistic than per-question
    let quizTimerEnabled = false;
    let quizPerQuestionSeconds = 60; // 60 (1 min) or 180 (3 min)
    let quizExamSeconds = 2700; // 45 mins
    let quizTimeLimit = 0; // seconds (computed at start)

    // ==================== DEEPER INSIGHTS: SESSION TRACKING ====================
    // Per-question telemetry for diagnostics and adaptive planning
    let sessionMeta = []; // [{ startAtMs, timeSpentSec, changes, firstAnswer, confidence }]
    let currentQuestionEnteredAtMs = 0;

    // Confidence levels for calibration insights
    const CONFIDENCE_LEVELS = ['low', 'med', 'high'];

    // Local history storage (client-side only)
    const HISTORY_KEY = 'ntq_history_v1';
    const HISTORY_MAX_EVENTS = 2000; // cap to keep localStorage sane


    // ==================== UTILITY FUNCTIONS ====================
    function shuffleArray(array) {
      const arr = [...array];
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // ==================== DEEPER INSIGHTS: HELPERS ====================
    function clamp(n, min, max) { return Math.max(min, Math.min(max, n)); }

    function safeJsonParse(str, fallback) {
      try { return JSON.parse(str); } catch { return fallback; }
    }

    function loadHistory() {
      const raw = localStorage.getItem(HISTORY_KEY);
      const data = safeJsonParse(raw, []);
      return Array.isArray(data) ? data : [];
    }

    function saveHistory(events) {
      const trimmed = events.slice(-HISTORY_MAX_EVENTS);
      localStorage.setItem(HISTORY_KEY, JSON.stringify(trimmed));
    }

    // Infer concept tags from the question text (works even if your bank has no explicit tags)
    function inferConceptTags(q) {
      if (!q) return [];
      if (Array.isArray(q.concepts) && q.concepts.length) return q.concepts.slice(0, 5);

      const text = String(q.question || '').toLowerCase();
      const tags = new Set();

      const rules = [
        ['consent', ['consent', 'informed-consent']],
        ['capacity', ['capacity', 'mental-capacity']],
        ['confidential', ['confidentiality', 'information-governance']],
        ['gdpr', ['information-governance']],
        ['safeguard', ['safeguarding', 'escalation']],
        ['abuse', ['safeguarding']],
        ['duty of candour', ['duty-of-candour', 'professionalism']],
        ['whistle', ['whistleblowing', 'escalation']],
        ['incident', ['incident-reporting', 'patient-safety']],
        ['risk', ['risk-assessment', 'patient-safety']],
        ['handover', ['handover', 'communication']],
        ['sb ar', ['sbar', 'communication']],
        ['sbar', ['sbar', 'communication']],
        ['documentation', ['documentation', 'professionalism']],
        ['record', ['documentation', 'information-governance']],
        ['infection', ['infection-control']],
        ['hand hygiene', ['infection-control']],
        ['ppe', ['infection-control']],
        ['medication', ['medication-safety']],
        ['drug', ['medication-safety']],
        ['anaphyl', ['anaphylaxis', 'patient-safety']],
        ['resus', ['resuscitation', 'patient-safety']],
        ['delegat', ['delegation', 'accountability']],
        ['accountab', ['accountability', 'professionalism']],
        ['scope', ['scope-of-practice', 'professionalism']],
        ['escalat', ['escalation', 'patient-safety']],
        ['child', ['paediatrics']],
        ['parent', ['family-centred-care', 'communication']],
        ['privacy', ['confidentiality']],
        ['ethic', ['ethics', 'professionalism']],
      ];

      rules.forEach(([needle, out]) => {
        if (text.includes(needle)) out.forEach(t => tags.add(t));
      });

      // fallback tag so every question has at least one concept
      if (tags.size === 0) tags.add(q.topic || 'general');

      return Array.from(tags).slice(0, 5);
    }

    function computeMultiselectDiagnostics(correctArr, chosenArr) {
      const correct = new Set(Array.isArray(correctArr) ? correctArr : []);
      const chosen = new Set(Array.isArray(chosenArr) ? chosenArr : []);

      let correctSelected = 0;
      chosen.forEach(i => { if (correct.has(i)) correctSelected++; });

      const totalCorrect = correct.size || 1;
      const totalChosen = chosen.size || 1;

      const precision = correctSelected / totalChosen;
      const recall = correctSelected / totalCorrect;
      const f1 = (precision + recall) > 0 ? (2 * precision * recall) / (precision + recall) : 0;

      return {
        correctSelected,
        totalCorrect: correct.size,
        totalChosen: chosen.size,
        precision,
        recall,
        f1,
        missed: Array.from(correct).filter(i => !chosen.has(i)),
        extras: Array.from(chosen).filter(i => !correct.has(i)),
      };
    }

    // Mastery score per concept from recent history + current session
    function computeConceptMastery(events) {
      const stats = {}; // tag -> { attempts, correct, recent: [0/1] }
      events.forEach(ev => {
        (ev.concepts || []).forEach(tag => {
          if (!stats[tag]) stats[tag] = { attempts: 0, correct: 0, recent: [] };
          stats[tag].attempts += 1;
          stats[tag].correct += ev.correct ? 1 : 0;
          stats[tag].recent.push(ev.correct ? 1 : 0);
          if (stats[tag].recent.length > 6) stats[tag].recent.shift();
        });
      });

      const out = Object.entries(stats).map(([tag, s]) => {
        const acc = s.attempts ? (s.correct / s.attempts) : 0;
        const streak = s.recent.slice(-3).reduce((a, b) => a + b, 0) / 3;
        const mastery = clamp(0.6 * acc + 0.4 * streak, 0, 1);
        return { tag, attempts: s.attempts, accuracy: acc, mastery };
      });

      out.sort((a, b) => a.mastery - b.mastery);
      return out;
    }


    // UPGRADE 1 & 2: Helper to shuffle and pick N items from an array
    function shuffleAndPickN(array, n) {
      const shuffled = shuffleArray(array);
      return shuffled.slice(0, n);
    }
    
    // Quiz Timer
    function startQuizTimer() {
      if (timerInterval) clearInterval(timerInterval);
      timerInterval = setInterval(() => {
        if (!timerPaused && timeRemaining > 0) {
          timeRemaining--;
          updateTimerDisplay();
          if (timeRemaining === 0) {
            clearInterval(timerInterval);
            finishQuiz();
          }
        }
      }, 1000);
    }
    
    function updateTimerDisplay() {
      const timerEl = document.getElementById('quiz-timer');
      if (timerEl) {
        const mins = Math.floor(timeRemaining / 60);
        const secs = timeRemaining % 60;
        timerEl.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
        if (timeRemaining < 60) {
          timerEl.classList.add('timer-warning', 'text-red-400');
        }
      }
    }
    
    function stopQuizTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
    }

    // Track total quiz time for results stats (Time + Avg Pace cards)
    function finalizeQuizTime() {
      // If timer mode is enabled, derive elapsed from limit/remaining.
      if (typeof quizTimerEnabled !== 'undefined' && quizTimerEnabled && typeof quizTimeLimit === 'number') {
        const elapsed = Math.max(0, Math.round(quizTimeLimit - (timeRemaining || 0)));
        window.quizTimeSeconds = elapsed;
        return;
      }
      // Otherwise, use wall-clock time from when the session started.
      const startedAt = Number(window.quizStartedAt || 0);
      if (startedAt > 0) {
        window.quizTimeSeconds = Math.max(0, Math.round((Date.now() - startedAt) / 1000));
      }
    }


    function createParticles() {
      const particlesContainer = document.getElementById('particles');
      if (!particlesContainer) return;
      
      particlesContainer.innerHTML = '';
      const particleCount = 20;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 20 + 's';
        particle.style.animationDuration = (15 + Math.random() * 10) + 's';
        particlesContainer.appendChild(particle);
      }
    }


    // ==================== QUIZ QUESTIONS BANK ====================
    const quizBank = [
      {
                        id: 'cb1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the powerhouse of the cell?',
                        options: ['Nucleus', 'Mitochondria', 'Ribosome', 'Golgi apparatus'],
                        correct: 1,
                        explanation: 'Mitochondria are known as the powerhouse of the cell because they generate most of the cell\'s ATP through oxidative phosphorylation.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb2',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which organelle is responsible for protein synthesis?',
                        options: ['Lysosome', 'Ribosome', 'Mitochondria', 'Vacuole'],
                        correct: 1,
                        explanation: 'Ribosomes are the cellular structures responsible for protein synthesis, translating mRNA into amino acid sequences.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb3',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'The cell membrane is completely impermeable to all substances.',
                        correct: false,
                        explanation: 'The cell membrane is selectively permeable, allowing certain substances to pass while blocking others.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb4',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'During which phase of the cell cycle does DNA replication occur?',
                        options: ['G1 phase', 'S phase', 'G2 phase', 'M phase'],
                        correct: 1,
                        explanation: 'DNA replication occurs during the S (synthesis) phase of the cell cycle, when the genetic material is duplicated.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb5',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which of the following are functions of the Golgi apparatus? (Select all that apply)',
                        options: ['Protein modification', 'Lipid metabolism', 'Packaging secretory proteins', 'DNA replication'],
                        correct: [0, 2],
                        explanation: 'The Golgi apparatus modifies, sorts, and packages proteins and lipids for secretion or delivery to other organelles.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb6',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What type of transport requires ATP?',
                        options: ['Osmosis', 'Facilitated diffusion', 'Active transport', 'Simple diffusion'],
                        correct: 2,
                        explanation: 'Active transport requires ATP to move substances against their concentration gradient.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb7',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Red blood cells contain a nucleus.',
                        correct: false,
                        explanation: 'Mature red blood cells (erythrocytes) do not have a nucleus. They lose it during development to make more room for hemoglobin.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb8',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Which type of cell junction allows direct communication between adjacent cells?',
                        options: ['Tight junctions', 'Gap junctions', 'Desmosomes', 'Adherens junctions'],
                        correct: 1,
                        explanation: 'Gap junctions allow direct communication and exchange of ions and small molecules between adjacent cells.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb9',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the correct order of the living hierarchy from smallest to largest?',
                        options: ['Cells → Organs → Tissues → Organ systems → Organism', 'Cells → Tissues → Organs → Organ systems → Organism', 'Tissues → Cells → Organs → Organism → Organ systems', 'Organs → Tissues → Cells → Organ systems → Organism'],
                        correct: 1,
                        explanation: 'The living hierarchy progresses from cells (smallest unit) → tissues (groups of similar cells) → organs (multiple tissues) → organ systems (multiple organs) → organism (complete individual).'
                    , topic: 'cellBiology'},
      {
                        id: 'cb10',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are the four main tissue types in the human body? (Select all that apply)',
                        options: ['Epithelial', 'Connective', 'Muscle', 'Nervous'],
                        correct: [0, 1, 2, 3],
                        explanation: 'The four tissue types are: Epithelial (covers/lines surfaces and forms glands), Connective (support including bone, cartilage, blood, fat), Muscle (contracts), and Nervous (control and communication).'
                    , topic: 'cellBiology'},
      {
                        id: 'cb11',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is cell differentiation?',
                        options: ['Cells dividing to create more cells', 'Stem cells specializing into specific cell types via differential gene expression', 'Cells dying and being replaced', 'Cells moving to different parts of the body'],
                        correct: 1,
                        explanation: 'Cell differentiation is when stem cells "choose a career" and become specialized cell types. This occurs through differential gene expression - the same DNA is present, but different genes are switched on or off.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb12',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'The Na⁺/K⁺ pump moves ions in which direction?',
                        options: ['3 Na⁺ in, 2 K out', '3 Na⁺ out, 2 K⁺ in', '2 Na⁺ out, 3 K⁺ in', 'Equal exchange of Na⁺ and K⁺'],
                        correct: 1,
                        explanation: 'The Na⁺/K⁺ pump is an active transport mechanism that moves 3 sodium ions OUT of the cell and 2 potassium ions INTO the cell, requiring ATP.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb13',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which organelle is responsible for modifying, sorting, and packaging proteins?',
                        options: ['Rough ER', 'Smooth ER', 'Golgi apparatus', 'Lysosomes'],
                        correct: 2,
                        explanation: 'The Golgi apparatus acts like a post office - it modifies, sorts, and packages proteins that were made in the rough ER, preparing them for secretion or delivery to other organelles.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb14',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Lysosomes contain digestive enzymes and are involved in cellular recycling.',
                        correct: true,
                        explanation: 'Lysosomes are the cell\'s "recycling centres" containing digestive enzymes. They break down old organelles, pathogens, and waste. Lysosomal storage diseases occur when toxic materials build up due to enzyme deficiencies.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb15',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'In protein synthesis, what is the correct sequence of events?',
                        options: ['Translation → Transcription → Folding', 'Transcription → Translation → Folding/Processing', 'Folding → Transcription → Translation', 'Translation → Folding → Transcription'],
                        correct: 1,
                        explanation: 'Protein synthesis follows: Transcription (DNA → mRNA in nucleus) → Translation (mRNA → protein at ribosome) → Folding/Processing (via RER and Golgi). Remember: DNA → RNA → Protein.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb16',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Approximately how many ATP molecules are produced from one glucose molecule during aerobic respiration?',
                        options: ['2 ATP', '10-12 ATP', '30-32 ATP', '50-60 ATP'],
                        correct: 2,
                        explanation: 'Aerobic respiration produces approximately 30-32 ATP per glucose molecule through glycolysis → Krebs cycle → oxidative phosphorylation. This is much more efficient than anaerobic respiration which produces only 2 ATP.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb17',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Mitochondrial diseases primarily affect high-energy organs like the heart and brain.',
                        correct: true,
                        explanation: 'Because mitochondria produce ATP (cellular energy), mitochondrial diseases most severely impact organs with high energy demands such as the heart, brain, and muscles.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb18',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the role of primary cilia in cells?',
                        options: ['Movement of the cell', 'Signaling "antennae" for cell communication', 'Protein synthesis', 'Energy production'],
                        correct: 1,
                        explanation: 'Primary cilia act as signaling "antennae" on cells, detecting chemical and mechanical signals. Defects in primary cilia cause ciliopathies - diseases affecting multiple organ systems.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb19',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the main difference between catabolism and anabolism?',
                        options: ['Catabolism builds molecules; anabolism breaks them down', 'Catabolism breaks down molecules for energy; anabolism builds molecules using energy', 'Both require the same amount of energy', 'Catabolism only occurs in mitochondria'],
                        correct: 1,
                        explanation: 'Catabolism breaks down large molecules into smaller ones, releasing energy and building blocks. Anabolism builds up large molecules from smaller ones, requiring energy input. They are opposite metabolic processes.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb20',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which factors can affect enzyme activity? (Select all that apply)',
                        options: ['Temperature', 'pH', 'Substrate concentration', 'Cell color'],
                        correct: [0, 1, 2],
                        explanation: 'Enzyme activity depends on 3D shape. Heat can denature enzymes; pH alters shape (pepsin works at pH ~2, trypsin at pH ~8); reaction rate increases with substrate concentration until saturation. Cell color does not affect enzyme activity.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb21',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'Which DNA base pairs with Adenine?',
                        options: ['Guanine', 'Cytosine', 'Thymine', 'Uracil'],
                        correct: 2,
                        explanation: 'In DNA, bases pair as: Adenine-Thymine (A-T) and Guanine-Cytosine (G-C). In RNA, Uracil (U) replaces Thymine, so Adenine pairs with Uracil.'
                    , topic: 'cellBiology'},
      {
                        id: 'cb22',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Mitosis produces two identical daughter cells for growth and repair.',
                        correct: true,
                        explanation: 'Mitosis produces 2 genetically identical daughter cells used for growth and tissue repair. Meiosis (for gamete production) produces 4 cells with half the chromosomes; errors in meiosis can cause trisomies like Down syndrome.'
                    , topic: 'cellBiology'},
      {
                        id: 'ho1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the normal body temperature range for children?',
                        options: ['35.5-36.5°C', '36.5-37.5°C', '37.5-38.5°C', '38.5-39.5°C'],
                        correct: 1,
                        explanation: 'Normal body temperature for children is typically 36.5-37.5°C (97.7-99.5°F).'
                    , topic: 'homeostasis'},
      {
                        id: 'ho2',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which organ is primarily responsible for maintaining blood glucose homeostasis?',
                        options: ['Liver', 'Kidney', 'Heart', 'Lung'],
                        correct: 0,
                        explanation: 'The liver plays a central role in glucose homeostasis through glycogenesis, glycogenolysis, and gluconeogenesis.'
                    , topic: 'homeostasis'},
      {
                        id: 'ho3',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Negative feedback loops amplify the original stimulus.',
                        correct: false,
                        explanation: 'Negative feedback loops reduce or reverse the original stimulus, helping to maintain homeostasis.'
                    , topic: 'homeostasis'},
      {
                        id: 'ho4',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What hormone is released when blood glucose levels are high?',
                        options: ['Glucagon', 'Insulin', 'Cortisol', 'Adrenaline'],
                        correct: 1,
                        explanation: 'Insulin is released by the pancreas when blood glucose levels are high, promoting glucose uptake by cells.'
                    , topic: 'homeostasis'},
      {
                        id: 'ho5',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which of the following help regulate body temperature? (Select all that apply)',
                        options: ['Sweating', 'Shivering', 'Vasoconstriction', 'Increased urine output'],
                        correct: [0, 1, 2],
                        explanation: 'Sweating cools the body, shivering generates heat, and vasoconstriction reduces heat loss. Urine output is not a primary thermoregulatory mechanism.'
                    , topic: 'homeostasis'},
      {
                        id: 'ho6',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the normal pH range of arterial blood?',
                        options: ['7.15-7.25', '7.25-7.35', '7.35-7.45', '7.45-7.55'],
                        correct: 2,
                        explanation: 'Normal arterial blood pH is 7.35-7.45. Values outside this range indicate acidosis or alkalosis.'
                    , topic: 'homeostasis'},
      {
                        id: 'ho7',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Children are more susceptible to hypothermia than adults due to their higher surface area to body mass ratio.',
                        correct: true,
                        explanation: 'Children have a larger surface area relative to their body mass, leading to faster heat loss and increased risk of hypothermia.'
                    , topic: 'homeostasis'},
      {
                        id: 'ho8',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Which buffer system is most important for maintaining blood pH?',
                        options: ['Phosphate buffer', 'Protein buffer', 'Bicarbonate buffer', 'Ammonia buffer'],
                        correct: 2,
                        explanation: 'The bicarbonate buffer system is the most important extracellular buffer for maintaining blood pH.'
                    , topic: 'homeostasis'},
      {
                        id: 'ho9',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the normal blood glucose range in mmol/L?',
                        options: ['2.0-4.0 mmol/L', '4.0-7.8 mmol/L', '8.0-12.0 mmol/L', '12.0-15.0 mmol/L'],
                        correct: 1,
                        explanation: 'Normal blood glucose is approximately 4.0-7.8 mmol/L. This is maintained through homeostatic mechanisms involving insulin and glucagon.'
                    , topic: 'homeostasis'},
      {
                        id: 'ho10',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are the three essential components of a feedback loop? (Select all that apply)',
                        options: ['Receptor', 'Control centre', 'Effector', 'Hormone'],
                        correct: [0, 1, 2],
                        explanation: 'Every feedback loop requires three components: Receptor (detects change) → Control centre (processes information) → Effector (produces response). Hormones may be involved but are not essential components of all feedback loops.'
                    , topic: 'homeostasis'},
      {
                        id: 'ho11',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which is an example of positive feedback?',
                        options: ['Blood glucose regulation', 'Temperature regulation', 'Oxytocin release during labour', 'Blood pressure control'],
                        correct: 2,
                        explanation: 'Positive feedback amplifies the original stimulus until an event stops it. Oxytocin release during labour is a classic example - contractions → oxytocin release → stronger contractions. Blood clotting is another example. Most homeostatic mechanisms use negative feedback.'
                    , topic: 'homeostasis'},
      {
                        id: 'ho12',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Rising lactate levels in a child indicate cellular failure due to poor oxygen delivery.',
                        correct: true,
                        explanation: 'When cells cannot get enough oxygen, they switch from aerobic to anaerobic respiration, producing lactate. Rising lactate is a warning sign of cellular failure due to shock or poor oxygen delivery, indicating illness progression.'
                    , topic: 'homeostasis'},
      {
                        id: 'ho13',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which factors make children more vulnerable to homeostatic disturbances? (Select all that apply)',
                        options: ['Higher surface area to volume ratio', 'Higher respiratory rate', 'Immature kidneys', 'Lower basal metabolic rate'],
                        correct: [0, 1, 2],
                        explanation: 'Children are vulnerable due to: higher surface area:volume ratio (faster heat/fluid loss), higher respiratory rate (increased insensible water loss), and immature kidneys (less able to concentrate urine). They actually have HIGHER basal metabolic rate, which means faster deterioration in illness.'
                    , topic: 'homeostasis'},
      {
                        id: 'ho14',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Which electrolytes are predominantly found in the intracellular fluid (ICF)?',
                        options: ['Sodium and chloride', 'Potassium and magnesium', 'Sodium and bicarbonate', 'Calcium and chloride'],
                        correct: 1,
                        explanation: 'ICF (intracellular fluid) contains high concentrations of potassium (K⁺), magnesium (Mg²⁺), and phosphate. ECF (extracellular fluid) contains high concentrations of sodium (Na⁺), chloride (Cl⁻), and bicarbonate (HCO₃⁻).'
                    , topic: 'homeostasis'},
      {
                        id: 'ho15',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is oncotic pressure and what happens when albumin levels are low?',
                        options: ['Blood pressure increases', 'Oedema develops', 'Dehydration occurs', 'Blood glucose rises'],
                        correct: 1,
                        explanation: 'Oncotic pressure is created by albumin (protein) in blood vessels, pulling fluid into the vessels. When albumin levels are low, fluid leaks out of vessels into tissues, causing oedema (swelling).'
                    , topic: 'homeostasis'},
      {
                        id: 'ho16',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Homeostasis maintains a completely fixed value for physiological variables.',
                        correct: false,
                        explanation: 'Homeostasis maintains dynamic equilibrium around a set RANGE, not a fixed value. Variables like temperature, glucose, and pH fluctuate within normal ranges while the body continuously makes adjustments.'
                    , topic: 'homeostasis'},
      {
                        id: 'rs1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the normal respiratory rate for a newborn?',
                        options: ['12-20 breaths/min', '20-30 breaths/min', '30-60 breaths/min', '60-80 breaths/min'],
                        correct: 2,
                        explanation: 'Normal respiratory rate for newborns is 30-60 breaths per minute, which decreases with age.'
                    , topic: 'respiratory'},
      {
                        id: 'rs2',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which structure prevents food from entering the trachea during swallowing?',
                        options: ['Uvula', 'Epiglottis', 'Larynx', 'Pharynx'],
                        correct: 1,
                        explanation: 'The epiglottis is a flap of cartilage that covers the trachea during swallowing to prevent aspiration.'
                    , topic: 'respiratory'},
      {
                        id: 'rs3',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Infants are obligate nose breathers.',
                        correct: true,
                        explanation: 'Infants are primarily obligate nose breathers until about 4-6 months of age, making nasal congestion particularly problematic.'
                    , topic: 'respiratory'},
      {
                        id: 'rs4',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the primary muscle of respiration?',
                        options: ['External intercostals', 'Internal intercostals', 'Diaphragm', 'Abdominal muscles'],
                        correct: 2,
                        explanation: 'The diaphragm is the primary muscle of respiration, responsible for about 75% of the air movement during quiet breathing.'
                    , topic: 'respiratory'},
      {
                        id: 'rs5',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are signs of respiratory distress in children? (Select all that apply)',
                        options: ['Nasal flaring', 'Head bobbing', 'Intercostal recession', 'Bounding pulse'],
                        correct: [0, 1, 2],
                        explanation: 'Nasal flaring, head bobbing, and intercostal recession are all signs of increased work of breathing. Bounding pulse is not specific to respiratory distress.'
                    , topic: 'respiratory'},
      {
                        id: 'rs6',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Where does gas exchange occur in the lungs?',
                        options: ['Bronchi', 'Bronchioles', 'Alveoli', 'Trachea'],
                        correct: 2,
                        explanation: 'Gas exchange occurs in the alveoli, tiny air sacs surrounded by capillaries where oxygen and carbon dioxide are exchanged.'
                    , topic: 'respiratory'},
      {
                        id: 'rs7',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'A child with croup typically has an expiratory stridor.',
                        correct: false,
                        explanation: 'Croup typically causes inspiratory stridor due to subglottic swelling narrowing the airway during inspiration.'
                    , topic: 'respiratory'},
      {
                        id: 'rs8',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the normal oxygen saturation target for a healthy child?',
                        options: ['88-92%', '92-94%', '94-98%', '98-100%'],
                        correct: 2,
                        explanation: 'Normal oxygen saturation for healthy children is typically 94-98%. Lower targets may be appropriate for certain conditions.'
                    , topic: 'respiratory'},
      {
                        id: 'rs9',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'In the ABCDE assessment framework, what does the "A" stand for?',
                        options: ['Assessment', 'Airway', 'Auscultation', 'Apnoea'],
                        correct: 1,
                        explanation: 'ABCDE stands for: Airway, Breathing, Circulation, Disability, Exposure. Always assess in this order as problems are managed as they are found.'
                    , topic: 'respiratory'},
      {
                        id: 'rs10',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which should be assessed during "B" (Breathing) in the ABCDE approach? (Select all that apply)',
                        options: ['Respiratory rate', 'Work of breathing', 'Oxygen saturation', 'Capillary refill time'],
                        correct: [0, 1, 2],
                        explanation: 'Breathing assessment includes: respiratory rate, work of breathing (effort), SpO₂, chest expansion, and auscultation. Capillary refill time is assessed in "C" (Circulation).'
                    , topic: 'respiratory'},
      {
                        id: 'rs11',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'During which embryonic/fetal period does lung and alveolar development begin?',
                        options: ['Week 2', 'Week 4', 'Week 12', 'Week 20'],
                        correct: 1,
                        explanation: 'Respiratory system development starts around week 4 of embryonic development. However, lung and alveolar development continues until approximately 7-8 years of age postnatally.'
                    , topic: 'respiratory'},
      {
                        id: 'rs12',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the function of surfactant produced by Type II pneumocytes?',
                        options: ['Increases airway resistance', 'Prevents alveolar collapse', 'Increases mucus production', 'Causes bronchodilation'],
                        correct: 1,
                        explanation: 'Surfactant reduces surface tension in the alveoli, preventing collapse during expiration. Preterm babies lack sufficient surfactant, leading to Respiratory Distress Syndrome (RDS), treated with oxygen/CPAP ± exogenous surfactant.'
                    , topic: 'respiratory'},
      {
                        id: 'rs13',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Infants being mainly nasal breathers means that a blocked nose can rapidly cause respiratory distress.',
                        correct: true,
                        explanation: 'Because infants are obligate nose breathers until ~4-6 months, nasal congestion significantly impairs their ability to breathe and can cause rapid distress, especially during feeding.'
                    , topic: 'respiratory'},
      {
                        id: 'rs14',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which anatomical differences make children more vulnerable to rapid respiratory deterioration? (Select all that apply)',
                        options: ['Soft, compliant chest wall', 'Horizontal ribs with less reserve', 'Relatively large tongue', 'Strong intercostal muscles'],
                        correct: [0, 1, 2],
                        explanation: 'Paediatric vulnerabilities: soft chest wall (early retractions, less reserve), horizontal ribs (reduced mechanical advantage), relatively large tongue (obstruction risk), WEAK intercostals (diaphragm-dependent), less collateral ventilation (easier atelectasis). These factors mean children deteriorate faster than adults.'
                    , topic: 'respiratory'},
      {
                        id: 'rs15',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Why do infants have prominent abdominal breathing?',
                        options: ['They have abdominal pathology', 'They are diaphragm-dependent due to weak intercostals', 'They have gastric distension', 'This is abnormal'],
                        correct: 1,
                        explanation: 'Infants have weak intercostal muscles, making them heavily diaphragm-dependent for breathing. This causes visible abdominal rise with each breath, which is NORMAL in infants and young children.'
                    , topic: 'respiratory'},
      {
                        id: 'rs16',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Where is respiratory control primarily located in the brain?',
                        options: ['Cerebellum', 'Cerebral cortex', 'Medulla and pons', 'Hypothalamus'],
                        correct: 2,
                        explanation: 'Respiratory control is primarily in the medulla and pons (brainstem). Control is both automatic (unconscious) and voluntary (can consciously override). Chemoreceptors detect CO₂ and O₂ levels to regulate breathing.'
                    , topic: 'respiratory'},
      {
                        id: 'rs17',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'At rest, expiration is a passive process requiring no muscle contraction.',
                        correct: true,
                        explanation: 'Inspiration is ACTIVE (diaphragm contracts and moves down, external intercostals lift ribs). Expiration at rest is PASSIVE (elastic recoil of lungs and chest wall). During increased work of breathing, expiration becomes active using abdominal muscles.'
                    , topic: 'respiratory'},
      {
                        id: 'rs18',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Gas exchange at the alveoli occurs by which mechanism?',
                        options: ['Active transport', 'Osmosis', 'Diffusion', 'Filtration'],
                        correct: 2,
                        explanation: 'Gas exchange occurs by DIFFUSION across the alveolar-capillary membrane. O₂ moves from alveoli (high concentration) to blood (low concentration). CO₂ moves from blood to alveoli. This requires adequate ventilation (V) and perfusion (Q) - V/Q matching.'
                    , topic: 'respiratory'},
      {
                        id: 'rs19',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which conditions cause decreased ventilation (↓V) leading to V/Q mismatch? (Select all that apply)',
                        options: ['Asthma', 'Bronchiolitis', 'Pneumonia', 'Pulmonary embolism'],
                        correct: [0, 1, 2],
                        explanation: 'Decreased ventilation (↓V): asthma (bronchospasm), bronchiolitis (mucus plugging), pneumonia (consolidation). Decreased perfusion (↓Q): pulmonary embolism (rare in young children), cardiac shunts. V/Q mismatch causes hypoxaemia.'
                    , topic: 'respiratory'},
      {
                        id: 'rs20',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the normal tidal volume per kilogram in children?',
                        options: ['1-3 ml/kg', '5-10 ml/kg', '15-20 ml/kg', '25-30 ml/kg'],
                        correct: 1,
                        explanation: 'Normal tidal volume (TV) is approximately 5-10 ml/kg. This is the volume of air moved in and out with each normal breath. Total lung capacity, functional residual capacity, and vital capacity are other important lung volumes.'
                    , topic: 'respiratory'},
      {
                        id: 'rs21',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the purpose of grunting in an infant with respiratory distress?',
                        options: ['To clear secretions', 'To create auto-PEEP and keep alveoli open', 'To signal pain', 'To increase tidal volume'],
                        correct: 1,
                        explanation: 'Grunting is expiration against a partially closed glottis, creating positive end-expiratory pressure (auto-PEEP). This prevents alveolar collapse and maintains functional residual capacity. It is a compensatory mechanism but indicates significant respiratory distress.'
                    , topic: 'respiratory'},
      {
                        id: 'rs22',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'When assessing "Effort" (work of breathing), which signs indicate increased effort? (Select all that apply)',
                        options: ['Tachypnoea', 'Nasal flaring', 'Intercostal recession', 'Equal chest rise'],
                        correct: [0, 1, 2],
                        explanation: 'Assessment framework: EFFORT (work of breathing) = RR, nasal flaring, recession (intercostal/subcostal/sternal), tracheal tug, head bobbing, grunting, tripod position, inability to feed/speak. Equal chest rise is part of EFFICACY assessment.'
                    , topic: 'respiratory'},
      {
                        id: 'rs23',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Which indicates the "Efficacy" of breathing rather than effort?',
                        options: ['Intercostal recession', 'Equal chest expansion', 'Nasal flaring', 'Tracheal tug'],
                        correct: 1,
                        explanation: 'EFFICACY assesses how EFFECTIVE breathing is: equal chest rise, symmetrical air entry, central trachea position, SpO₂ in air ± response to oxygen. EFFORT = work of breathing signs. EFFECT = impact on other systems (HR, perfusion, consciousness, colour).'
                    , topic: 'respiratory'},
      {
                        id: 'rs24',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which indicate the "Effect" of respiratory problems on the child? (Select all that apply)',
                        options: ['Tachycardia', 'Prolonged capillary refill', 'Altered consciousness', 'Subcostal recession'],
                        correct: [0, 1, 2],
                        explanation: 'EFFECT shows impact of respiratory distress on other body systems: tachycardia, prolonged CRT, altered consciousness/agitation/fatigue, central cyanosis (tongue/lips - urgent sign). Recession is an EFFORT sign, not effect.'
                    , topic: 'respiratory'},
      {
                        id: 'rs25',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What does stridor indicate?',
                        options: ['Lower airway narrowing', 'Upper airway obstruction', 'Pleural effusion', 'Pneumothorax'],
                        correct: 1,
                        explanation: 'Stridor is a high-pitched inspiratory sound indicating UPPER airway obstruction (croup, foreign body, anaphylaxis). Wheeze = LOWER airway narrowing (asthma, bronchiolitis). This is a critical distinction for diagnosis and management.'
                    , topic: 'respiratory'},
      {
                        id: 'rs26',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which auscultation findings have the following meanings? Match correctly: (Select all that apply)',
                        options: ['Wheeze = lower airway narrowing', 'Crackles = fluid/infection/atelectasis', 'Silent chest = mild obstruction', 'Reduced air entry = severe obstruction or fatigue'],
                        correct: [0, 1, 3],
                        explanation: 'Auscultation meanings: Stridor = upper airway obstruction 🚨. Wheeze = lower airway narrowing (asthma/bronchiolitis). Crackles = fluid/infection/atelectasis. Silent chest/reduced air entry = severe obstruction or EXHAUSTION 🚨 (ominous sign - may need immediate intervention).'
                    , topic: 'respiratory'},
      {
                        id: 'rs27',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the difference between hypoxaemia and hypoxia?',
                        options: ['There is no difference', 'Hypoxaemia = low O₂ in blood; Hypoxia = low O₂ at tissues', 'Hypoxia = low O₂ in blood; Hypoxaemia = low O₂ at tissues', 'Both mean high CO₂'],
                        correct: 1,
                        explanation: 'HYPOXAEMIA = low oxygen in the BLOOD (measured by SpO₂ or PaO₂). HYPOXIA = low oxygen delivery to TISSUES (can occur even with normal SpO₂ if perfusion is poor). Both require urgent treatment.'
                    , topic: 'respiratory'},
      {
                        id: 'rs28',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the target oxygen saturation (SpO₂) for most children?',
                        options: ['88-92%', '90-94%', '94-98%', '99-100%'],
                        correct: 2,
                        explanation: 'Target SpO₂ for most children is ≥94-98% (unless specific condition/local policy says otherwise, e.g., some cyanotic heart defects may have lower targets). Give oxygen if SpO₂ <94% in acute illness.'
                    , topic: 'respiratory'},
      {
                        id: 'rs29',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are RED FLAGS indicating impending respiratory failure? (Select all that apply)',
                        options: ['Exhaustion/reduced effort', 'Silent chest', 'Cyanosis despite oxygen', 'Mild tachypnoea'],
                        correct: [0, 1, 2],
                        explanation: 'RED FLAGS for impending respiratory failure: exhaustion/reduced effort, bradypnoea/apnoea, silent chest, central cyanosis, poor perfusion, altered consciousness, poor feeding, worsening SpO₂ despite oxygen. Mild tachypnoea alone is an early sign but not immediately life-threatening. These signs require URGENT escalation.'
                    , topic: 'respiratory'},
      {
                        id: 'rs30',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'In asthma, what is the pathophysiology causing wheeze?',
                        options: ['Alveolar collapse', 'Inflammation + mucus + bronchospasm', 'Surfactant deficiency', 'Upper airway swelling'],
                        correct: 1,
                        explanation: 'Asthma pathophysiology: INFLAMMATION (airway swelling) + MUCUS (plugging) + BRONCHOSPASM (smooth muscle contraction) → narrowed airways → wheeze. Treatment targets all three: ICS (inflammation), SABA (bronchospasm), mucolytics sometimes used.'
                    , topic: 'respiratory'},
      {
                        id: 'rs31',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which medications are used in asthma management? (Select all that apply)',
                        options: ['Salbutamol (SABA) as reliever', 'Beclometasone (ICS) as preventer', 'Prednisolone for acute exacerbations', 'Routine antibiotics'],
                        correct: [0, 1, 2],
                        explanation: 'Asthma management: SABA (salbutamol/albuterol) = reliever for symptoms. ICS (beclometasone) = preventer (daily). Acute exacerbation = oral prednisolone. Add-on therapy = montelukast (LTRA - watch for mood/sleep side effects), or ICS/LABA combo if poor control. Antibiotics NOT routine unless secondary bacterial infection.'
                    , topic: 'respiratory'},
      {
                        id: 'rs32',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What indicates worsening asthma control?',
                        options: ['Decreased reliever use', 'No night symptoms', 'Increased reliever use and night symptoms', 'Normal peak flow'],
                        correct: 2,
                        explanation: 'Warning signs of poor asthma control: increased reliever (SABA) use (>3 times/week), night symptoms/waking, activity limitation, frequent exacerbations, falling peak flow. These indicate need to step up preventer therapy (increase ICS dose or add-on therapy).'
                    , topic: 'respiratory'},
      {
                        id: 'rs33',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the typical age group and causative organism for bronchiolitis?',
                        options: ['<2 years, commonly RSV', '2-5 years, commonly parainfluenza', '>5 years, commonly Mycoplasma', 'All ages, commonly Streptococcus'],
                        correct: 0,
                        explanation: 'Bronchiolitis typically affects children <2 years (peak 3-6 months). Most commonly caused by Respiratory Syncytial Virus (RSV), but also rhinovirus, parainfluenza, adenovirus. Presents with cough, coryza → wheeze/crackles, increased work of breathing, poor feeding.'
                    , topic: 'respiratory'},
      {
                        id: 'rs34',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are appropriate management strategies for bronchiolitis? (Select all that apply)',
                        options: ['Supportive care (suction, fluids, oxygen)', 'Routine bronchodilators', 'Routine corticosteroids', 'NG feeds if unable to feed orally'],
                        correct: [0, 3],
                        explanation: 'Bronchiolitis management is SUPPORTIVE: nasal suction, maintain hydration (oral/NG feeds), oxygen if SpO₂ <92%, escalate to HFNC/CPAP if needed. Usually NOT routine: bronchodilators (ineffective), corticosteroids (not beneficial unless other indication), antibiotics (viral illness). Apnoea risk in young infants (<3 months) - monitor closely.'
                    , topic: 'respiratory'},
      {
                        id: 'rs35',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the characteristic symptom of croup?',
                        options: ['Productive cough', 'Barking cough', 'Silent cough', 'Wet cough'],
                        correct: 1,
                        explanation: 'Croup (laryngotracheobronchitis) presents with barking/seal-like cough + inspiratory stridor. Typically affects children <5 years, worse at night. Caused by parainfluenza virus (most common), also RSV, influenza.'
                    , topic: 'respiratory'},
      {
                        id: 'rs36',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are appropriate treatments for croup? (Select all that apply)',
                        options: ['Single dose of dexamethasone', 'Nebulised adrenaline for severe cases', 'Routine antibiotics', 'Keeping child calm (agitation worsens airway)'],
                        correct: [0, 1, 3],
                        explanation: 'Croup treatment: Single dose oral/IM dexamethasone (reduces airway swelling - ALL severities benefit). Severe croup (stridor at rest, marked recession, distress) → oxygen + nebulised adrenaline (temporary relief ~2hrs) + admit for observation. Keep child calm - agitation worsens airway obstruction. Antibiotics NOT indicated (viral illness).'
                    , topic: 'respiratory'},
      {
                        id: 'rs37',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which indicate SEVERE croup requiring hospital admission? (Select all that apply)',
                        options: ['Stridor at rest', 'Marked intercostal recession', 'Distress or exhaustion', 'Barking cough only when crying'],
                        correct: [0, 1, 2],
                        explanation: 'SEVERE croup red flags: stridor AT REST (not just when upset), marked recession, significant distress/agitation, lethargy/exhaustion, pallor/cyanosis. Mild croup = stridor only when upset, no recession, well child. Barking cough alone (without stridor at rest) suggests mild croup - can often manage at home with oral dexamethasone.'
                    , topic: 'respiratory'},
      {
                        id: 'cv1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the normal heart rate for a newborn at rest?',
                        options: ['60-100 bpm', '100-160 bpm', '160-200 bpm', '200-220 bpm'],
                        correct: 1,
                        explanation: 'Normal heart rate for newborns is 100-160 bpm, which gradually decreases with age.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv2',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which chamber of the heart pumps blood to the lungs?',
                        options: ['Right atrium', 'Right ventricle', 'Left atrium', 'Left ventricle'],
                        correct: 1,
                        explanation: 'The right ventricle pumps deoxygenated blood to the lungs via the pulmonary artery.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv3',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Blood pressure increases as children grow older.',
                        correct: true,
                        explanation: 'Blood pressure normally increases with age as the cardiovascular system matures and vessel size increases.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv4',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the formula for calculating mean arterial pressure (MAP)?',
                        options: ['Systolic + Diastolic / 2', 'Systolic - Diastolic', 'Diastolic + 1/3(Systolic - Diastolic)', 'Systolic + 2(Diastolic) / 3'],
                        correct: 2,
                        explanation: 'MAP = Diastolic + 1/3(Pulse Pressure), where Pulse Pressure = Systolic - Diastolic.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv5',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are signs of cardiac failure in infants? (Select all that apply)',
                        options: ['Tachycardia', 'Hepatomegaly', 'Poor feeding', 'Dry skin'],
                        correct: [0, 1, 2],
                        explanation: 'Tachycardia, hepatomegaly, and poor feeding are classic signs of cardiac failure in infants. Dry skin is not a typical sign.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv6',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the normal capillary refill time in children?',
                        options: ['<1 second', '<2 seconds', '<3 seconds', '<5 seconds'],
                        correct: 1,
                        explanation: 'Normal capillary refill time is less than 2 seconds. Prolonged CRT may indicate poor perfusion.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv7',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'The ductus arteriosus normally closes within the first 24-48 hours of life.',
                        correct: true,
                        explanation: 'The ductus arteriosus typically closes functionally within 24-48 hours after birth, with complete anatomical closure by 2-3 weeks.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv8',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Which congenital heart defect is characterized by four anomalies including VSD, overriding aorta, pulmonary stenosis, and right ventricular hypertrophy?',
                        options: ['Transposition of great arteries', 'Tetralogy of Fallot', 'Coarctation of aorta', 'Patent ductus arteriosus'],
                        correct: 1,
                        explanation: 'Tetralogy of Fallot consists of four defects: VSD, overriding aorta, pulmonary stenosis, and right ventricular hypertrophy.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv9',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'During which embryonic period does most cardiac development occur?',
                        options: ['Weeks 1-2', 'Weeks 3-8', 'Weeks 9-12', 'Weeks 13-16'],
                        correct: 1,
                        explanation: 'Most congenital heart defects arise during weeks 3-8 when the heart tubes fuse and beat (week 3), loop (weeks 4-5), undergo septation and outflow tract splitting (weeks 5-6), and valves form (week 7).'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv10',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are the three fetal shunts that bypass the lungs? (Select all that apply)',
                        options: ['Ductus venosus', 'Foramen ovale', 'Ductus arteriosus', 'Ductus thoracicus'],
                        correct: [0, 1, 2],
                        explanation: 'The three fetal shunts are: Ductus venosus (bypasses liver), Foramen ovale (RA → LA, bypasses RV/lungs), and Ductus arteriosus (PA → aorta, bypasses lungs). Ductus thoracicus is the thoracic duct (lymphatic system), not a fetal circulatory shunt.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv11',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'In fetal circulation, which vessel carries oxygen-RICH blood from the placenta to the fetus?',
                        options: ['Umbilical arteries (2)', 'Umbilical vein (1)', 'Ductus arteriosus', 'Pulmonary artery'],
                        correct: 1,
                        explanation: 'The umbilical VEIN carries oxygen-rich blood FROM placenta TO fetus (unusual as veins typically carry deoxygenated blood). Umbilical ARTERIES carry deoxygenated blood FROM fetus TO placenta.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv12',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What causes the ductus arteriosus to close after birth?',
                        options: ['Increased oxygen levels', 'Decreased prostaglandins', 'Increased blood pressure', 'Cord clamping'],
                        correct: 1,
                        explanation: 'Decreased prostaglandin levels after birth cause the ductus arteriosus to close over days-weeks. Failure to close results in patent ductus arteriosus (PDA). This is why duct-dependent lesions require prostaglandin (PGE) infusion to keep the duct open.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv13',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'The foramen ovale closes quickly after birth due to increased left atrial pressure from increased pulmonary blood flow.',
                        correct: true,
                        explanation: 'First breaths decrease pulmonary vascular resistance → increased lung blood flow → increased left atrial pressure → closes foramen ovale. The ductus venosus closes when the cord is clamped, and the ductus arteriosus closes over days-weeks as prostaglandins decrease.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv14',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the correct sequence of blood flow through the heart valves using the mnemonic "Try Pulling My Aorta"?',
                        options: ['Tricuspid → Pulmonary → Mitral → Aortic', 'Aortic → Mitral → Pulmonary → Tricuspid', 'Pulmonary → Tricuspid → Aortic → Mitral', 'Mitral → Aortic → Tricuspid → Pulmonary'],
                        correct: 0,
                        explanation: 'Mnemonic "Try Pulling My Aorta" = Tricuspid → Pulmonary → Mitral → Aortic. Full pathway: SVC/IVC → RA → Tricuspid → RV → Pulmonary valve → PA → Lungs → PV → LA → Mitral → LV → Aortic valve → Aorta → Body.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv15',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'The left ventricle has a thicker wall than the right ventricle because it pumps blood to the systemic circulation at higher pressure.',
                        correct: true,
                        explanation: 'The LEFT heart pumps to systemic circulation (high pressure) and has a thick muscular wall. The RIGHT heart pumps to pulmonary circulation (low pressure) and has a thinner wall.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv16',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the formula for cardiac output?',
                        options: ['CO = BP × SVR', 'CO = HR × SV', 'CO = SV × SVR', 'CO = MAP × HR'],
                        correct: 1,
                        explanation: 'Cardiac Output (CO) = Heart Rate (HR) × Stroke Volume (SV). Children cannot significantly increase stroke volume, so they compensate for decreased perfusion by increasing heart rate (tachycardia). This is why tachycardia is an early warning sign in paediatric shock.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv17',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which factors determine stroke volume? (Select all that apply)',
                        options: ['Preload', 'Afterload', 'Contractility', 'Heart rate'],
                        correct: [0, 1, 2],
                        explanation: 'Stroke volume is determined by: PRELOAD (volume returning to heart), AFTERLOAD (resistance heart pumps against), and CONTRACTILITY (strength of heart muscle contraction). Heart rate affects cardiac output but not stroke volume directly. In children, decreased preload (e.g., from vomiting/diarrhoea) decreases SV, triggering compensatory tachycardia.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv18',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the formula for blood pressure?',
                        options: ['BP = CO + SVR', 'BP = CO × SVR', 'BP = CO ÷ SVR', 'BP = HR × SV'],
                        correct: 1,
                        explanation: 'Blood Pressure (BP) = Cardiac Output (CO) × Systemic Vascular Resistance (SVR). Systolic BP = pressure during ventricular contraction. Diastolic BP = resting resistance pressure. In children, hypotension is a LATE sign of shock - rely on perfusion signs instead.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv19',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are key signs to assess in paediatric circulatory assessment (C in ABCDE)? (Select all that apply)',
                        options: ['Heart rate', 'Capillary refill time', 'Urine output', 'Respiratory rate'],
                        correct: [0, 1, 2],
                        explanation: 'Circulation assessment includes: heart rate, central + peripheral pulses, capillary refill time (<2-3s normal), colour/temperature, blood pressure trend, urine output (≥1 mL/kg/hr normal), and conscious level. Respiratory rate is part of airway/breathing assessment, not circulation.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv20',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are RED FLAGS indicating poor perfusion in children? (Select all that apply)',
                        options: ['Capillary refill >3 seconds', 'Cold peripheries and weak pulses', 'Tachycardia progressing to bradycardia', 'Pink, warm extremities'],
                        correct: [0, 1, 2],
                        explanation: 'Red flags for poor perfusion: CRT >3s, pale/mottled/cyanotic skin, cold limbs, weak/absent pulses, decreased urine output, lethargy/irritability, tachycardia (early) → bradycardia (late pre-arrest sign). Pink warm extremities indicate good perfusion.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv21',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'In a 3-month-old with poor feeding and tachycardia, what is the most likely physiological mechanism?',
                        options: ['Increased stroke volume compensation', 'Decreased preload causing decreased SV, compensated by increased HR', 'Primary cardiac arrhythmia', 'Hypertension'],
                        correct: 1,
                        explanation: 'Poor feeding/vomiting → dehydration → decreased preload → decreased stroke volume. Since infants cannot significantly increase SV, they compensate by increasing heart rate to maintain cardiac output (CO = HR × SV). This is why tachycardia is an early warning sign in paediatric illness.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv22',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the initial fluid bolus in acute management of poor perfusion/shock?',
                        options: ['5 mL/kg 0.9% NaCl', '10 mL/kg 0.9% NaCl', '20 mL/kg 0.9% NaCl', '50 mL/kg 0.9% NaCl'],
                        correct: 2,
                        explanation: 'Initial fluid resuscitation = 20 mL/kg 0.9% sodium chloride IV/IO bolus, then REASSESS. If poor perfusion persists, repeat bolus and consider inotropes per protocol. For duct-dependent cardiac lesions, start prostaglandin (PGE) to keep ductus arteriosus open.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv23',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which structure prevents the atrioventricular (AV) valves from prolapsing during ventricular contraction?',
                        options: ['Pericardium', 'Chordae tendineae and papillary muscles', 'Septum', 'Fossa ovalis'],
                        correct: 1,
                        explanation: 'Chordae tendineae (cord-like tendons) attach to papillary muscles and prevent the tricuspid and mitral valves from prolapsing backward into the atria during ventricular contraction. The fossa ovalis is the remnant of the foramen ovale.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv24',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which congenital heart defects are ACYANOTIC? (Select all that apply)',
                        options: ['Atrial septal defect (ASD)', 'Ventricular septal defect (VSD)', 'Tetralogy of Fallot', 'Patent ductus arteriosus (PDA)'],
                        correct: [0, 1, 3],
                        explanation: 'Acyanotic CHDs (left-to-right shunts): ASD, VSD, PDA, pulmonary stenosis, coarctation of aorta. Cyanotic CHDs (right-to-left shunts or mixing): Tetralogy of Fallot, Transposition of Great Arteries, atresias, Hypoplastic Left Heart Syndrome, truncus arteriosus.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv25',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Which chromosomal abnormality is associated with atrioventricular septal defect (AVSD)?',
                        options: ['Turner syndrome (45,X)', 'Down syndrome (Trisomy 21)', '22q11 deletion (DiGeorge)', 'Klinefelter syndrome (47,XXY)'],
                        correct: 1,
                        explanation: 'CHD associations: Down syndrome (Trisomy 21) → AVSD. Turner syndrome (45,X) → coarctation of aorta. 22q11 deletion (DiGeorge) → Tetralogy of Fallot, truncus arteriosus. These associations are important for targeted cardiac screening.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv26',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are common presenting features of congenital heart disease in infants? (Select all that apply)',
                        options: ['Heart murmur', 'Poor feeding and sweating during feeds', 'Persistent central cyanosis', 'Jaundice'],
                        correct: [0, 1, 2],
                        explanation: 'Common CHD presentations: heart murmur, tachypnoea, sweating during feeds/poor feeding, poor weight gain/failure to thrive, cyanosis (especially with crying/feeding), recurrent chest infections. Brief transient "blue" at birth can be normal, but PERSISTENT central cyanosis is a red flag requiring investigation.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv27',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is Kawasaki disease and what is the main complication?',
                        options: ['Bacterial infection causing endocarditis', 'Vasculitis in children <5 years causing coronary artery aneurysms', 'Congenital structural heart defect', 'Inherited cardiomyopathy'],
                        correct: 1,
                        explanation: 'Kawasaki disease is an acquired condition (vasculitis) typically affecting children <5 years. Presents with prolonged fever, mucosal changes (strawberry tongue, cracked lips), rash, conjunctivitis, lymphadenopathy, and swollen hands/feet. Main complication = coronary artery aneurysms. Treatment = IVIG + aspirin.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv28',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What does PEA stand for and how is it managed?',
                        options: ['Pulmonary Embolism Alert - give thrombolytics', 'Pulseless Electrical Activity - treat as cardiac arrest', 'Premature Ectopic Arrhythmia - observe', 'Patent Ectopic Atrium - surgical repair'],
                        correct: 1,
                        explanation: 'PEA = Pulseless Electrical Activity. The ECG shows organized electrical activity, but there is NO palpable pulse. This is a non-shockable cardiac arrest rhythm. Management = CPR + adrenaline + treat reversible causes (4 Hs and 4 Ts).'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv29',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'In paediatric shock, hypotension is an early and reliable sign.',
                        correct: false,
                        explanation: 'FALSE. In children, hypotension is a LATE sign of shock indicating decompensation. Children compensate well through tachycardia and vasoconstriction, maintaining blood pressure until cardiovascular collapse is imminent. Rely on early perfusion signs: CRT, pulse quality, colour, temperature, mental status, urine output.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cv30',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is a duct-dependent cardiac lesion and what medication keeps the duct open?',
                        options: ['Lesions requiring open foramen ovale; use digoxin', 'Lesions requiring patent ductus arteriosus for survival; use prostaglandin E (PGE)', 'Lesions requiring closed ductus venosus; use indomethacin', 'Lesions requiring high blood pressure; use adrenaline'],
                        correct: 1,
                        explanation: 'Duct-dependent lesions require a patent ductus arteriosus for adequate pulmonary or systemic blood flow (e.g., severe pulmonary stenosis, hypoplastic left heart, critical coarctation). Treatment = prostaglandin E (PGE) infusion to keep the duct OPEN until surgical correction. The opposite is PDA closure using indomethacin/ibuprofen.'
                    , topic: 'cardiovascular'},
      {
                        id: 'cd1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'At what age do most children start to walk independently?',
                        options: ['6-9 months', '9-12 months', '12-15 months', '18-24 months'],
                        correct: 2,
                        explanation: 'Most children begin walking independently between 12-15 months, though the normal range is 9-18 months.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd2',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which reflex should disappear by 4-6 months of age?',
                        options: ['Gag reflex', 'Moro reflex', 'Pupillary reflex', 'Cough reflex'],
                        correct: 1,
                        explanation: 'The Moro (startle) reflex typically disappears by 4-6 months as the nervous system matures.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd3',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Social smile typically appears at around 6-8 weeks of age.',
                        correct: true,
                        explanation: 'Social smiling, where babies smile in response to faces and voices, typically emerges around 6-8 weeks.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd4',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'According to Piaget, what stage of cognitive development occurs from birth to 2 years?',
                        options: ['Preoperational', 'Sensorimotor', 'Concrete operational', 'Formal operational'],
                        correct: 1,
                        explanation: 'The sensorimotor stage (0-2 years) is when children learn through sensory experiences and motor activities.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd5',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are typical developmental milestones at 12 months? (Select all that apply)',
                        options: ['Says 1-3 words', 'Pincer grasp', 'Runs well', 'Stranger anxiety'],
                        correct: [0, 1, 3],
                        explanation: 'At 12 months, children typically say a few words, have pincer grasp, and show stranger anxiety. Running well develops later.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd6',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the approximate head circumference of a newborn?',
                        options: ['30-32 cm', '33-35 cm', '36-38 cm', '39-41 cm'],
                        correct: 1,
                        explanation: 'Average head circumference at birth is approximately 33-35 cm (13-14 inches).'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd7',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'The anterior fontanelle typically closes by 3-6 months of age.',
                        correct: false,
                        explanation: 'The anterior fontanelle typically closes between 12-18 months. The posterior fontanelle closes by 2-3 months.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd8',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'According to Erikson\'s stages, what is the developmental crisis of toddlerhood (1-3 years)?',
                        options: ['Trust vs Mistrust', 'Autonomy vs Shame and Doubt', 'Initiative vs Guilt', 'Industry vs Inferiority'],
                        correct: 1,
                        explanation: 'Autonomy vs Shame and Doubt is the developmental crisis of toddlerhood, where children develop independence and self-control.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd9',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'During which embryonic period does the neural tube close?',
                        options: ['Week 1-2', 'Week 3-4', 'Week 5-6', 'Week 7-8'],
                        correct: 1,
                        explanation: 'The neural tube closes during weeks 3-4 of embryonic development. Failure to close results in neural tube defects like spina bifida or anencephaly. Folic acid supplementation before and during early pregnancy helps prevent these defects.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd10',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are teratogens that can affect fetal development? (Select all that apply)',
                        options: ['Alcohol', 'Folic acid', 'Rubella virus', 'Isotretinoin (Accutane)'],
                        correct: [0, 2, 3],
                        explanation: 'Teratogens are substances that can cause congenital abnormalities. Alcohol causes Fetal Alcohol Syndrome (growth restriction, facial abnormalities, brain damage). Rubella causes heart defects, deafness, and cataracts. Isotretinoin causes severe craniofacial and cardiac defects. Folic acid is protective, not a teratogen.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd11',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'The critical period for limb development is weeks 4-8 of pregnancy.',
                        correct: true,
                        explanation: 'Weeks 4-8 are the critical period for limb development. Teratogen exposure during this time (e.g., thalidomide) can cause limb malformations. Different organs have different critical periods when they are most vulnerable to teratogens.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd12',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What does the Developmental Origins of Health and Disease (DOHaD) hypothesis propose?',
                        options: ['All diseases are genetic', 'Early life environment programs future disease risk', 'Development stops at birth', 'Only postnatal factors affect health'],
                        correct: 1,
                        explanation: 'DOHaD proposes that environmental factors during critical developmental periods (preconception, pregnancy, early childhood) can "program" the body in ways that increase risk of chronic diseases later in life (obesity, diabetes, cardiovascular disease). Example: low birth weight is associated with increased adult disease risk.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd13',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Fetal Alcohol Syndrome is characterized by which features?',
                        options: ['Macrocephaly and tall stature', 'Microcephaly, smooth philtrum, thin upper lip, growth restriction', 'Neural tube defects', 'Limb reduction defects'],
                        correct: 1,
                        explanation: 'Fetal Alcohol Syndrome (FAS) features include: microcephaly (small head), facial abnormalities (smooth philtrum, thin upper lip, small eye openings), growth restriction, and brain damage affecting cognition and behavior. There is NO safe amount of alcohol during pregnancy.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd14',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'The embryonic period (weeks 3-8) is when major organs form and is most vulnerable to teratogens.',
                        correct: true,
                        explanation: 'The embryonic period (weeks 3-8) is when organogenesis occurs - all major organs and structures form. This is the most critical period for teratogen exposure, which can cause major structural abnormalities. The fetal period (week 9-birth) involves growth and functional maturation.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd15',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'At what age do most children start to walk independently?',
                        options: ['6-8 months', '9-11 months', '12-15 months', '18-24 months'],
                        correct: 2,
                        explanation: 'Most children walk independently between 12-15 months. Range of normal is 9-18 months.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd16',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which primitive reflex should disappear by 4-6 months?',
                        options: ['Babinski reflex', 'Moro reflex', 'Plantar grasp', 'All of the above'],
                        correct: 1,
                        explanation: 'The Moro (startle) reflex should disappear by 4-6 months. Persistence may indicate neurological problems.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd17',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Head circumference is an important measure of brain growth in infants.',
                        correct: true,
                        explanation: 'Head circumference reflects brain growth and should be measured regularly in the first 2 years. Abnormal growth may indicate hydrocephalus or microcephaly.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd18',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'At what age can a child typically build a tower of 2 blocks?',
                        options: ['9 months', '12 months', '15 months', '24 months'],
                        correct: 2,
                        explanation: 'Tower of 2 blocks: 15 months. Tower of 6 blocks: 2 years. Tower of 8+ blocks: 3 years.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd19',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are red flags for developmental delay at 12 months? (Select all that apply)',
                        options: ['No babbling', 'Not responding to name', 'Not sitting independently', 'Not walking'],
                        correct: [0, 1, 2],
                        explanation: 'At 12 months, no babbling, not responding to name, and not sitting are red flags. Not walking is normal - walking range is 9-18 months.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd20',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the typical age for a child to speak in 2-word phrases?',
                        options: ['12 months', '18 months', '24 months', '36 months'],
                        correct: 2,
                        explanation: '2-word phrases emerge around 18-24 months. By 2 years, children should have 50+ words and be combining words.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd21',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'The anterior fontanelle typically closes by what age?',
                        options: ['2-3 months', '6-9 months', '12-18 months', '24-36 months'],
                        correct: 2,
                        explanation: 'The anterior fontanelle closes between 12-18 months. The posterior fontanelle closes by 2-3 months.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd22',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'A child should have a social smile by 6 weeks of age.',
                        correct: true,
                        explanation: 'Social smiling (responsive smiling to faces) emerges around 6 weeks. Absence may indicate visual impairment or developmental delay.'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd23',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'By what age should a child achieve bladder control during the day?',
                        options: ['18 months', '2 years', '3-4 years', '5-6 years'],
                        correct: 2,
                        explanation: 'Most children achieve daytime bladder control by 3-4 years. Night-time control often takes longer (up to age 5-6 is normal).'
                    , topic: 'childDevelopment'},
      {
                        id: 'cd24',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What does "stranger anxiety" typically indicate?',
                        options: ['Abnormal development', 'Normal attachment development', 'Autism spectrum disorder', 'Hearing impairment'],
                        correct: 1,
                        explanation: 'Stranger anxiety (7-9 months) indicates healthy attachment and cognitive development - the child can distinguish caregivers from strangers.'
                    , topic: 'childDevelopment'},
      {
                        id: 'ge1',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'In autosomal dominant inheritance, what is the risk of an affected parent passing the condition to their child?',
                        options: ['25%', '50%', '75%', '100%'],
                        correct: 1,
                        explanation: 'Autosomal dominant conditions have a 50% risk with each pregnancy if one parent is affected. Only one copy of the altered gene is needed to cause the condition. Examples include Huntington disease, achondroplasia, and Marfan syndrome.'
                    , topic: 'genetics'},
      {
                        id: 'ge2',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'In autosomal recessive inheritance, what is the risk if both parents are carriers?',
                        options: ['25% affected, 50% carriers, 25% unaffected', '50% affected, 50% unaffected', '75% affected, 25% unaffected', '100% carriers'],
                        correct: 0,
                        explanation: 'When both parents are carriers of an autosomal recessive condition: 25% chance child is affected, 50% chance child is a carrier (like parents), 25% chance child is unaffected. Examples include cystic fibrosis, sickle cell disease, and phenylketonuria (PKU).'
                    , topic: 'genetics'},
      {
                        id: 'ge3',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'X-linked recessive conditions primarily affect males.',
                        correct: true,
                        explanation: 'X-linked recessive conditions primarily affect males because they have only one X chromosome (XY). If that X carries the mutation, they will be affected. Females (XX) are usually carriers because they have a second normal X chromosome. Examples: Duchenne muscular dystrophy, hemophilia A, color blindness.'
                    , topic: 'genetics'},
      {
                        id: 'ge4',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'If a carrier mother has a son, what is the probability he will be affected by her X-linked recessive condition?',
                        options: ['0%', '25%', '50%', '100%'],
                        correct: 2,
                        explanation: 'A carrier mother (XᴬXᵃ) has a 50% chance of passing the affected X chromosome to her son. Sons who inherit the affected X (XᵃY) will be affected because they have no second X to compensate. Daughters have 50% chance of being carriers.'
                    , topic: 'genetics'},
      {
                        id: 'ge5',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the chromosomal abnormality in Down syndrome?',
                        options: ['Monosomy 21', 'Trisomy 21', 'Trisomy 18', 'Monosomy X'],
                        correct: 1,
                        explanation: 'Down syndrome is caused by Trisomy 21 (three copies of chromosome 21 instead of two). Features include intellectual disability, characteristic facial features, hypotonia, congenital heart defects, and increased risk of leukemia and early-onset Alzheimer\'s.'
                    , topic: 'genetics'},
      {
                        id: 'ge6',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Edwards syndrome is caused by which chromosomal abnormality?',
                        options: ['Trisomy 13', 'Trisomy 18', 'Trisomy 21', '45,X'],
                        correct: 1,
                        explanation: 'Edwards syndrome is Trisomy 18. It causes severe intellectual disability, heart defects, clenched fists with overlapping fingers, and rocker-bottom feet. Most affected infants do not survive beyond the first year of life. More severe than Down syndrome.'
                    , topic: 'genetics'},
      {
                        id: 'ge7',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Patau syndrome is characterized by which chromosomal abnormality?',
                        options: ['Trisomy 13', 'Trisomy 18', 'Trisomy 21', '47,XXY'],
                        correct: 0,
                        explanation: 'Patau syndrome is Trisomy 13. It is the most severe autosomal trisomy compatible with life, causing severe intellectual disability, cleft lip/palate, polydactyly (extra fingers/toes), and heart defects. Most infants die within the first year.'
                    , topic: 'genetics'},
      {
                        id: 'ge8',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Turner syndrome affects which sex and has which chromosomal pattern?',
                        options: ['Males, 47,XXY', 'Females, 45,X', 'Males, 47,XYY', 'Females, 47,XXX'],
                        correct: 1,
                        explanation: 'Turner syndrome affects females with karyotype 45,X (missing one X chromosome). Features include short stature, webbed neck, lymphedema, heart defects (coarctation of aorta), and ovarian dysgenesis (infertility). Intelligence is usually normal.'
                    , topic: 'genetics'},
      {
                        id: 'ge9',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Klinefelter syndrome affects which sex and has which chromosomal pattern?',
                        options: ['Males, 47,XXY', 'Females, 45,X', 'Males, 47,XYY', 'Females, 47,XXX'],
                        correct: 0,
                        explanation: 'Klinefelter syndrome affects males with karyotype 47,XXY (extra X chromosome). Features include tall stature, small testes, gynecomastia (breast development), infertility due to reduced testosterone, and may have mild learning difficulties. Often not diagnosed until puberty or adulthood.'
                    , topic: 'genetics'},
      {
                        id: 'ge10',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are features of Down syndrome (Trisomy 21)? (Select all that apply)',
                        options: ['Single palmar crease', 'Upslanting palpebral fissures', 'Webbed neck', 'Increased risk of congenital heart defects'],
                        correct: [0, 1, 3],
                        explanation: 'Down syndrome features include: single palmar crease, upslanting palpebral fissures, flat facial profile, small ears, protruding tongue, hypotonia, congenital heart defects (40-50%, especially AVSD), duodenal atresia, and increased leukemia risk. Webbed neck is a feature of Turner syndrome, not Down syndrome.'
                    , topic: 'genetics'},
      {
                        id: 'ge11',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'The risk of chromosomal abnormalities increases with maternal age.',
                        correct: true,
                        explanation: 'Advanced maternal age (especially >35 years) significantly increases risk of chromosomal abnormalities, particularly trisomies (Down syndrome, Edwards syndrome, Patau syndrome). This is due to errors in meiosis during egg formation. Antenatal screening and diagnostic tests are offered to older mothers.'
                    , topic: 'genetics'},
      {
                        id: 'ge12',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Which inheritance pattern would you suspect if a condition affects males and females equally, appears in every generation, and affected individuals usually have an affected parent?',
                        options: ['Autosomal recessive', 'Autosomal dominant', 'X-linked recessive', 'X-linked dominant'],
                        correct: 1,
                        explanation: 'This describes autosomal dominant inheritance: affects both sexes equally, vertical transmission (appears in every generation), affected individuals typically have an affected parent, and 50% risk to offspring. Examples: Huntington disease, neurofibromatosis, familial hypercholesterolemia.'
                    , topic: 'genetics'},
      {
                        id: 'ge13',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'How many chromosomes does a normal human cell contain?',
                        options: ['23', '44', '46', '48'],
                        correct: 2,
                        explanation: '46 chromosomes (23 pairs) - 22 pairs of autosomes plus 2 sex chromosomes (XX female, XY male).'
                    , topic: 'genetics'},
      {
                        id: 'ge14',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Cystic fibrosis is an autosomal recessive condition.',
                        correct: true,
                        explanation: 'CF is autosomal recessive - both parents must be carriers for a child to be affected (25% chance each pregnancy).'
                    , topic: 'genetics'},
      {
                        id: 'ge15',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is Patau syndrome?',
                        options: ['Trisomy 13', 'Trisomy 18', 'Trisomy 21', 'Monosomy X'],
                        correct: 0,
                        explanation: 'Patau syndrome is Trisomy 13 - severe intellectual disability, cleft lip/palate, polydactyly, heart defects. Most die within first year.'
                    , topic: 'genetics'},
      {
                        id: 'ge16',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Turner syndrome (45,X) affects which sex?',
                        options: ['Males only', 'Females only', 'Both equally', 'Neither'],
                        correct: 1,
                        explanation: 'Turner syndrome affects females only - missing one X chromosome (45,X). Features include short stature, webbed neck, and infertility.'
                    , topic: 'genetics'},
      {
                        id: 'ge17',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which conditions are X-linked recessive? (Select all that apply)',
                        options: ['Duchenne muscular dystrophy', 'Haemophilia A', 'Cystic fibrosis', 'Red-green color blindness'],
                        correct: [0, 1, 3],
                        explanation: 'DMD, Haemophilia A, and color blindness are X-linked recessive. CF is autosomal recessive.'
                    , topic: 'genetics'},
      {
                        id: 'ge18',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is a carrier in genetics?',
                        options: ['Someone with the disease', 'Someone with one copy of a recessive gene who is unaffected', 'Someone immune to the disease', 'A dominant gene holder'],
                        correct: 1,
                        explanation: 'A carrier has one copy of a recessive gene mutation but is unaffected because the normal gene compensates. They can pass the gene to offspring.'
                    , topic: 'genetics'},
      {
                        id: 'ge19',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Klinefelter syndrome (47,XXY) affects males and causes infertility.',
                        correct: true,
                        explanation: 'Klinefelter (47,XXY) affects males - tall stature, small testes, infertility, gynecomastia, learning difficulties.'
                    , topic: 'genetics'},
      {
                        id: 'ge20',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'In mitochondrial inheritance, who passes the condition to offspring?',
                        options: ['Father only', 'Mother only', 'Both parents equally', 'Neither - it is spontaneous'],
                        correct: 1,
                        explanation: 'Mitochondrial DNA is inherited only from the mother (egg contains mitochondria, sperm does not contribute). All children of affected mothers will inherit the mutation.'
                    , topic: 'genetics'},
      {
                        id: 'fe1',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What percentage of total body weight is water in a newborn?',
                        options: ['50%', '60%', '70%', '80%'],
                        correct: 3,
                        explanation: 'Newborns have approximately 80% total body water, decreasing to 60% by one year and 60% in adults. This higher water content makes infants more vulnerable to dehydration and fluid imbalances.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe2',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What percentage of body weight is intracellular fluid (ICF) in children?',
                        options: ['20%', '30%', '40%', '60%'],
                        correct: 2,
                        explanation: 'Intracellular fluid (ICF) comprises approximately 40% of body weight. Extracellular fluid (ECF) is approximately 20%, which includes interstitial fluid (15%) and plasma (5%). ICF contains high K⁺ and Mg²⁺; ECF contains high Na⁺ and Cl⁻.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe3',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are signs of mild dehydration (3-5% fluid loss)? (Select all that apply)',
                        options: ['Slightly dry mucous membranes', 'Normal heart rate', 'Reduced urine output', 'Sunken fontanelle'],
                        correct: [0, 2],
                        explanation: 'Mild dehydration (3-5% loss) signs include: slightly dry mucous membranes, normal or slightly increased heart rate, reduced urine output, mild thirst. Sunken fontanelle indicates moderate-severe dehydration. Children can appear clinically well with mild dehydration.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe4',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are signs of moderate dehydration (6-9% fluid loss)? (Select all that apply)',
                        options: ['Tachycardia', 'Sunken eyes', 'Reduced skin turgor', 'Cool peripheries'],
                        correct: [0, 1, 2],
                        explanation: 'Moderate dehydration (6-9% loss) signs include: tachycardia, sunken eyes, sunken fontanelle (infants), reduced skin turgor, dry mucous membranes, decreased urine output, lethargy. Cool peripheries suggest severe dehydration/shock.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe5',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are signs of severe dehydration (≥10% fluid loss)? (Select all that apply)',
                        options: ['Prolonged capillary refill (>3 seconds)', 'Weak or absent peripheral pulses', 'Reduced consciousness', 'Normal blood pressure'],
                        correct: [0, 1, 2],
                        explanation: 'Severe dehydration (≥10% loss) signs include: prolonged capillary refill >3 seconds, weak/absent peripheral pulses, tachycardia then bradycardia, hypotension (late sign), reduced consciousness, cool mottled peripheries, minimal/no urine output. This is a medical emergency requiring IV resuscitation.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe6',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Infants are more prone to dehydration than adults due to higher insensible water losses.',
                        correct: true,
                        explanation: 'Infants have higher insensible water losses due to: higher surface area:body weight ratio (increased evaporation), higher respiratory rate (increased respiratory losses), higher metabolic rate, and immature kidney function (unable to concentrate urine as effectively). This makes them vulnerable to rapid dehydration.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe7',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which electrolyte imbalance is most dangerous in terms of cardiac effects?',
                        options: ['Hyponatremia', 'Hypernatremia', 'Hypokalemia', 'Hyperkalemia'],
                        correct: 3,
                        explanation: 'Hyperkalemia (high potassium) is most immediately life-threatening due to cardiac effects. It causes ECG changes (tall T waves, wide QRS) and can lead to fatal arrhythmias including ventricular fibrillation and asystole. Requires urgent treatment with calcium gluconate (cardiac protection), insulin-glucose, and salbutamol.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe8',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Hyponatremia in children is most commonly caused by:',
                        options: ['Excessive sodium intake', 'Excessive water intake or retention', 'Excessive sweating', 'High salt diet'],
                        correct: 1,
                        explanation: 'Hyponatremia (low sodium <135 mmol/L) is usually caused by excessive water intake or water retention (SIADH, heart/kidney/liver failure, or dilute formula in infants). Can cause seizures if severe (<120 mmol/L) or rapid onset. Correct slowly to avoid osmotic demyelination syndrome.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe9',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the main risk of correcting hypernatremia (high sodium) too quickly?',
                        options: ['Hyperkalemia', 'Cerebral edema', 'Metabolic acidosis', 'Hypoglycemia'],
                        correct: 1,
                        explanation: 'Rapid correction of hypernatremia (>145 mmol/L) can cause cerebral edema as water shifts into brain cells faster than the brain can adjust. Correction should be slow (decrease by <0.5 mmol/L/hour or <10-12 mmol/L/day) to prevent this life-threatening complication.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe10',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Oral rehydration solution (ORS) is preferred over IV fluids for mild-moderate dehydration.',
                        correct: true,
                        explanation: 'ORS is first-line for mild-moderate dehydration - it\'s safe, effective, less invasive, and allows faster discharge. IV fluids are reserved for severe dehydration (≥10%), shock, persistent vomiting, or inability to tolerate oral fluids. WHO ORS contains optimal sodium and glucose concentrations for absorption.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe11',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which fluid compartment is lost first in dehydration from gastroenteritis?',
                        options: ['Intracellular fluid (ICF)', 'Extracellular fluid (ECF)', 'Plasma only', 'All compartments equally'],
                        correct: 1,
                        explanation: 'Extracellular fluid (ECF) is lost first in gastroenteritis-induced dehydration (vomiting/diarrhea). ECF contains the sodium and water lost in stool/vomit. As ECF volume decreases, signs like sunken eyes, reduced skin turgor, and tachycardia appear. This is why we assess "extracellular" signs clinically.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe12',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which conditions put children at higher risk for hypokalemia (low potassium)? (Select all that apply)',
                        options: ['Persistent vomiting', 'Chronic diarrhea', 'Diuretic therapy', 'Renal failure'],
                        correct: [0, 1, 2],
                        explanation: 'Hypokalemia (<3.5 mmol/L) is caused by GI losses (vomiting, diarrhea - potassium rich), diuretics (increased renal losses), or inadequate intake. Can cause muscle weakness, arrhythmias, and potentiates digoxin toxicity. Renal failure typically causes HYPERkalemia due to reduced excretion.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe13',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the normal serum sodium range?',
                        options: ['125-135 mmol/L', '135-145 mmol/L', '145-155 mmol/L', '155-165 mmol/L'],
                        correct: 1,
                        explanation: 'Normal serum sodium is 135-145 mmol/L. Below 135 is hyponatraemia, above 145 is hypernatraemia.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe14',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Oral rehydration solution (ORS) is the first-line treatment for mild-moderate dehydration in gastroenteritis.',
                        correct: true,
                        explanation: 'ORS is first-line for mild-moderate dehydration. It replaces water, glucose, and electrolytes effectively. IV fluids are reserved for severe dehydration or if ORS fails.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe15',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the normal serum potassium range?',
                        options: ['2.5-3.5 mmol/L', '3.5-5.0 mmol/L', '5.0-6.5 mmol/L', '6.5-8.0 mmol/L'],
                        correct: 1,
                        explanation: 'Normal potassium is 3.5-5.0 mmol/L. Both hypo- and hyperkalaemia can cause dangerous cardiac arrhythmias.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe16',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which ECG changes suggest hyperkalaemia? (Select all that apply)',
                        options: ['Peaked T waves', 'Widened QRS', 'Flattened P waves', 'Prominent U waves'],
                        correct: [0, 1, 2],
                        explanation: 'Hyperkalaemia causes: peaked T waves (early), widened QRS, flattened P waves, and eventually sine wave pattern. Prominent U waves suggest HYPOkalaemia.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe17',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'In dehydration assessment, what does "skin turgor" test?',
                        options: ['Temperature', 'Elasticity/hydration of skin', 'Color', 'Blood flow'],
                        correct: 1,
                        explanation: 'Skin turgor tests skin elasticity - pinch skin on abdomen, it should snap back immediately. Slow return ("tenting") indicates dehydration.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe18',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What type of fluid is 0.9% sodium chloride (normal saline)?',
                        options: ['Hypotonic', 'Isotonic', 'Hypertonic', 'Colloid'],
                        correct: 1,
                        explanation: '0.9% NaCl is isotonic - same osmolarity as blood. Used for fluid resuscitation. Hypotonic fluids can cause cerebral oedema.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe19',
                        type: 'tf',
                        difficulty: 'hard',
                        question: 'A sunken fontanelle in an infant indicates dehydration.',
                        correct: true,
                        explanation: 'Sunken fontanelle is a reliable sign of moderate-severe dehydration in infants. A bulging fontanelle may indicate raised intracranial pressure.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'fe20',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the initial fluid bolus for a child in hypovolaemic shock?',
                        options: ['5 ml/kg', '10 ml/kg', '20 ml/kg', '50 ml/kg'],
                        correct: 2,
                        explanation: '20 ml/kg bolus of isotonic crystalloid (0.9% saline) given rapidly. Reassess and repeat up to 3 times if needed.'
                    , topic: 'fluidsElectrolytes'},
      {
                        id: 'mh1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the holistic definition of child mental health?',
                        options: ['Absence of mental illness only', 'Ability to learn, play, relate, regulate emotions, cope and seek help', 'Normal behaviour at all times', 'High academic achievement'],
                        correct: 1,
                        explanation: 'Child mental health is the ability to learn, play, relate to others, regulate emotions, cope with challenges, and seek help when needed - NOT just the absence of mental illness. It\'s a positive, functional definition.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh2',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'In children, behaviour should be viewed as a form of communication.',
                        correct: true,
                        explanation: 'TRUE. Use a developmental lens - behaviour IS communication. Children often express distress through behaviour rather than words, especially younger children who lack the language to articulate feelings.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh3',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'How might mental health difficulties present in infants and toddlers? (Select all that apply)',
                        options: ['Excessive crying', 'Sleep/feeding changes', 'Clinginess', 'Attachment disruption'],
                        correct: [0, 1, 2, 3],
                        explanation: 'Infants/toddlers lack verbal skills, so mental health difficulties present through: excessive/inconsolable crying, sleep pattern changes, feeding difficulties, clinginess, and attachment disruption. These are pre-verbal distress signals.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh4',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'How might mental health difficulties present in preschool children? (Select all that apply)',
                        options: ['Severe tantrums', 'Separation anxiety', 'Aggression', 'Regression in toileting/speech'],
                        correct: [0, 1, 2, 3],
                        explanation: 'Preschoolers (3-5 years) may show: severe/prolonged tantrums, separation anxiety, increased aggression, and regression in previously acquired skills (toileting accidents, speech regression). Regression is a red flag for stress.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh5',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'How might mental health difficulties present in school-age children? (Select all that apply)',
                        options: ['Somatic complaints (headaches, tummy aches)', 'Irritability', 'School refusal', 'Academic/peer problems'],
                        correct: [0, 1, 2, 3],
                        explanation: 'School-age children (5-12 years) often present with: somatic complaints (headaches, abdominal pain with no physical cause), irritability, school refusal/avoidance, declining academic performance, and peer relationship difficulties.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh6',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'How might mental health difficulties present in adolescents? (Select all that apply)',
                        options: ['Low mood/anxiety', 'Risk-taking behaviour', 'Substance use', 'Body image/identity issues'],
                        correct: [0, 1, 2, 3],
                        explanation: 'Adolescents may present with: low mood, anxiety, increased risk-taking, substance experimentation/use, body image concerns, identity stress, self-harm, and withdrawal. Adolescence is high-risk for emergence of serious mental illness.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh7',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are RISK factors for child mental health difficulties? (Select all that apply)',
                        options: ['Trauma/abuse/neglect', 'Secure attachment', 'Family conflict', 'Social isolation'],
                        correct: [0, 2, 3],
                        explanation: 'Risk factors include: trauma/abuse/neglect, bullying, family conflict, poverty/deprivation, parental mental health problems, chronic illness, bereavement, neurodiversity (ADHD/ASD), and social isolation. Secure attachment is PROTECTIVE, not a risk.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh8',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are PROTECTIVE factors for child mental health? (Select all that apply)',
                        options: ['Secure attachment', 'Consistent caregiving', 'Social isolation', 'Emotional literacy/coping skills'],
                        correct: [0, 1, 3],
                        explanation: 'Protective factors include: secure attachment, consistent caregiving, supportive adults, school belonging, friendships, hobbies/meaningful activities, emotional literacy/coping skills, and access to services. Social isolation is a RISK factor.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh9',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the outcome of secure attachment in childhood?',
                        options: ['No impact on development', 'Caregiver responsive → better emotional regulation and resilience', 'Guaranteed mental health', 'Academic success only'],
                        correct: 1,
                        explanation: 'Secure attachment (caregiver is responsive, consistent, attuned) leads to better emotional regulation, resilience, and capacity for healthy relationships. It\'s THE most important protective factor for mental health.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh10',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What pattern is associated with insecure attachment?',
                        options: ['Always leads to mental illness', 'Caregiver inconsistent/unavailable → anxious or avoidant patterns', 'No effect on child', 'Only affects physical health'],
                        correct: 1,
                        explanation: 'Insecure attachment (caregiver inconsistent or emotionally unavailable) can lead to anxious attachment (clingy, hypervigilant to abandonment) or avoidant attachment (distant, self-reliant, difficulty trusting). Increases vulnerability to mental health difficulties.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh11',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is disorganised attachment and what is the outcome?',
                        options: ['Normal variation with no impact', 'Caregiver = source of fear AND comfort → highest risk', 'Only occurs in adolescence', 'Easily resolved with minimal intervention'],
                        correct: 1,
                        explanation: 'Disorganised attachment occurs when caregiver is BOTH the source of fear (abuse/threat) AND the source of comfort. This paradox causes confusion and is the HIGHEST RISK attachment pattern for mental health difficulties, trauma, and relationship problems.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh12',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'What should be your clinical approach with attachment difficulties? (Select all that apply)',
                        options: ['Be predictable and consistent', 'Take rejection personally', 'Build trust slowly', 'Demand immediate trust'],
                        correct: [0, 2],
                        explanation: 'Clinical approach to attachment difficulties: be predictable/consistent, don\'t take rejection or testing behaviour personally, build trust SLOWLY over time, maintain boundaries, be transparent. Rushing trust or taking behaviour personally damages therapeutic relationship.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh13',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which domains should be assessed when recognizing mental health concerns? (Select all that apply)',
                        options: ['Emotional', 'Behavioural', 'Physical', 'Social'],
                        correct: [0, 1, 2, 3],
                        explanation: 'Assess across ALL domains: Emotional (mood, anxiety), Behavioural (withdrawal, aggression, regression), Physical (sleep, appetite, somatic symptoms), Cognitive (concentration, thoughts), and Social (relationships, isolation). Multi-domain change = higher concern.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh14',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which emotional symptoms suggest mental health concern? (Select all that apply)',
                        options: ['Persistent sadness/irritability', 'Anxiety', 'Brief upset after disappointment', 'Anhedonia (loss of pleasure)'],
                        correct: [0, 1, 3],
                        explanation: 'Concerning emotional symptoms: PERSISTENT sadness or irritability (not brief reactive upset), anxiety, numbness/emotional blunting, guilt, anhedonia (can\'t enjoy previously loved activities). Key = change from baseline + duration (weeks+) + severity.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh15',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which behavioural symptoms suggest mental health concern? (Select all that apply)',
                        options: ['Withdrawal', 'Occasional misbehaviour', 'Risk-taking', 'Developmental regression'],
                        correct: [0, 2, 3],
                        explanation: 'Concerning behavioural changes: withdrawal from people/activities, aggression, risk-taking, regression (loss of skills), school avoidance, compulsions. Occasional age-appropriate misbehaviour is NORMAL. Look for CHANGE from baseline + functional impairment.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh16',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which physical symptoms may indicate mental health difficulties? (Select all that apply)',
                        options: ['Sleep changes', 'Appetite changes', 'Fatigue', 'Unexplained headaches/abdominal pain'],
                        correct: [0, 1, 2, 3],
                        explanation: 'Physical presentations of mental distress: sleep changes (insomnia/hypersomnia), appetite changes (under/overeating), fatigue/low energy, recurrent headaches or abdominal pain without physical cause (somatisation). Always screen for physical causes FIRST.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh17',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Concern should increase when symptoms last weeks or longer, are severe, cause functional impairment, and affect multiple domains.',
                        correct: true,
                        explanation: 'TRUE. Red flags = duration (weeks+), severity, functional impairment (can\'t do school/relationships/activities), and multi-domain involvement (emotional + behavioural + physical + social). Single-domain brief changes are less concerning.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh18',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are RED FLAGS requiring URGENT same-day assessment? (Select all that apply)',
                        options: ['Suicidal thoughts with plan/intent', 'Mild anxiety', 'Psychosis (hallucinations/delusions)', 'Severe agitation/violence risk'],
                        correct: [0, 2, 3],
                        explanation: 'URGENT red flags requiring same-day/crisis assessment: suicidal thoughts/plan/intent, escalating/high-lethality self-harm, psychosis, severe agitation/violence, refusal to eat/drink, acute safeguarding disclosure, severe dissociation/catatonia, rapid deterioration. Mild anxiety is NOT an urgent red flag.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh19',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'When assessing a child with mental health symptoms, you should always consider and screen for underlying physical causes first.',
                        correct: true,
                        explanation: 'TRUE. AVOID DIAGNOSTIC OVERSHADOWING. Always consider physical causes: anaemia, thyroid disease, diabetes, infection, medication/substance effects, pain, neurological/endocrine disorders. Do observations + basic physical exam. This is a critical safety principle.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh20',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the first-line treatment for anxiety disorders in children?',
                        options: ['Benzodiazepines', 'Cognitive Behavioural Therapy (CBT)', 'Antipsychotics', 'Immediate hospitalization'],
                        correct: 1,
                        explanation: 'Anxiety: excessive worry + avoidance + physical arousal (racing heart, trembling). First-line = CBT (exposure, cognitive restructuring). SSRIs sometimes used with specialist input for moderate-severe cases. Avoid benzodiazepines in children.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh21',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are features of depression in children? (Select all that apply)',
                        options: ['Low mood or irritability', 'Anhedonia', 'Sleep/appetite/energy changes', 'Brief sadness after disappointment'],
                        correct: [0, 1, 2],
                        explanation: 'Depression features: low mood OR irritability (not just sadness), anhedonia (loss of pleasure/interest), sleep changes, appetite changes, low energy, guilt, poor concentration, hopelessness. ALWAYS assess suicide risk. Brief sadness after disappointment is normal grief/adjustment.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh22',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are appropriate interventions for childhood depression? (Select all that apply)',
                        options: ['Behavioural activation + routines', 'CBT/IPT/family therapy', 'Tell them to "cheer up"', 'Medication with specialist oversight if needed'],
                        correct: [0, 1, 3],
                        explanation: 'Depression management: behavioural activation (structured activities/routines), CBT/Interpersonal Therapy/family therapy, ± medication (fluoxetine first-line SSRI) with specialist input for moderate-severe cases. NEVER tell a depressed child to "cheer up" - this invalidates their experience.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh23',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the gold standard treatment for OCD in children?',
                        options: ['Reassurance', 'Exposure and Response Prevention (ERP)', 'Avoiding triggers', 'Antibiotics'],
                        correct: 1,
                        explanation: 'OCD = obsessions (intrusive thoughts) + compulsions (rituals to reduce anxiety). Reassurance-seeking MAINTAINS the cycle. Gold standard treatment = Exposure and Response Prevention (ERP) - gradual exposure to triggers WITHOUT performing compulsions. ± SSRI if severe.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh24',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are features of trauma-related difficulties in children? (Select all that apply)',
                        options: ['Hypervigilance', 'Nightmares', 'Regression', 'Dissociation'],
                        correct: [0, 1, 2, 3],
                        explanation: 'Trauma presentations: hypervigilance (always on alert), nightmares/flashbacks, regression (loss of skills), dissociation (spacing out), re-enactment through play, avoidance. Trauma-informed care principles: safety, choice, predictability, collaboration. Build sense of control.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh25',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'What monitoring is essential for eating disorders? (Select all that apply)',
                        options: ['Vital signs', 'ECG', 'Blood tests', 'No monitoring needed'],
                        correct: [0, 1, 2],
                        explanation: 'Eating disorders carry HIGH MEDICAL RISK (cardiac arrhythmias, refeeding syndrome, electrolyte imbalance, bradycardia, hypotension). Monitor: vitals, ECG (for QTc prolongation), bloods (electrolytes, FBC, LFTs, glucose, phosphate). Urgent specialist referral if red flags (severe malnutrition, syncope, bradycardia).'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh26',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is self-harm and how should it be understood?',
                        options: ['Always a suicide attempt', 'A coping strategy, but increases suicide risk', 'Attention-seeking behaviour to ignore', 'Only occurs in severe mental illness'],
                        correct: 1,
                        explanation: 'Self-harm is primarily a COPING STRATEGY for overwhelming emotions (not usually suicidal intent), BUT it DOES increase suicide risk. Assess intent, means, lethality, frequency. Create safety plan. Provide non-judgmental wound care. Never dismiss as "attention-seeking" - it signals distress.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh27',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'What are essential communication principles when working with children with mental health concerns? (Select all that apply)',
                        options: ['Calm, non-judgmental approach', 'Age-appropriate language', 'Validate feelings', 'Explain confidentiality limits'],
                        correct: [0, 1, 2, 3],
                        explanation: 'Communication essentials: calm, non-judgmental, age-appropriate language, validate feelings ("that sounds really hard"), explain confidentiality limits clearly (will share if safety risk), allow time, don\'t pressure disclosure. Work collaboratively with family/school/MDT.'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh28',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Asking a child directly about self-harm or suicide can "put ideas in their head" and should be avoided.',
                        correct: false,
                        explanation: 'FALSE. This is a dangerous myth. Asking directly about self-harm/suicide does NOT "put ideas in their head". It opens conversation, shows you care, and allows assessment of risk. Use clear, direct questions: "Have you thought about hurting yourself?" or "Have you had thoughts of suicide?"'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh29',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'When should you refer for specialist mental health support? (Select all that apply)',
                        options: ['Red flag symptoms (suicide/psychosis/severe risk)', 'Symptoms not improving with initial support', 'Complex presentations', 'All children with any worry'],
                        correct: [0, 1, 2],
                        explanation: 'Refer to CAMHS/crisis/safeguarding when: red flag symptoms present, symptoms persist/worsen despite initial support, complex/severe presentations, diagnostic uncertainty, need for specialist therapy/medication. NOT all children with any worry - many respond to universal/targeted school-based support first (stepped care model).'
                    , topic: 'mentalHealth'},
      {
                        id: 'mh30',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'A 14-year-old presents with recurrent headaches and abdominal pain for 6 weeks. School attendance has dropped, and parents report increasing withdrawal. What is your priority?',
                        options: ['Refer to gastroenterology immediately', 'Reassure that it\'s just stress', 'Screen for physical causes (bloods, BP, neuro exam) AND explore psychosocial factors', 'Discharge with analgesia advice'],
                        correct: 2,
                        explanation: 'This is a classic somatisation presentation. Priority = dual approach: (1) Screen for physical causes (FBC, TFTs, coeliac, BP, neuro exam) to avoid diagnostic overshadowing, AND (2) explore psychosocial factors (school stress, bullying, family issues, anxiety, depression). Somatic symptoms are REAL distress signals - never just "in their head".'
                    , topic: 'mentalHealth'},
      {
                        id: 'nu1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the recommended exclusive breastfeeding duration according to WHO?',
                        options: ['3 months', '4 months', '6 months', '12 months'],
                        correct: 2,
                        explanation: 'WHO recommends exclusive breastfeeding for approximately 6 months, with continued breastfeeding alongside complementary foods up to 2 years or beyond if desired.'
                    , topic: 'nutrition'},
      {
                        id: 'nu2',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the "First 1000 Days" critical window in child development?',
                        options: ['Birth to 3 years', 'Conception to age 2', 'Pregnancy only', 'Birth to 1 year'],
                        correct: 1,
                        explanation: 'The First 1000 Days spans from conception through to age 2 years. This is a critical window for brain, organ, and immune system development, with long-term impacts on health including obesity, type 2 diabetes, cardiovascular disease, and cognition.'
                    , topic: 'nutrition'},
      {
                        id: 'nu3',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which components make breastmilk a "living fluid"? (Select all that apply)',
                        options: ['Antibodies (IgA)', 'Enzymes and hormones', 'Growth factors', 'Artificial preservatives'],
                        correct: [0, 1, 2],
                        explanation: 'Breastmilk is called a "living fluid" because it contains antibodies (particularly IgA), enzymes, hormones, and growth factors that support the baby\'s developing microbiome and immune system, reducing infection risk. It does not contain artificial preservatives.'
                    , topic: 'nutrition'},
      {
                        id: 'nu4',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What water temperature should be used when preparing powdered infant formula?',
                        options: ['Room temperature', '40°C', '70°C', '100°C (boiling)'],
                        correct: 2,
                        explanation: 'Powdered formula should be prepared using cooled boiled water at approximately 70°C to kill potential bacteria in the powder, with sterile equipment. This is part of safe formula preparation guidance.'
                    , topic: 'nutrition'},
      {
                        id: 'nu5',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'At approximately what age should solid foods (weaning) be introduced?',
                        options: ['3-4 months', '4-5 months', 'Around 6 months', '8-9 months'],
                        correct: 2,
                        explanation: 'Solids should be introduced around 6 months when the baby can sit with good head control, coordinate hand-to-mouth movements, and shows interest in food. This timing balances developmental readiness with nutritional needs.'
                    , topic: 'nutrition'},
      {
                        id: 'nu6',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are signs a baby is ready for solid foods? (Select all that apply)',
                        options: ['Can sit with good head control', 'Coordinate hand-to-mouth', 'Shows interest in food', 'Has first tooth'],
                        correct: [0, 1, 2],
                        explanation: 'Developmental readiness signs include sitting with good head control, coordinating hand-to-mouth movements, and showing interest in food. Having teeth is not required - gums are strong enough to mash soft foods.'
                    , topic: 'nutrition'},
      {
                        id: 'nu7',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Introducing solids before 4 months increases the risk of infections and allergies.',
                        correct: true,
                        explanation: 'Starting solids too early (<4 months) increases infection and allergy risk because the gut is not developmentally ready. Starting too late can lead to iron deficiency and delayed oral motor skills/texture acceptance.'
                    , topic: 'nutrition'},
      {
                        id: 'nu8',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which should be prioritized as first foods during weaning? (Select all that apply)',
                        options: ['Iron-rich foods (meat, lentils)', 'Fortified cereals', 'Fruit purees only', 'Added salt/sugar foods'],
                        correct: [0, 1],
                        explanation: 'Iron-rich foods should be introduced early during weaning - meat, lentils/beans, and fortified cereals are key. Fruit is fine but should not be the only food offered. Avoid added salt and sugar in infant foods.'
                    , topic: 'nutrition'},
      {
                        id: 'nu9',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'Why should honey NOT be given to babies under 1 year old?',
                        options: ['Allergy risk', 'Botulism risk', 'Choking hazard', 'Too much sugar'],
                        correct: 1,
                        explanation: 'Honey should not be given to babies under 1 year due to the risk of infant botulism. Honey can contain Clostridium botulinum spores which can germinate in an infant\'s immature gut.'
                    , topic: 'nutrition'},
      {
                        id: 'nu10',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the recommended approach to introducing common allergens (eggs, peanuts) during weaning?',
                        options: ['Avoid until age 3', 'Introduce early in small amounts', 'Only if no family history of allergy', 'Wait until after all other foods tried'],
                        correct: 1,
                        explanation: 'Current guidance recommends introducing common allergens (egg, peanut, etc.) early during weaning in small amounts, unless the child is high-risk. Early introduction may help prevent allergy development. Follow local advice for high-risk infants.'
                    , topic: 'nutrition'},
      {
                        id: 'nu11',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the recommended texture progression during weaning?',
                        options: ['Smooth only until 12 months', 'Smooth → lumpy → finger foods', 'Finger foods from the start only', 'Lumpy → smooth → finger foods'],
                        correct: 1,
                        explanation: 'Progress textures gradually from smooth purees → lumpy/mashed → finger foods. This helps develop oral motor skills and prevents feeding difficulties. Encourage self-feeding where safe to promote independence and motor development.'
                    , topic: 'nutrition'},
      {
                        id: 'nu12',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the recommended daily vitamin D supplement dose for babies under 1 year?',
                        options: ['5 µg', '10 µg', '15 µg', '20 µg'],
                        correct: 1,
                        explanation: 'Babies under 1 year should receive 10 µg (400 IU) of vitamin D daily, UNLESS they are taking more than 500 mL of infant formula per day (which is already fortified). This prevents rickets.'
                    , topic: 'nutrition'},
      {
                        id: 'nu13',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which groups should receive 10 µg daily vitamin D supplementation in the UK? (Select all that apply)',
                        options: ['All children aged 1-4 years', 'Pregnant women', 'Breastfeeding women', 'Only in summer months'],
                        correct: [0, 1, 2],
                        explanation: 'UK guidance recommends 10 µg daily vitamin D for: children 1-4 years (often year-round), pregnant women, and breastfeeding women. Many people are advised to supplement particularly in autumn/winter due to limited UK sunlight.'
                    , topic: 'nutrition'},
      {
                        id: 'nu14',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Cow\'s milk is typically fortified with vitamin D in the UK.',
                        correct: false,
                        explanation: 'FALSE. Unlike some other countries, cow\'s milk in the UK is typically NOT fortified with vitamin D. This makes supplementation particularly important. Infant formula IS fortified with vitamin D.'
                    , topic: 'nutrition'},
      {
                        id: 'nu15',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the primary function of vitamin D in children?',
                        options: ['Immune function only', 'Vision development', 'Calcium and phosphate regulation for bones/teeth', 'Blood clotting'],
                        correct: 2,
                        explanation: 'Vitamin D\'s primary function is regulating calcium and phosphate metabolism, which is essential for healthy bones and teeth. Deficiency causes rickets in children. Sources include sunlight (limited in UK winter), oily fish, eggs, and fortified foods.'
                    , topic: 'nutrition'},
      {
                        id: 'nu16',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are functions of vitamin A? (Select all that apply)',
                        options: ['Vision in low light (prevents night blindness)', 'Immunity support', 'Epithelial tissue integrity', 'Blood glucose regulation'],
                        correct: [0, 1, 2],
                        explanation: 'Vitamin A functions include: vision adaptation to low light (deficiency causes night blindness), immune system support, and maintaining epithelial tissue integrity. Sources include dairy, eggs, oily fish, and beta-carotene vegetables (carrots, sweet potato, spinach). Blood glucose regulation is not a function of vitamin A.'
                    , topic: 'nutrition'},
      {
                        id: 'nu17',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Vitamin C deficiency causes which condition?',
                        options: ['Rickets', 'Night blindness', 'Scurvy', 'Anaemia'],
                        correct: 2,
                        explanation: 'Vitamin C deficiency causes scurvy, characterized by bleeding gums, poor wound healing, and easy bruising. Vitamin C is needed for collagen synthesis, wound healing, acts as an antioxidant, and increases iron absorption. Sources include citrus fruits, berries, peppers, broccoli, and potatoes.'
                    , topic: 'nutrition'},
      {
                        id: 'nu18',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which micronutrients are particularly important during pregnancy for fetal development? (Select all that apply)',
                        options: ['Folate (neural tube protection)', 'Iodine (thyroid/brain development)', 'Iron (maternal anaemia prevention)', 'Vitamin K'],
                        correct: [0, 1, 2],
                        explanation: 'Key pregnancy micronutrients include: Folate (folic acid supplementation prevents neural tube defects like spina bifida), Iodine (thyroid hormone production essential for brain development - found in dairy/seafood), and Iron (prevents maternal anaemia and supports fetal development). While vitamin K is important, it\'s typically given to newborns rather than being a prenatal supplement focus.'
                    , topic: 'nutrition'},
      {
                        id: 'nu19',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the Healthy Start scheme in the UK?',
                        options: ['Free gym membership for children', 'Vouchers/card for milk, fruit, veg, and vitamins for eligible low-income families', 'Free school meals only', 'Childcare vouchers'],
                        correct: 1,
                        explanation: 'Healthy Start is a UK public health scheme providing vouchers/prepaid card for milk, fruit, vegetables, and vitamins to eligible low-income pregnant women and families with children under 4. Nurses play a key role in signposting families to reduce inequalities.'
                    , topic: 'nutrition'},
      {
                        id: 'nu20',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'What is the recommended eating pattern for children aged 1-5 years? (Select all that apply)',
                        options: ['3 main meals', '2-3 snacks (treated as mini-meals)', '1-2 large meals only', 'Snacking throughout the day continuously'],
                        correct: [0, 1],
                        explanation: 'Children aged 1-5 need 3 main meals plus 2-3 planned snacks per day. Snacks should be treated as "mini-meals" (not continuous grazing), providing nutritious foods like fruit, veg, cheese, crackers. This pattern meets their higher nutritional needs per kg body weight.'
                    , topic: 'nutrition'},
      {
                        id: 'nu21',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is a simple portion size guide for young children?',
                        options: ['Adult portions', 'Child\'s hand or fist size', 'Half an adult portion exactly', 'As much as they can eat'],
                        correct: 1,
                        explanation: 'A practical portion guide for young children is to use their own hand or fist as a measure. This naturally scales to their body size and helps prevent over or under feeding. Portions should be adjusted based on hunger cues.'
                    , topic: 'nutrition'},
      {
                        id: 'nu22',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which drinks are recommended for young children aged 1-5? (Select all that apply)',
                        options: ['Water', 'Plain milk', 'Sugary drinks', 'Fruit juice (limited)'],
                        correct: [0, 1, 3],
                        explanation: 'Recommended drinks are water and plain milk (whole milk for 1-2 years, semi-skimmed from 2+ if eating well). Fruit juice should be limited to mealtimes only (150ml max) due to sugar and acid content. Sugary drinks should be avoided - linked to dental decay and obesity.'
                    , topic: 'nutrition'},
      {
                        id: 'nu23',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'How much physical activity is recommended daily for children under 5 in UK guidance?',
                        options: ['30 minutes', '1 hour', '2 hours', 'Approximately 3 hours varied activity'],
                        correct: 3,
                        explanation: 'UK guidance recommends approximately 3 hours of varied physical activity spread throughout the day for children under 5 (including active play, outdoor time, and movement). This supports healthy growth, development, motor skills, and reduces obesity risk.'
                    , topic: 'nutrition'},
      {
                        id: 'nu24',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are principles of responsive feeding and a positive feeding environment? (Select all that apply)',
                        options: ['Family meals together when possible', 'Regular meal/snack routines', 'Forcing child to finish their plate', 'Respecting hunger and fullness cues'],
                        correct: [0, 1, 3],
                        explanation: 'Positive feeding principles include: eating family meals together, establishing regular routines, and respecting the child\'s hunger/fullness cues. NEVER force a child to finish their plate - this overrides natural appetite regulation and can lead to overeating and unhealthy relationships with food.'
                    , topic: 'nutrition'},
      {
                        id: 'nu25',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the "Red Book" (PCHR) used for in child health?',
                        options: ['Emergency contact numbers only', 'Recording vaccinations and growth monitoring (weight/height centiles)', 'Food diary', 'Medication list only'],
                        correct: 1,
                        explanation: 'The Red Book (Personal Child Health Record - PCHR) records vaccinations AND growth measurements plotted on centile charts. This helps identify faltering growth (failure to thrive) or rapid weight gain early, allowing timely intervention.'
                    , topic: 'nutrition'},
      {
                        id: 'nu26',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What does the National Child Measurement Programme (NCMP) measure?',
                        options: ['Only children with obesity', 'All Reception (4-5 yrs) and Year 6 (10-11 yrs) children\'s height/weight for BMI', 'Only children under 2', 'Blood pressure in all children'],
                        correct: 1,
                        explanation: 'NCMP measures height and weight (to calculate BMI centile) for ALL children in Reception (age 4-5) and Year 6 (age 10-11) in England. This population-level data supports local health planning and provides families with information about their child\'s weight status.'
                    , topic: 'nutrition'},
      {
                        id: 'nu27',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'What is the nursing role in supporting infant and child nutrition? (Select all that apply)',
                        options: ['Identify nutritional risk factors (poverty, poor diet, feeding difficulties)', 'Signpost to Healthy Start and community support', 'Monitor growth using centile charts', 'Prescribe vitamin supplements independently'],
                        correct: [0, 1, 2],
                        explanation: 'Nurses play a crucial role in: identifying nutritional risk (poverty, inadequate diet, feeding difficulties), signposting families to schemes like Healthy Start to reduce inequalities, monitoring growth on centile charts, and escalating concerns early. Vitamin supplement prescribing typically requires medical prescriber authorization, though nurses provide education about their importance.'
                    , topic: 'nutrition'},
      {
                        id: 'nu28',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Children have higher nutritional requirements per kilogram of body weight than adults.',
                        correct: true,
                        explanation: 'TRUE. Children are not "small adults" - they have higher energy and nutrient requirements per kg body weight to support rapid growth and development. This is why frequent meals and nutrient-dense foods are important in childhood.'
                    , topic: 'nutrition'},
      {
                        id: 'nu29',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Iron deficiency in infancy/early childhood primarily affects which aspect of development?',
                        options: ['Bone growth only', 'Neurodevelopment and causes anaemia', 'Vision development', 'Kidney function'],
                        correct: 1,
                        explanation: 'Iron deficiency causes anaemia AND significantly affects neurodevelopment, potentially leading to cognitive and developmental delays. This is why iron-rich foods (meat, lentils, fortified cereals) should be introduced early during weaning around 6 months when infant iron stores from birth are depleted.'
                    , topic: 'nutrition'},
      {
                        id: 'nu30',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are good dietary sources of calcium for children? (Select all that apply)',
                        options: ['Dairy products (milk, cheese, yogurt)', 'Fortified plant-based milk alternatives', 'White bread (fortified in UK)', 'Sugary drinks'],
                        correct: [0, 1, 2],
                        explanation: 'Good calcium sources for bone and tooth development include: dairy products (milk, cheese, yogurt), fortified plant-based alternatives (soya, oat, almond milk - check labels), and fortified white bread/flour (UK law requires calcium fortification). Green leafy vegetables and tinned fish with bones also provide calcium. Sugary drinks do not provide calcium and should be avoided.'
                    , topic: 'nutrition'},
      {
                        id: 'gi1',
                        type: 'multiselect',
                        difficulty: 'easy',
                        question: 'Which are early warning signs of nutritional deficiency in children? (Select all that apply)',
                        options: ['Faltering growth centiles', 'Delayed developmental milestones', 'Irritability or poor concentration', 'Perfect school attendance'],
                        correct: [0, 1, 2],
                        explanation: 'Early clues of nutritional deficiency include faltering centiles (crossing down growth charts), delayed milestones, and behavioural changes like irritability or poor concentration. Good attendance is not a warning sign.'
                    , topic: 'giLiver'},
      {
                        id: 'gi2',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Why are children at higher risk of rapid hypoglycaemia during illness or fasting?',
                        options: ['They have larger glucose stores than adults', 'They have smaller glycogen stores and higher brain glucose demand', 'Their blood glucose is naturally higher', 'They produce more insulin'],
                        correct: 1,
                        explanation: 'Children have SMALLER glycogen stores in liver/muscle compared to adults, plus the brain has HIGH glucose demand. During illness, vomiting, or fasting, they can develop hypoglycaemia rapidly. This is why small frequent feeds and early intervention are critical.'
                    , topic: 'giLiver'},
      {
                        id: 'gi3',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are signs of hypoglycaemia in a child? (Select all that apply)',
                        options: ['Pallor and sweating', 'Tremor', 'Drowsiness or confusion', 'Hyperactivity'],
                        correct: [0, 1, 2],
                        explanation: 'Hypoglycaemia presents with: pallor, sweating, tremor, drowsiness, confusion, and can progress to seizures if untreated. Hyperactivity is not a typical sign. Nursing action: if able to feed → small frequent feeds; if unable → IV dextrose per protocol + monitor blood glucose.'
                    , topic: 'giLiver'},
      {
                        id: 'gi4',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which fat-soluble vitamins require adequate fat absorption?',
                        options: ['B, C, Folate, Thiamine', 'A, D, E, K', 'Iron, Calcium, Zinc', 'B12, B6, Niacin'],
                        correct: 1,
                        explanation: 'Fat-soluble vitamins are A, D, E, K (remember "ADEK"). They require dietary fat for absorption. In malabsorption conditions (CF, biliary obstruction), deficiency of these vitamins occurs, presenting as vision problems (A), rickets (D), bleeding (K), and neurological issues (E).'
                    , topic: 'giLiver'},
      {
                        id: 'gi5',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is steatorrhoea and what does it indicate?',
                        options: ['Blood in stool indicating GI bleeding', 'Pale, oily, floating stools indicating fat malabsorption', 'Watery stools from viral gastroenteritis', 'Hard, pellet-like stools from constipation'],
                        correct: 1,
                        explanation: 'Steatorrhoea = pale, oily, floating, foul-smelling stools caused by FAT malabsorption. Seen in cystic fibrosis (pancreatic insufficiency), biliary obstruction, coeliac disease. Also leads to poor growth and fat-soluble vitamin (ADEK) deficiency.'
                    , topic: 'giLiver'},
      {
                        id: 'gi6',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are signs of protein deficiency in children? (Select all that apply)',
                        options: ['Oedema (swelling)', 'Poor wound healing', 'Apathy or lethargy', 'Excessive energy'],
                        correct: [0, 1, 2],
                        explanation: 'Protein deficiency causes: oedema (low albumin → fluid leaks into tissues), poor wound healing (protein needed for tissue repair), and apathy/lethargy. Protein needs per kg are HIGHEST in early years due to rapid growth. Nursing: promote protein foods; escalate to dietitian if poor intake; consider NG/TPN in chronic illness.'
                    , topic: 'giLiver'},
      {
                        id: 'gi7',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Why do infants dehydrate faster than adults? (Select all that apply)',
                        options: ['Higher surface area to body mass ratio', 'Immature kidneys cannot concentrate urine effectively', 'Higher respiratory and insensible losses', 'Lower metabolic rate'],
                        correct: [0, 1, 2],
                        explanation: 'Infants dehydrate FAST due to: (1) higher surface area:body mass ratio (↑ evaporative losses), (2) immature kidneys (cannot concentrate urine well), (3) higher respiratory rate (↑ insensible losses). They actually have HIGHER metabolic rate, which increases vulnerability. Nursing priority: strict I/O, weigh nappies (1g = 1ml), daily weights.'
                    , topic: 'giLiver'},
      {
                        id: 'gi8',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'Iron deficiency in children primarily causes which condition?',
                        options: ['Rickets', 'Anaemia', 'Night blindness', 'Bleeding disorders'],
                        correct: 1,
                        explanation: 'Iron deficiency causes ANAEMIA (low haemoglobin → reduced oxygen transport). Presents with fatigue, pallor, poor attention/concentration, and can affect development. Toddlers at highest risk. Ensure iron-rich foods: meat, lentils, fortified cereals. Vitamin C enhances iron absorption.'
                    , topic: 'giLiver'},
      {
                        id: 'gi9',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Calcium and Vitamin D deficiency in children causes which condition?',
                        options: ['Anaemia', 'Rickets', 'Scurvy', 'Beriberi'],
                        correct: 1,
                        explanation: 'Calcium + Vitamin D deficiency causes RICKETS - defective bone mineralization leading to soft, weak bones, bowed legs, delayed dentition, and increased fracture risk. All infants should receive vitamin D supplementation (8.5-10 mcg daily) as UK sunlight is insufficient, especially in winter.'
                    , topic: 'giLiver'},
      {
                        id: 'gi10',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Infants have a more mature digestive system than adults, with higher gastric acid and fully developed liver enzymes.',
                        correct: false,
                        explanation: 'FALSE. Infants have an IMMATURE GI system: lower gastric acid, immature enzymes, and immature liver function. This means they need small frequent feeds, have higher infection risk (weaker acid barrier), and are prone to physiological jaundice (immature liver conjugation). Diarrhoea/vomiting causes quicker electrolyte shifts.'
                    , topic: 'giLiver'},
      {
                        id: 'gi11',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'A child presents with vomiting. Where is the likely problem located?',
                        options: ['Large intestine', 'Stomach, obstruction, or reflux', 'Small intestine only', 'Rectum'],
                        correct: 1,
                        explanation: 'Vomiting typically indicates problems at the STOMACH level or above (reflux, gastritis, obstruction, pyloric stenosis). Main nursing concerns: dehydration and aspiration risk. Diarrhoea = small bowel/infection. Constipation = colon/withholding.'
                    , topic: 'giLiver'},
      {
                        id: 'gi12',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is a common cause of feeding refusal and weight faltering related to oral health in children?',
                        options: ['Enlarged tonsils', 'Dental caries (tooth decay)', 'Tongue tie', 'Cleft palate'],
                        correct: 1,
                        explanation: 'Dental CARIES (tooth decay) causes pain → feeding refusal → weight faltering. Prevention: brush teeth with fluoride toothpaste twice daily, avoid bottle/juice overnight (causes "bottle caries"). Good oral health is essential for nutrition.'
                    , topic: 'giLiver'},
      {
                        id: 'gi13',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are RED FLAG symptoms in a vomiting child requiring urgent escalation? (Select all that apply)',
                        options: ['Projectile vomiting', 'Bile-stained (green) vomit', 'Blood in vomit', 'Single episode of posseting after feed'],
                        correct: [0, 1, 2],
                        explanation: 'RED FLAGS requiring URGENT review: (1) Projectile vomiting (especially 2-8 weeks = ?pyloric stenosis), (2) BILE-STAINED (green) vomit = intestinal obstruction until proven otherwise, (3) Blood in vomit, (4) Associated poor growth/dehydration. Mild posseting (small amounts) is common/normal in infants due to weak lower oesophageal sphincter.'
                    , topic: 'giLiver'},
      {
                        id: 'gi14',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Pyloric stenosis typically presents at what age with what type of vomiting?',
                        options: ['Birth with bile-stained vomiting', '2-8 weeks with progressive projectile non-bilious vomiting', '6 months with bloody vomiting', '2 years with intermittent vomiting'],
                        correct: 1,
                        explanation: 'Pyloric stenosis = hypertrophic narrowing of pylorus. Presents at 2-8 WEEKS with PROGRESSIVE PROJECTILE NON-BILIOUS vomiting after feeds. May have visible peristalsis, palpable "olive" mass. Causes hypochloraemic hypokalaemic alkalosis. Requires URGENT surgical referral (pyloromyotomy).'
                    , topic: 'giLiver'},
      {
                        id: 'gi15',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'How does Oral Rehydration Solution (ORS) work in the small intestine?',
                        options: ['Osmosis only', 'Glucose-sodium co-transport allows active absorption even during diarrhoea', 'Passive diffusion', 'Requires normal bowel function to work'],
                        correct: 1,
                        explanation: 'ORS works via GLUCOSE-SODIUM CO-TRANSPORT in the small intestine. Glucose actively pulls sodium (and water follows) into the bloodstream, even during diarrhoea when passive absorption is impaired. This is why ORS is first-line for mild-moderate dehydration - it\'s effective, safe, and non-invasive. IV fluids reserved for severe dehydration/shock.'
                    , topic: 'giLiver'},
      {
                        id: 'gi16',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which should be included in constipation management for children? (Select all that apply)',
                        options: ['Regular toileting routine after meals', 'Increased fluids and fibre', 'Using Bristol Stool Chart to assess', 'Punishing the child for accidents'],
                        correct: [0, 1, 2],
                        explanation: 'Constipation management: (1) Regular toileting routine especially AFTER MEALS (gastrocolic reflex), (2) ↑ fluids + fibre, (3) Bristol Stool Chart to track progress, (4) Movicol/laxatives if needed, (5) Positive encouragement - NEVER punish accidents (worsens withholding). Chronic constipation → rectal stretch → overflow soiling (encopresis).'
                    , topic: 'giLiver'},
      {
                        id: 'gi17',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are concerning features in a child with constipation requiring further investigation? (Select all that apply)',
                        options: ['Ribbon stools', 'Blood in stool', 'Persistent soiling despite management', 'Occasional hard stools'],
                        correct: [0, 1, 2],
                        explanation: 'RED FLAGS for constipation requiring investigation: ribbon stools (narrow calibre), blood, persistent soiling despite treatment, delayed passage of meconium, failure to thrive. Consider Hirschsprung\'s disease (absent ganglion cells → no peristalsis), structural abnormalities, or neurological causes. Occasional hard stools alone can be managed with dietary/behavioural measures.'
                    , topic: 'giLiver'},
      {
                        id: 'gi18',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the most common cause of acute gastroenteritis in children?',
                        options: ['Bacteria', 'Virus (rotavirus, norovirus)', 'Parasites', 'Food poisoning'],
                        correct: 1,
                        explanation: 'VIRAL infections are the most common cause of acute gastroenteritis in children, particularly rotavirus and norovirus. Management: ORS first-line, isolate (infection control), strict I&O monitoring, assess dehydration. Antibiotics NOT routinely needed (viral). Reserve for suspected bacterial causes (bloody diarrhoea, systemically unwell).'
                    , topic: 'giLiver'},
      {
                        id: 'gi19',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is coeliac disease and what is the main treatment?',
                        options: ['Wheat allergy; avoid wheat only', 'Gluten intolerance causing villous atrophy; lifelong gluten-free diet', 'Lactose intolerance; avoid dairy', 'Temporary food sensitivity; no long-term treatment needed'],
                        correct: 1,
                        explanation: 'Coeliac disease is an AUTOIMMUNE condition where gluten (wheat, barley, rye) causes villous atrophy in small intestine → malabsorption. Presents with poor growth, chronic diarrhoea, abdominal distension, fatigue. Diagnosis: serology (anti-tTG) + small bowel biopsy. Treatment: LIFELONG strict gluten-free diet + monitor growth/adherence.'
                    , topic: 'giLiver'},
      {
                        id: 'gi20',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Mild posseting (reflux) is common in infants. When should you be concerned and escalate?',
                        options: ['Any posseting is abnormal', 'If associated with poor growth, blood, bile, or dehydration', 'Only if the baby cries', 'Posseting is always serious'],
                        correct: 1,
                        explanation: 'Mild POSSETING (small amounts after feeds) is NORMAL in infants due to weak lower oesophageal sphincter. Management: upright positioning, smaller more frequent feeds. ESCALATE if: projectile vomiting, bile-stained (green), blood, poor weight gain, dehydration, or significant distress. These suggest GERD or other pathology requiring investigation.'
                    , topic: 'giLiver'},
      {
                        id: 'gi21',
                        type: 'multiselect',
                        difficulty: 'easy',
                        question: 'Which are functions of the liver? (Select all that apply)',
                        options: ['Bile production for fat absorption', 'Albumin and clotting factor production', 'Glucose storage and release', 'Red blood cell production'],
                        correct: [0, 1, 2],
                        explanation: 'Liver functions (remember "BAGDIC"): Bile production, Albumin + clotting factors, Glucose storage/release (glycogen), Detoxification, Immune filtering, vitamin/iron Storage. Red blood cell production occurs in bone marrow (adults) or liver/spleen (fetus). The liver is LARGE but functionally IMMATURE in infants → slower drug metabolism + jaundice risk.'
                    , topic: 'giLiver'},
      {
                        id: 'gi22',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which features suggest PATHOLOGICAL jaundice requiring urgent investigation? (Select all that apply)',
                        options: ['Jaundice >14 days in term baby', 'Pale (acholic) stools', 'Dark urine', 'Jaundice on day 2 of life only'],
                        correct: [0, 1, 2],
                        explanation: 'PATHOLOGICAL jaundice red flags: (1) Jaundice >14 days (term) or >21 days (preterm) = PROLONGED, (2) PALE STOOLS + DARK URINE = suggests biliary obstruction (e.g., biliary atresia - URGENT), (3) Jaundice in first 24 hours, (4) Very high bilirubin levels. Physiological jaundice is common days 2-14 and benign. Always check stool colour - pale stools = urgent surgical referral needed.'
                    , topic: 'giLiver'},
      {
                        id: 'gi23',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What causes pruritus (itching) in a child with cholestasis, and what are nursing interventions?',
                        options: ['Dry skin; use regular moisturiser only', 'Bile salt accumulation in skin; cool baths, emollients, short nails, escalate for medication', 'Allergic reaction; give antihistamines', 'Infection; use antibiotics'],
                        correct: 1,
                        explanation: 'Pruritus in cholestasis is caused by BILE SALT accumulation in the skin (liver cannot excrete bile properly). Causes severe itching → sleep loss, skin damage from scratching. Nursing interventions: cool baths, emollients, keep nails SHORT (prevent injury), loose cotton clothing. Escalate for antipruritic medications (e.g., ursodeoxycholic acid, rifampicin). This significantly impacts quality of life.'
                    , topic: 'giLiver'},
      {
                        id: 'gi24',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Why do children with liver disease experience faltering growth? (Select all that apply)',
                        options: ['Fat and vitamin malabsorption', 'Low glycogen reserves', 'Increased metabolic demands', 'They eat too much'],
                        correct: [0, 1, 2],
                        explanation: 'Faltering growth in liver disease occurs due to: (1) Fat/fat-soluble vitamin (ADEK) malabsorption (no bile → cannot absorb fats), (2) Low glycogen reserves (liver cannot store glucose effectively), (3) ↑ metabolic demands. Management: dietitian input, high-calorie feeds, ADEK vitamin supplementation, consider NG feeding if oral intake inadequate.'
                    , topic: 'giLiver'},
      {
                        id: 'gi25',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Phototherapy is a nursing care intervention for managing jaundice in newborns.',
                        correct: true,
                        explanation: 'TRUE. Phototherapy uses blue light to convert bilirubin into water-soluble form that can be excreted. Nursing care: protect eyes (cover), monitor temperature (risk overheating), ensure adequate hydration/feeding (helps clear bilirubin), frequent bilirubin level monitoring, family education about treatment and importance. Escalate if bilirubin continues rising despite phototherapy.'
                    , topic: 'giLiver'},
      {
                        id: 'gi26',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which should nurses always include in GI/nutrition assessment? (Select all that apply)',
                        options: ['Plot growth on centile charts', 'Assess intake and output', 'Monitor stool and vomit characteristics', 'Ignore family concerns'],
                        correct: [0, 1, 2],
                        explanation: 'NURSING PRIORITIES: (1) Plot weight, height, head circumference on CENTILE CHARTS (look for faltering = crossing down centiles), (2) Assess nutritional intake + strict I&O + hydration status, (3) Monitor stool (colour, consistency, frequency) + vomit (amount, colour, projectile?, bile-stained?), (4) Watch for RED FLAGS. Always LISTEN to family concerns - parents know their child best.'
                    , topic: 'giLiver'},
      {
                        id: 'gi27',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the significance of bile-stained (green) vomit in a child?',
                        options: ['Normal variant, no concern', 'Suggests intestinal obstruction until proven otherwise - URGENT', 'Indicates mild gastroenteritis', 'Only concerning if accompanied by fever'],
                        correct: 1,
                        explanation: 'BILE-STAINED (GREEN) VOMIT = intestinal obstruction below the ampulla of Vater until proven otherwise. This is a SURGICAL EMERGENCY. Causes include malrotation with volvulus (twisted bowel → ischaemia), intussusception, bowel obstruction. Requires URGENT assessment, NBM (nil by mouth), IV access, surgical review. NEVER dismiss green vomit.'
                    , topic: 'giLiver'},
      {
                        id: 'gi28',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which should be included in family education for a child with GI problems? (Select all that apply)',
                        options: ['Recognizing dehydration signs', 'When to seek urgent help (red flags)', 'Medication adherence', 'Positive toileting routines without punishment'],
                        correct: [0, 1, 2, 3],
                        explanation: 'Family education essentials: (1) Dehydration signs (dry mouth, reduced urine, sunken fontanelle, lethargy), (2) RED FLAGS requiring urgent help (bile-stained vomit, blood, severe pain, prolonged symptoms), (3) Medication adherence (complete courses, correct dosing), (4) Positive toileting approach (avoid punishment for accidents - worsens withholding). Empower families to recognize warning signs early.'
                    , topic: 'giLiver'},
      {
                        id: 'gi29',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'When should paediatric dosing be calculated, and what should be avoided in liver disease?',
                        options: ['Use adult doses; avoid all medications in liver disease', 'Use weight-based dosing (BNFc guidance); avoid hepatotoxic medications if liver disease', 'Double the dose for severe illness; no restrictions needed', 'Medication dosing is the same for all ages'],
                        correct: 1,
                        explanation: 'ALWAYS use PAEDIATRIC DOSING GUIDANCE (BNFc - British National Formulary for Children) - doses are WEIGHT-BASED, not age-based. In LIVER DISEASE: avoid hepatotoxic medications (e.g., paracetamol - use lower doses/longer intervals, NSAIDs, certain antibiotics). Remember infant liver is immature → slower drug metabolism → risk of toxicity. Dose adjustments may be needed.'
                    , topic: 'giLiver'},
      {
                        id: 'gi30',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'A 3-week-old baby presents with projectile vomiting after every feed, is hungry and eager to feed, and has lost weight. What should you suspect and what are the priorities? (Select all that apply)',
                        options: ['Pyloric stenosis - urgent surgical referral needed', 'Monitor hydration and electrolytes (risk hypochloraemic alkalosis)', 'Normal infant reflux - reassure parents only', 'Assess for palpable "olive" mass and visible peristalsis'],
                        correct: [0, 1, 3],
                        explanation: 'This is classic PYLORIC STENOSIS: 2-8 weeks, progressive projectile NON-BILIOUS vomiting, hungry baby (not keeping feeds down), weight loss. Examination may show palpable "olive" mass (RUQ) + visible gastric peristalsis (waves across abdomen during/after feed). Causes hypochloraemic hypokalaemic ALKALOSIS (losing HCl in vomit). URGENT surgical referral for pyloromyotomy. NOT normal reflux - the progressive nature and weight loss are key differentiators.'
                    , topic: 'giLiver'},
      {
                        id: 'en1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the main difference between endocrine and exocrine glands?',
                        options: ['Endocrine glands use ducts', 'Endocrine glands are ductless and release hormones into blood', 'Exocrine glands produce hormones', 'There is no difference'],
                        correct: 1,
                        explanation: 'Endocrine glands are DUCTLESS and secrete hormones directly into the bloodstream for slower, longer-lasting effects. Exocrine glands use ducts to secrete products (saliva, sweat, digestive enzymes) onto surfaces or into cavities.'
                    , topic: 'endocrine'},
      {
                        id: 'en2',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are examples of endocrine glands? (Select all that apply)',
                        options: ['Pituitary', 'Salivary glands', 'Thyroid', 'Sweat glands'],
                        correct: [0, 2],
                        explanation: 'ENDOCRINE (ductless, hormones to blood): pituitary, thyroid, adrenals, pancreatic islets. EXOCRINE (ducts to surfaces): salivary glands, sweat glands, mammary glands, digestive enzyme glands. Pancreas and liver have MIXED roles.'
                    , topic: 'endocrine'},
      {
                        id: 'en3',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Most hormones work via negative feedback loops to maintain homeostatic balance.',
                        correct: true,
                        explanation: 'TRUE. Most endocrine control uses NEGATIVE FEEDBACK - hormone levels rise → feedback inhibits further release. Example: ↑T3/T4 → ↓TSH/TRH. This maintains balance. Hormones need specific receptors on target cells to work.'
                    , topic: 'endocrine'},
      {
                        id: 'en4',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Why are children more vulnerable to rapid endocrine-related deterioration?',
                        options: ['They have stronger homeostatic mechanisms', 'They have immature homeostasis and small metabolic reserves', 'Their hormones work faster', 'They cannot produce hormones'],
                        correct: 1,
                        explanation: 'Children have IMMATURE homeostatic mechanisms + SMALL reserves (glucose stores, glycogen, fluid reserves), meaning they can deteriorate FAST when glucose, fluids, or blood pressure are compromised. This is why early recognition and intervention are critical.'
                    , topic: 'endocrine'},
      {
                        id: 'en5',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'Which part of the brain acts as the master endocrine control centre?',
                        options: ['Cerebellum', 'Hypothalamus', 'Medulla', 'Cerebrum'],
                        correct: 1,
                        explanation: 'The HYPOTHALAMUS is the master control centre, releasing hormones (CRH, TRH, GnRH, GHRH, dopamine) that regulate the pituitary gland. It links the nervous system to the endocrine system.'
                    , topic: 'endocrine'},
      {
                        id: 'en6',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which hormones are released by the ANTERIOR pituitary? (Select all that apply)',
                        options: ['ACTH', 'ADH', 'Growth hormone (GH)', 'Oxytocin'],
                        correct: [0, 2],
                        explanation: 'ANTERIOR pituitary produces: ACTH, TSH, GH, FSH/LH, prolactin. POSTERIOR pituitary STORES and RELEASES ADH and oxytocin (which are actually made in the hypothalamus). Remember: posterior = storage depot, not production site.'
                    , topic: 'endocrine'},
      {
                        id: 'en7',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are paediatric links to hypothalamic-pituitary dysfunction? (Select all that apply)',
                        options: ['Growth hormone deficiency causing poor growth velocity', 'Precocious puberty (girls <8, boys <9)', 'Diabetes insipidus (DI)', 'Rickets'],
                        correct: [0, 1, 2],
                        explanation: 'Paediatric hypothalamic-pituitary issues include: GH deficiency (poor growth velocity, short stature), precocious puberty (early sexual development), DI/SIADH (ADH problems). Rickets is caused by vitamin D deficiency, not pituitary dysfunction.'
                    , topic: 'endocrine'},
      {
                        id: 'en8',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What triggers ADH (antidiuretic hormone) release?',
                        options: ['Low blood osmolality', 'High blood osmolality or low blood pressure', 'High blood glucose', 'Low sodium only'],
                        correct: 1,
                        explanation: 'ADH is released from the POSTERIOR pituitary when blood osmolality is HIGH (concentrated blood) OR blood pressure is LOW. ADH makes kidneys RETAIN water → more concentrated urine → dilutes blood back to normal.'
                    , topic: 'endocrine'},
      {
                        id: 'en9',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are features of Diabetes Insipidus (DI)? (Select all that apply)',
                        options: ['Polyuria (excessive urination)', 'Polydipsia (excessive thirst)', 'Dehydration', 'Hyponatraemia'],
                        correct: [0, 1, 2],
                        explanation: 'DI = NOT ENOUGH ADH or kidneys don\'t respond → cannot concentrate urine → polyuria + polydipsia + dehydration + HYPERNATRAEMIA (concentrated blood). Treatment = desmopressin (synthetic ADH) + strict fluid balance monitoring. Hyponatraemia occurs in SIADH, not DI.'
                    , topic: 'endocrine'},
      {
                        id: 'en10',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the main feature and management of SIADH (Syndrome of Inappropriate ADH)?',
                        options: ['Dehydration; give fluids', 'Water retention causing hyponatraemia; fluid restrict', 'Hyperglycaemia; give insulin', 'Hyperkalaemia; give calcium gluconate'],
                        correct: 1,
                        explanation: 'SIADH = TOO MUCH ADH → kidneys retain TOO MUCH water → dilutional HYPONATRAEMIA → headache, confusion, seizures. Management = FLUID RESTRICTION + monitor sodium closely. Opposite of DI.'
                    , topic: 'endocrine'},
      {
                        id: 'en11',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the role of the RAAS (Renin-Angiotensin-Aldosterone System)?',
                        options: ['Lowers blood pressure', 'Increases blood pressure by retaining sodium and water', 'Controls blood glucose', 'Regulates calcium levels'],
                        correct: 1,
                        explanation: 'RAAS activates when BP or sodium is LOW: Kidneys release renin → Angiotensin II → Adrenal cortex releases ALDOSTERONE → Kidneys retain Na⁺ and water (raises BP/volume) + excrete K⁺. Critical for fluid balance and BP control.'
                    , topic: 'endocrine'},
      {
                        id: 'en12',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the function of ANP (Atrial Natriuretic Peptide) and BNP (B-type Natriuretic Peptide)?',
                        options: ['Retain sodium and water', 'Volume "relief valve" - increase sodium and water excretion', 'Raise blood glucose', 'Lower calcium levels'],
                        correct: 1,
                        explanation: 'ANP/BNP are released when heart is STRETCHED by high volume/pressure. They act as a "relief valve" → INCREASE Na⁺ and water excretion (opposite of RAAS/aldosterone). BNP is used clinically as a marker for heart failure.'
                    , topic: 'endocrine'},
      {
                        id: 'en13',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What does the HPT axis stand for and control?',
                        options: ['Heart-Pancreas-Thyroid; glucose control', 'Hypothalamus-Pituitary-Thyroid; metabolism and growth', 'Hypothalamus-Parathyroid-Thymus; immunity', 'Hepatic-Pituitary-Thyroid; digestion'],
                        correct: 1,
                        explanation: 'HPT axis = Hypothalamus (releases TRH) → Pituitary (releases TSH) → Thyroid (releases T3/T4). T3/T4 control metabolism, growth, brain development. Negative feedback: ↑T3/T4 → ↓TSH/TRH.'
                    , topic: 'endocrine'},
      {
                        id: 'en14',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Congenital hypothyroidism must be treated early to prevent neurological developmental delay.',
                        correct: true,
                        explanation: 'TRUE. Congenital hypothyroidism is screened via newborn heel prick test. Early treatment with levothyroxine (lifelong) is CRITICAL to prevent irreversible brain damage and developmental delay. Thyroid hormones are essential for brain development.'
                    , topic: 'endocrine'},
      {
                        id: 'en15',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are symptoms of HYPOthyroidism? (Select all that apply)',
                        options: ['Fatigue', 'Cold intolerance', 'Weight gain', 'Tachycardia'],
                        correct: [0, 1, 2],
                        explanation: 'Hypothyroidism (LOW T3/T4) symptoms: fatigue, cold intolerance, weight gain, constipation, slow growth (children), bradycardia (slow heart rate). Tachycardia occurs in HYPERthyroidism. Treatment = levothyroxine replacement.'
                    , topic: 'endocrine'},
      {
                        id: 'en16',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are features of HYPERthyroidism (Graves\' disease)? (Select all that apply)',
                        options: ['Tachycardia', 'Heat intolerance', 'Weight loss', 'Thyroid storm is a medical emergency'],
                        correct: [0, 1, 2, 3],
                        explanation: 'Hyperthyroidism (HIGH T3/T4, often Graves\' disease) symptoms: tachycardia, heat intolerance, weight loss despite eating, tremor, anxiety, goitre. THYROID STORM = life-threatening emergency (extreme hyperthyroidism, hyperpyrexia, confusion, arrhythmias) requiring urgent treatment.'
                    , topic: 'endocrine'},
      {
                        id: 'en17',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the main function of parathyroid hormone (PTH)?',
                        options: ['Lower blood calcium', 'Raise blood calcium via bone resorption and kidney reabsorption', 'Control metabolism', 'Regulate potassium'],
                        correct: 1,
                        explanation: 'PTH RAISES blood Ca²⁺ via 3 mechanisms: (1) Bone resorption (releases Ca²⁺ from bones), (2) Kidney reabsorption of Ca²⁺, (3) Activates vitamin D (increases gut Ca²⁺ absorption). Opposite of calcitonin which lowers Ca²⁺.'
                    , topic: 'endocrine'},
      {
                        id: 'en18',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are symptoms of LOW calcium (hypocalcaemia)? (Select all that apply)',
                        options: ['Tingling/paraesthesia', 'Tetany (muscle spasms)', 'Seizures', 'Bone pain'],
                        correct: [0, 1, 2],
                        explanation: 'HYPOcalcaemia causes neuromuscular irritability: tingling/numbness (perioral, fingers), tetany (muscle cramps/spasms - Trousseau\'s/Chvostek\'s signs), seizures, prolonged QT interval. URGENT treatment = IV calcium gluconate + airway safety. Bone pain is a feature of HYPERcalcaemia.'
                    , topic: 'endocrine'},
      {
                        id: 'en19',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'What does the adrenal CORTEX produce? (Select all that apply)',
                        options: ['Aldosterone (salt balance)', 'Cortisol (stress/glucose/BP)', 'Adrenaline (fight/flight)', 'Androgens (sex hormones)'],
                        correct: [0, 1, 3],
                        explanation: 'Adrenal CORTEX (outer layer) produces: Aldosterone (mineralocorticoid - Na⁺/K⁺ balance), Cortisol (glucocorticoid - stress, glucose, BP, anti-inflammatory), Androgens (sex hormones). Adrenal MEDULLA (inner) produces adrenaline/noradrenaline (fast fight/flight response).'
                    , topic: 'endocrine'},
      {
                        id: 'en20',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are features of adrenal crisis (Addisonian crisis)? (Select all that apply)',
                        options: ['Vomiting and dehydration', 'Hypotension/shock', 'Hypoglycaemia', 'Hyponatraemia and hyperkalaemia'],
                        correct: [0, 1, 2, 3],
                        explanation: 'ADRENAL CRISIS (CAH/Addison\'s disease) is LIFE-THREATENING: vomiting, severe dehydration, hypotension/shock, hypoglycaemia (no cortisol), hyponatraemia (low Na⁺), hyperkalaemia (high K⁺). EMERGENCY treatment = IV hydrocortisone STAT + IV fluids + monitor glucose/electrolytes.'
                    , topic: 'endocrine'},
      {
                        id: 'en21',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Children on long-term steroids should NEVER stop them abruptly and need stress-dose increases during illness or surgery.',
                        correct: true,
                        explanation: 'TRUE. SICK-DAY RULES are critical: Never stop steroids abruptly (risk adrenal crisis - suppressed natural production). During illness/surgery/stress, INCREASE steroid dose (stress-dosing) as the body needs more cortisol. Teach families emergency protocols and medical alert bracelets.'
                    , topic: 'endocrine'},
      {
                        id: 'en22',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the role of insulin produced by pancreatic β (beta) cells?',
                        options: ['Raises blood glucose', 'Lowers blood glucose by promoting uptake and storage', 'Has no effect on glucose', 'Only works in the liver'],
                        correct: 1,
                        explanation: 'Insulin (from β-cells) LOWERS blood glucose by: (1) Promoting glucose uptake into cells, (2) Promoting glycogen storage in liver/muscle, (3) Inhibiting glucose production. Glucagon (from α-cells) does the OPPOSITE - raises glucose by promoting hepatic glucose release.'
                    , topic: 'endocrine'},
      {
                        id: 'en23',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Children have smaller glycogen stores than adults, making them more prone to hypoglycaemia.',
                        correct: true,
                        explanation: 'TRUE. Children have SMALLER glycogen reserves in liver/muscle → hypoglycaemia develops FASTER during fasting, illness, or increased metabolic demand. This is why regular feeding and early intervention during illness are critical in paediatrics.'
                    , topic: 'endocrine'},
      {
                        id: 'en24',
                        type: 'multiselect',
                        difficulty: 'easy',
                        question: 'Which are classic presenting features of Type 1 Diabetes Mellitus (T1DM)? (Select all that apply)',
                        options: ['Polyuria (excessive urination)', 'Polydipsia (excessive thirst)', 'Weight loss', 'Hypertension'],
                        correct: [0, 1, 2],
                        explanation: 'T1DM classic triad: Polyuria (glucose in urine pulls water out), Polydipsia (thirst from dehydration), Weight loss (body breaks down fat/protein for energy as glucose cannot enter cells). Also: fatigue, blurred vision, recurrent infections. Hypertension is not a feature.'
                    , topic: 'endocrine'},
      {
                        id: 'en25',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are features of Diabetic Ketoacidosis (DKA)? (Select all that apply)',
                        options: ['Kussmaul breathing (deep, rapid)', 'Dehydration', 'Abdominal pain', 'Drowsiness/reduced consciousness'],
                        correct: [0, 1, 2, 3],
                        explanation: 'DKA = medical emergency. Features: Kussmaul breathing (deep/rapid - blowing off CO₂), dehydration (osmotic diuresis), abdominal pain (often mimics appendicitis), vomiting, drowsiness/confusion, ketotic breath (pear drops smell), acidosis. URGENT treatment = IV fluids + insulin infusion + K⁺ monitoring (risk hypokalaemia).'
                    , topic: 'endocrine'},
      {
                        id: 'en26',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the mechanism of action difference between peptide hormones (e.g., insulin, ADH) and steroid hormones (e.g., cortisol, aldosterone)?',
                        options: ['No difference in action', 'Peptides use cell-surface receptors (rapid); steroids use intracellular receptors (slower, longer-lasting)', 'Steroids are faster than peptides', 'Peptides always last longer'],
                        correct: 1,
                        explanation: 'PEPTIDE hormones (insulin, ADH, GH) bind to CELL-SURFACE receptors → rapid signalling (seconds to minutes). STEROID hormones (cortisol, aldosterone, oestrogen) are lipid-soluble → cross membrane → bind INTRACELLULAR receptors → alter gene transcription → slower onset but LONGER-lasting effects (hours to days).'
                    , topic: 'endocrine'},
      {
                        id: 'en27',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which hormones follow circadian (daily) rhythms? (Select all that apply)',
                        options: ['Cortisol (peaks in morning)', 'Growth hormone (pulses during deep sleep)', 'Melatonin (released at night)', 'Insulin'],
                        correct: [0, 1, 2],
                        explanation: 'Many hormones follow circadian rhythms: Cortisol peaks in MORNING (helps us wake), Growth hormone pulses during DEEP SLEEP (why sleep is critical for growth), Melatonin rises at NIGHT (regulates sleep-wake cycle). Insulin does not follow a strict circadian pattern - it responds to blood glucose levels.'
                    , topic: 'endocrine'},
      {
                        id: 'en28',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are core nursing priorities when caring for a child with endocrine dysfunction? (Select all that apply)',
                        options: ['Monitor growth trends (height velocity, weight)', 'Monitor vital signs and neurological status', 'Fluid balance and daily weights', 'Avoid all blood tests'],
                        correct: [0, 1, 2],
                        explanation: 'Nursing priorities: (1) Trend GROWTH (height velocity, weight centiles, Tanner staging for puberty), (2) Monitor VITALS + NEURO status (consciousness, seizures), (3) FLUID BALANCE (urine output target ≥1 mL/kg/hr; daily weights - 1 kg ≈ 1 L), (4) Monitor labs (Na⁺/K⁺/glucose/osmolality/ketones). Blood tests are essential, not avoided.'
                    , topic: 'endocrine'},
      {
                        id: 'en29',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which should be monitored in a child with diabetes during illness? (Select all that apply)',
                        options: ['Blood glucose', 'Ketones', 'Sodium and potassium', 'Osmolality'],
                        correct: [0, 1, 2, 3],
                        explanation: 'During illness (sick-day rules for diabetes), monitor: Blood GLUCOSE frequently (illness raises glucose), KETONES (risk DKA), Na⁺/K⁺ (electrolyte imbalances), osmolality (dehydration assessment). NEVER stop insulin during illness - often need MORE. Encourage fluids, monitor for DKA signs.'
                    , topic: 'endocrine'},
      {
                        id: 'en30',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'What should nurses teach families about endocrine medication management? (Select all that apply)',
                        options: ['Medication timing and adherence (thyroxine, steroids, insulin, DDAVP)', 'Emergency plans and medical alert bracelets', 'Sick-day rules for steroids and diabetes', 'Medications can be stopped when child feels better'],
                        correct: [0, 1, 2],
                        explanation: 'Family education is critical: (1) Teach medication TIMING (e.g., thyroxine on empty stomach, insulin with meals, DDAVP timing) + ADHERENCE, (2) EMERGENCY plans (adrenal crisis, DKA, severe hypo) + medical alert bracelets/IDs for school, (3) SICK-DAY rules (never stop steroids/insulin; adjust doses). NEVER stop medications when feeling better - lifelong management required.'
                    , topic: 'endocrine'},
      {
                        id: 'sk1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'How much thinner is neonatal skin compared to adult skin?',
                        options: ['5-10%', '10-15%', '20-30%', '40-50%'],
                        correct: 2,
                        explanation: 'Neonatal skin is approximately 20-30% thinner than adult skin, making it more permeable and less resistant to friction, irritants, and microbes.'
                    , topic: 'skin'},
      {
                        id: 'sk2',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which factors make infant skin more vulnerable than adult skin? (Select all that apply)',
                        options: ['Immature barrier function', 'Higher permeability', 'Reduced friction tolerance', 'Thicker epidermis'],
                        correct: [0, 1, 2],
                        explanation: 'Infant skin has immature barrier function, increased permeability, and reduced friction tolerance. The epidermis is actually THINNER, not thicker, which contributes to vulnerability.'
                    , topic: 'skin'},
      {
                        id: 'sk3',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'The statement "children aren\'t little adults" applies to skin physiology and care.',
                        correct: true,
                        explanation: 'TRUE. Paediatric skin has immature defence systems including barrier function, glands, circulation, and temperature regulation. Newborns react strongly to clothing, cleansers, and temperature changes, requiring paediatric-specific skincare routines.'
                    , topic: 'skin'},
      {
                        id: 'sk4',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What are the four layers of skin structure from superficial to deep?',
                        options: ['Dermis → Epidermis → Basement membrane → Subcutaneous fat', 'Epidermis → Dermis → Basement membrane → Subcutaneous fat', 'Epidermis → Basement membrane → Dermis → Subcutaneous fat', 'Stratum corneum → Epidermis → Dermis → Subcutaneous fat'],
                        correct: 2,
                        explanation: 'The four skin layers are: Epidermis (barrier), Basement membrane zone (anchoring junction), Dermis (strength/support), and Subcutaneous fat (padding/insulation). The stratum corneum is part of the epidermis, not a separate layer.'
                    , topic: 'skin'},
      {
                        id: 'sk5',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are functions of the epidermis? (Select all that apply)',
                        options: ['Retains moisture', 'Blocks UV radiation', 'Prevents microbial entry', 'Produces blood cells'],
                        correct: [0, 1, 2],
                        explanation: 'The epidermis is avascular and forms the protective barrier: retains moisture, reduces water loss, and blocks UV, microbes, and allergens. The stratum corneum is the main "brick wall" barrier. Blood cell production occurs in bone marrow, not skin.'
                    , topic: 'skin'},
      {
                        id: 'sk6',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which factors can weaken the skin barrier in children? (Select all that apply)',
                        options: ['Overwashing', 'Harsh wipes', 'Irritant products', 'Daily bathing with plain water'],
                        correct: [0, 1, 2],
                        explanation: 'Age, medication, illness, injury, and lifestyle all weaken barriers. In children, minor insults like overwashing, harsh wipes, and irritant products cause BIGGER effects due to skin immaturity. Daily bathing with plain water and gentle drying is generally acceptable.'
                    , topic: 'skin'},
      {
                        id: 'sk7',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Term newborns have a fully mature stratum corneum at birth with adult-level barrier function.',
                        correct: false,
                        explanation: 'FALSE. While term neonates have a PRESENT stratum corneum and keratin-based baseline protection, functional maturity continues AFTER birth. The barrier is present but not fully mature.'
                    , topic: 'skin'},
      {
                        id: 'sk8',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'How does the infant skin microbiome change in the first 6 months?',
                        options: ['Remains stable from birth', 'Gradually decreases in diversity', 'Changes rapidly with hundreds of bacterial species colonizing', 'Is identical to adult microbiome'],
                        correct: 2,
                        explanation: 'Infant skin hosts hundreds of bacterial species and the microbiome changes RAPIDLY in the first 6 months. Disruption is linked with eczema/atopic dermatitis. Avoid overuse of stripping cleansers/antibacterial products unless clinically indicated.'
                    , topic: 'skin'},
      {
                        id: 'sk9',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the pH of newborn skin at birth, and what does it become over the first few weeks?',
                        options: ['pH 5.0 at birth → 7.0 later', 'pH 7.0 at birth → 5.0 later', 'pH 6.3-7.5 at birth → 5.0-5.5 later', 'pH 4.0 at birth → 6.0 later'],
                        correct: 2,
                        explanation: 'At birth, skin pH is 6.3-7.5 (alkaline from amniotic fluid). Over weeks it falls to 5.0-5.5, forming the acid mantle, which helps inhibit microbes and supports healthy skin development. Use mild, pH-friendly cleansers to support this process.'
                    , topic: 'skin'},
      {
                        id: 'sk10',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the progression of irritant diaper dermatitis (nappy rash)?',
                        options: ['Papules → redness → pustules → breakdown', 'Redness → papules → pustules → swelling/breakdown', 'Breakdown → pustules → papules → redness', 'Pustules → redness → swelling'],
                        correct: 1,
                        explanation: 'Progression: redness → papules → pustules → swelling/breakdown. Key nursing message: EARLY INTERVENTION + barrier protection + moisture control prevents progression to severe stages.'
                    , topic: 'skin'},
      {
                        id: 'sk11',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'How does infant epidermal turnover rate compare to adults?',
                        options: ['Infant ~28 days vs Adult ~14 days', 'Infant ~14 days vs Adult ~28 days', 'Same rate (~21 days)', 'Infant ~7 days vs Adult ~14 days'],
                        correct: 1,
                        explanation: 'Infant epidermis renews in approximately 14 days vs adult 28 days. This means FASTER HEALING but also HIGHER sensitivity and reactivity to irritants and allergens.'
                    , topic: 'skin'},
      {
                        id: 'sk12',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Transepidermal water loss (TEWL) is 2-3 times higher in newborns compared to adults.',
                        correct: true,
                        explanation: 'TRUE. Newborn TEWL is 2-3× HIGHER than adults, leading to increased water loss AND higher absorption of topical products. Nursing care priorities: moisturize regularly, avoid strong active ingredients, and monitor hydration status if extensive skin damage is present.'
                    , topic: 'skin'},
      {
                        id: 'sk13',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What happens to sebum production in the first few months of life?',
                        options: ['Remains constant', 'Gradually increases', 'High initially due to maternal hormones, then drops', 'Always low from birth'],
                        correct: 2,
                        explanation: 'Sebum is HIGH initially due to maternal hormones, then DROPS after the first few months. This means infant skin becomes DRIER and needs external emollient support to maintain barrier function.'
                    , topic: 'skin'},
      {
                        id: 'sk14',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Why is baby skin more susceptible to UV damage? (Select all that apply)',
                        options: ['Lower pigmentation', 'Less active melanocytes', 'UV damage is cumulative', 'Thicker stratum corneum'],
                        correct: [0, 1, 2],
                        explanation: 'Lower pigmentation and less active melanocytes make baby skin more UV-sensitive. UV damage is CUMULATIVE over a lifetime, so sun protection habits are essential from EARLY CHILDHOOD. Baby skin has THINNER, not thicker, stratum corneum.'
                    , topic: 'skin'},
      {
                        id: 'sk15',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which factors contribute to poor temperature regulation in infants? (Select all that apply)',
                        options: ['Large surface area to volume ratio', 'Immature circulation', 'Slower vasoconstriction/dilation', 'Excessive subcutaneous fat'],
                        correct: [0, 1, 2],
                        explanation: 'Large surface area:volume ratio + immature circulation → rapid heat LOSS and slower vasoconstriction/dilation responses. Vascular regulation becomes more organized around 4 months. Infants have LESS subcutaneous fat, not excessive, which worsens heat loss.'
                    , topic: 'skin'},
      {
                        id: 'sk16',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'At approximately what age does skin structure and function begin to resemble adult characteristics?',
                        options: ['6 months', '1 year', '3 years', '6 years'],
                        correct: 3,
                        explanation: 'Skin stays thinner and less pigmented for years; sweat/sebaceous glands are less active; acid mantle and hydrolipid film remain weaker. By approximately 6 YEARS, skin resembles adult structure and function more closely.'
                    , topic: 'skin'},
      {
                        id: 'sk17',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What skin changes occur during puberty?',
                        options: ['Decreased sebum production', 'Increased sebum → bacterial colonization → inflammation → acne', 'Skin becomes thinner', 'pH becomes more alkaline'],
                        correct: 1,
                        explanation: 'Hormonal changes during puberty INCREASE sebum production → bacterial colonization + inflammation → ACNE. Sex differences in skin characteristics also become more apparent during puberty.'
                    , topic: 'skin'},
      {
                        id: 'sk18',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'How do pressure injuries present differently in neonates compared to adults?',
                        options: ['Neonates only get Stage 4 ulcers', 'Neonates may show bruising/tearing rather than classic ulcers', 'Neonates cannot develop pressure injuries', 'Presentation is identical'],
                        correct: 1,
                        explanation: 'Pressure injuries are LESS COMMON in children than adults but still a risk. Neonates may show BRUISING or TEARING rather than classic staged ulcers. Prevention priorities: repositioning, padding bony prominences, and checking medical devices for pressure points.'
                    , topic: 'skin'},
      {
                        id: 'sk19',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are best practices for paediatric wound care procedures? (Select all that apply)',
                        options: ['Plan ahead', 'Offer choices and control where possible', 'Use distraction techniques', 'Rush through to minimize time'],
                        correct: [0, 1, 2],
                        explanation: 'Procedures cause fear and distress in children. Best practice: plan ahead, protect routine, offer choices/control (e.g., "Which dressing colour?"), and pause for reassurance. Play specialists and distraction (bubbles, tablets, music) improve coping. NEVER rush - this increases anxiety and makes future procedures harder.'
                    , topic: 'skin'},
      {
                        id: 'sk20',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is often the most painful/distressing part of wound care for children?',
                        options: ['Initial wound assessment', 'Cleaning the wound', 'Dressing removal', 'Applying new dressing'],
                        correct: 2,
                        explanation: 'Dressing REMOVAL is often the worst step for children - it can be more distressing than the wound itself. Best practice: use adhesive remover, go SLOW, involve the child if appropriate (let them remove part themselves), and use distraction throughout.'
                    , topic: 'skin'},
      {
                        id: 'sk21',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are challenges specific to paediatric wound dressings? (Select all that apply)',
                        options: ['Adapting adult-sized dressings safely', 'Size and shape variations', 'Considering colour and exudate visibility', 'Children never need dressings'],
                        correct: [0, 1, 2],
                        explanation: 'Paediatric dressing challenges include: adapting size/shape for small body parts, cutting adult dressings safely without compromising function, and considering aesthetics (bright colours can be engaging but may hide exudate - clinical judgment needed). Children absolutely DO need dressings when indicated.'
                    , topic: 'skin'},
      {
                        id: 'sk22',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the most common chronic skin condition in childhood?',
                        options: ['Psoriasis', 'Eczema (atopic dermatitis)', 'Acne', 'Impetigo'],
                        correct: 1,
                        explanation: 'Eczema (atopic dermatitis) is the most common chronic skin condition in children. It is linked to skin barrier dysfunction and often occurs alongside other atopic conditions (asthma, allergic rhinitis, food allergies).'
                    , topic: 'skin'},
      {
                        id: 'sk23',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the foundation of eczema management in children?',
                        options: ['Topical steroids', 'Emollients', 'Oral antihistamines', 'Antibiotics'],
                        correct: 1,
                        explanation: 'EMOLLIENTS are the foundation of eczema management. They should be applied liberally and frequently (3-4 times daily) to maintain skin barrier function, reduce water loss, and prevent flare-ups. Topical steroids are added during acute flares.'
                    , topic: 'skin'},
      {
                        id: 'sk24',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'A non-blanching rash (does not fade when pressed with a glass) requires urgent medical assessment.',
                        correct: true,
                        explanation: 'TRUE. Non-blanching rash (purpura/petechiae) does NOT fade when pressed with a glass tumbler. This could indicate meningococcal septicaemia or other serious conditions requiring URGENT assessment. Blanching rashes are less concerning.'
                    , topic: 'skin'},
      {
                        id: 'sk25',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which bacterial infection causes honey-colored crusted lesions?',
                        options: ['Cellulitis', 'Impetigo', 'Folliculitis', 'Erysipelas'],
                        correct: 1,
                        explanation: 'IMPETIGO characteristically causes honey-colored (golden) crusted lesions, usually caused by Staphylococcus aureus or Streptococcus pyogenes. It is highly contagious. Treatment: topical fusidic acid or oral antibiotics if widespread.'
                    , topic: 'skin'},
      {
                        id: 'sk26',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which features of a birthmark are concerning and require referral? (Select all that apply)',
                        options: ['Rapid growth', 'Bleeding or ulceration', 'Irregular borders', 'Present at birth'],
                        correct: [0, 1, 2],
                        explanation: 'Concerning birthmark features: rapid GROWTH, BLEEDING or ulceration, IRREGULAR borders, change in colour or texture, or location that may affect function (e.g., near eye). Being present at birth ALONE is not concerning - most birthmarks are benign. Haemangiomas near airways, eyes, or that are very large may need treatment.'
                    , topic: 'skin'},
      {
                        id: 'sk27',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the typical presentation of molluscum contagiosum?',
                        options: ['Honey-colored crusted lesions', 'Small pearly papules with central dimple (umbilication)', 'Erythematous scaly patches', 'Vesicular rash'],
                        correct: 1,
                        explanation: 'Molluscum contagiosum presents as small (2-5mm) PEARLY or flesh-colored PAPULES with CENTRAL UMBILICATION (dimple). It is a viral infection, self-limiting (usually resolves in 6-18 months), and generally requires NO treatment unless causing distress or secondary infection.'
                    , topic: 'skin'},
      {
                        id: 'sk28',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are appropriate nursing interventions for nappy rash prevention? (Select all that apply)',
                        options: ['Frequent nappy changes', 'Barrier cream application', 'Allow nappy-free time', 'Use baby wipes with alcohol'],
                        correct: [0, 1, 2],
                        explanation: 'Nappy rash prevention: FREQUENT nappy changes (limit urine/faeces contact time), BARRIER CREAM (zinc oxide or petroleum-based), and NAPPY-FREE TIME (allows skin to dry and breathe). AVOID baby wipes with alcohol, fragrance, or harsh chemicals - use water and soft cloth or fragrance-free wipes. If rash persists, consider Candida (satellite lesions, beefy red) needing antifungal.'
                    , topic: 'skin'},
      {
                        id: 'sk29',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Why must nurses monitor hydration closely in infants with extensive skin damage or burns?',
                        options: ['Increased calorie needs', 'Massively increased TEWL and risk of dehydration', 'Risk of infection only', 'Cosmetic concerns'],
                        correct: 1,
                        explanation: 'Extensive skin damage or burns in infants cause MASSIVELY INCREASED transepidermal water loss (TEWL). Remember: infant TEWL is already 2-3× higher than adults. With barrier breakdown, fluid losses can be life-threatening. Close monitoring of fluid balance, urine output, weight, and hydration status is CRITICAL.'
                    , topic: 'skin'},
      {
                        id: 'sk30',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which are key principles of paediatric skincare to preserve barrier function? (Select all that apply)',
                        options: ['Use mild, pH-balanced cleansers', 'Minimize overwashing and harsh products', 'Apply emollients regularly', 'Use antibacterial soap daily'],
                        correct: [0, 1, 2],
                        explanation: 'Paediatric skincare principles: (1) Use MILD, pH-BALANCED (pH 5-5.5) cleansers that support the acid mantle, (2) MINIMIZE overwashing and avoid harsh wipes/products that strip barrier, (3) Apply EMOLLIENTS regularly to lock in moisture and support barrier. AVOID routine antibacterial soaps - they disrupt microbiome unless clinically indicated (e.g., recurrent infections, pre-surgery).'
                    , topic: 'skin'},
      {
                        id: 'ms1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is developmental dysplasia of the hip (DDH)?',
                        options: ['Hip infection', 'Hip fracture', 'Abnormal hip joint development', 'Hip arthritis'],
                        correct: 2,
                        explanation: 'DDH is a condition where the hip joint doesn\'t develop properly, ranging from mild instability to complete dislocation.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms2',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which clinical test is used to screen for DDH in newborns?',
                        options: ['Romberg test', 'Barlow and Ortolani tests', 'Trendelenburg test', 'Thomas test'],
                        correct: 1,
                        explanation: 'Barlow and Ortolani tests are used in newborn hip screening to detect DDH.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms3',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Growing pains typically occur during the day.',
                        correct: false,
                        explanation: 'Growing pains typically occur in the evening or at night, often waking children from sleep.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms4',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the typical age range for slipped upper femoral epiphysis (SUFE)?',
                        options: ['2-5 years', '5-8 years', '10-16 years', '18-25 years'],
                        correct: 2,
                        explanation: 'SUFE typically occurs in adolescents aged 10-16, especially during growth spurts.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms5',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are features of juvenile idiopathic arthritis? (Select all that apply)',
                        options: ['Joint swelling', 'Morning stiffness', 'Pain with activity', 'High fever always'],
                        correct: [0, 1, 2],
                        explanation: 'JIA features joint swelling, morning stiffness, and pain. Systemic JIA can have fever but not all types.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms6',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the Ortolani test used to detect?',
                        options: ['Scoliosis', 'Developmental dysplasia of the hip (DDH)', 'Club foot', 'Osgood-Schlatter disease'],
                        correct: 1,
                        explanation: 'The Ortolani test is used to detect DDH by attempting to relocate a dislocated hip - a positive "clunk" indicates DDH.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms7',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which risk factor is MOST associated with developmental dysplasia of the hip?',
                        options: ['Male gender', 'Second-born child', 'Breech presentation', 'Premature birth'],
                        correct: 2,
                        explanation: 'Breech presentation is the strongest risk factor for DDH. Other risks include female gender, first-born, and family history.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms8',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Growing pains typically affect both legs and occur in muscles rather than joints.',
                        correct: true,
                        explanation: 'Growing pains are bilateral, affect muscles (not joints), occur at night, and have no swelling, redness or limping.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms9',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'A child presents with hip pain, limp, and an externally rotated leg. What is the most likely diagnosis?',
                        options: ['Transient synovitis', 'Septic arthritis', 'SUFE', 'Perthes disease'],
                        correct: 2,
                        explanation: 'SUFE (Slipped Upper Femoral Epiphysis) classically presents with hip/knee pain, limp, and externally rotated leg in adolescents.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms10',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are RED FLAG symptoms requiring urgent investigation in a child with limb pain? (Select all that apply)',
                        options: ['Night pain', 'Weight loss', 'Pain improving with activity', 'Fever with limp'],
                        correct: [0, 1, 3],
                        explanation: 'Night pain, weight loss, and fever with limp are red flags suggesting possible malignancy or septic arthritis. Pain improving with activity suggests inflammatory causes like JIA.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms11',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the Barlow test used for?',
                        options: ['Detecting scoliosis', 'Dislocating a hip to test for instability', 'Assessing knee stability', 'Testing ankle reflexes'],
                        correct: 1,
                        explanation: 'The Barlow test attempts to dislocate an unstable hip posteriorly - it complements the Ortolani test in DDH screening.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms12',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'At what age should all newborns be screened for DDH?',
                        options: ['At birth only', 'At birth and 6-8 weeks', '6 months', '1 year'],
                        correct: 1,
                        explanation: 'All newborns should be screened for DDH at birth and again at 6-8 weeks as part of routine checks.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms13',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Septic arthritis is a medical emergency requiring urgent treatment.',
                        correct: true,
                        explanation: 'Septic arthritis can destroy joint cartilage within hours. A child with fever, inability to weight-bear, and joint swelling needs urgent assessment.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms14',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Perthes disease typically affects which age group?',
                        options: ['Newborns', '4-10 years', '12-16 years', 'Adults only'],
                        correct: 1,
                        explanation: 'Perthes disease (avascular necrosis of the femoral head) typically affects children aged 4-10, more common in boys.'
                    , topic: 'musculoskeletal'},
      {
                        id: 'ms15',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What imaging is first-line for suspected DDH in infants under 4.5 months?',
                        options: ['X-ray', 'Ultrasound', 'MRI', 'CT scan'],
                        correct: 1,
                        explanation: 'Ultrasound is first-line for DDH screening in infants under 4.5 months as the femoral head is not yet ossified.'
                    , topic: 'musculoskeletal'},
      {
                        id: 're6',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'Which age group has the highest incidence of UTI in males?',
                        options: ['Newborns/infants under 3 months', '1-5 years', '5-10 years', 'Adolescents'],
                        correct: 0,
                        explanation: 'UTIs are more common in males during the first 3 months of life, after which females have higher rates.'
                    , topic: 'renal'},
      {
                        id: 're7',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'A clean catch urine sample is the preferred method for diagnosing UTI in toilet-trained children.',
                        correct: true,
                        explanation: 'Clean catch midstream urine is preferred for toilet-trained children. For infants, catheter or suprapubic aspiration may be needed.'
                    , topic: 'renal'},
      {
                        id: 're8',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the classic triad of nephrotic syndrome?',
                        options: ['Haematuria, hypertension, oedema', 'Proteinuria, hypoalbuminaemia, oedema', 'Fever, flank pain, dysuria', 'Oliguria, hypertension, haematuria'],
                        correct: 1,
                        explanation: 'Nephrotic syndrome triad: heavy proteinuria (>3g/24hr), hypoalbuminaemia (<25g/L), and oedema.'
                    , topic: 'renal'},
      {
                        id: 're9',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What defines oliguria in children?',
                        options: ['<2 ml/kg/hr', '<1 ml/kg/hr', '<0.5 ml/kg/hr', '<0.3 ml/kg/hr'],
                        correct: 2,
                        explanation: 'Oliguria is defined as urine output <0.5 ml/kg/hr in children. Normal is approximately 1 ml/kg/hr.'
                    , topic: 'renal'},
      {
                        id: 're10',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which symptoms suggest UTI in an infant? (Select all that apply)',
                        options: ['Fever without obvious source', 'Poor feeding', 'Irritability', 'Dysuria reported by infant'],
                        correct: [0, 1, 2],
                        explanation: 'Infants with UTI often present with non-specific symptoms: fever, poor feeding, irritability, vomiting. Infants cannot report dysuria.'
                    , topic: 'renal'},
      {
                        id: 're11',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is vesicoureteral reflux (VUR)?',
                        options: ['Blockage of the ureter', 'Backflow of urine from bladder to kidneys', 'Kidney stones', 'Bladder infection'],
                        correct: 1,
                        explanation: 'VUR is the abnormal backflow of urine from the bladder up into the ureters and potentially the kidneys, increasing UTI risk.'
                    , topic: 'renal'},
      {
                        id: 're12',
                        type: 'tf',
                        difficulty: 'hard',
                        question: 'All children under 6 months with their first UTI should have imaging investigations.',
                        correct: true,
                        explanation: 'NICE guidelines recommend ultrasound within 6 weeks for all children <6 months with first UTI, to identify structural abnormalities.'
                    , topic: 'renal'},
      {
                        id: 're13',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'Which is a common complication of untreated recurrent UTIs in children?',
                        options: ['Obesity', 'Renal scarring', 'Diabetes', 'Heart disease'],
                        correct: 1,
                        explanation: 'Recurrent UTIs, especially with VUR, can lead to renal scarring, which may cause hypertension and chronic kidney disease.'
                    , topic: 'renal'},
      {
                        id: 're14',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the significance of a positive nitrite on urine dipstick?',
                        options: ['Indicates dehydration', 'Suggests bacterial infection', 'Shows kidney damage', 'Indicates diabetes'],
                        correct: 1,
                        explanation: 'Nitrites are produced when bacteria convert nitrates - a positive nitrite strongly suggests bacterial UTI.'
                    , topic: 'renal'},
      {
                        id: 're15',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What characterizes acute glomerulonephritis?',
                        options: ['Heavy proteinuria, normal BP', 'Haematuria, hypertension, oedema', 'Polyuria, polydipsia', 'Sterile pyuria'],
                        correct: 1,
                        explanation: 'Acute glomerulonephritis presents with haematuria (often "cola-colored" urine), hypertension, oedema, and reduced urine output.'
                    , topic: 'renal'},
      {
                        id: 'bf6',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What does the acronym "CHIN" help assess in breastfeeding?',
                        options: ['Baby weight gain', 'Correct positioning', 'Milk supply', 'Feeding duration'],
                        correct: 1,
                        explanation: 'CHIN: Close, Head free, In line, Nose to nipple - helps assess correct positioning for breastfeeding.'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf7',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Breast milk supply works on a supply and demand basis - more feeding increases supply.',
                        correct: true,
                        explanation: 'Prolactin release is stimulated by suckling. More frequent feeding = more prolactin = more milk production.'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf8',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the recommended duration of exclusive breastfeeding according to WHO?',
                        options: ['3 months', '4 months', '6 months', '12 months'],
                        correct: 2,
                        explanation: 'WHO recommends exclusive breastfeeding for 6 months, with continued breastfeeding alongside complementary foods up to 2 years.'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf9',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are signs of good attachment at the breast? (Select all that apply)',
                        options: ['Mouth wide open', 'More areola visible above than below', 'Chin touching breast', 'Clicking sounds while feeding'],
                        correct: [0, 1, 2],
                        explanation: 'Good attachment: wide mouth, more areola visible above lip, chin touching breast, nose free. Clicking suggests poor attachment.'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf10',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is mastitis and how should breastfeeding continue?',
                        options: ['Breast infection - stop breastfeeding immediately', 'Breast inflammation - continue breastfeeding from affected breast', 'Blocked duct - feed only from unaffected breast', 'Engorgement - express and discard milk'],
                        correct: 1,
                        explanation: 'Mastitis is breast tissue inflammation/infection. Continue breastfeeding from both breasts - stopping can worsen it. May need antibiotics.'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf11',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'How many wet nappies should a well-fed newborn have by day 5?',
                        options: ['2-3', '4-5', '6 or more', '10 or more'],
                        correct: 2,
                        explanation: '6+ wet nappies per day by day 5 indicates adequate hydration and milk intake.'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf12',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Oxytocin is responsible for milk production.',
                        correct: false,
                        explanation: 'Prolactin is responsible for milk PRODUCTION. Oxytocin triggers the let-down REFLEX (milk ejection).'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf13',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is tongue-tie (ankyloglossia)?',
                        options: ['A speech disorder', 'A tight frenulum restricting tongue movement', 'An infection under the tongue', 'A swallowing disorder'],
                        correct: 1,
                        explanation: 'Tongue-tie is a tight lingual frenulum that restricts tongue movement, potentially affecting breastfeeding. May need division.'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf14',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'When does mature breast milk typically "come in"?',
                        options: ['Immediately at birth', 'Day 1-2', 'Day 3-5', 'Week 2'],
                        correct: 2,
                        explanation: 'Mature milk typically comes in around day 3-5. Before this, colostrum (rich in antibodies) is produced.'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf15',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are benefits of breastfeeding for the baby? (Select all that apply)',
                        options: ['Reduced infection risk', 'Lower obesity risk', 'Reduced SIDS risk', 'Guaranteed allergy prevention'],
                        correct: [0, 1, 2],
                        explanation: 'Breastfeeding reduces infections, obesity risk, and SIDS. It may reduce allergy risk but does not guarantee prevention.'
                    , topic: 'breastfeeding'},
      {
                        id: 'hp6',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'Why should you avoid saying "going to sleep" when explaining anaesthesia to children?',
                        options: ['It is too technical', 'Children may fear not waking up (like a pet that was "put to sleep")', 'It is medically inaccurate', 'Children do not understand sleep'],
                        correct: 1,
                        explanation: 'Children may associate "going to sleep" with death, especially if a pet was "put to sleep." Use age-appropriate explanations.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp7',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'Parents should be encouraged to stay with their child during procedures whenever possible.',
                        correct: true,
                        explanation: 'Parental presence usually reduces anxiety. However, parents should be prepared and supported - their anxiety transfers to the child.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp8',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is therapeutic play?',
                        options: ['Video games in hospital', 'Using play to help children understand and cope with medical experiences', 'Outdoor physical activity', 'Competitive sports therapy'],
                        correct: 1,
                        explanation: 'Therapeutic play uses play activities to help children express fears, understand procedures, and develop coping strategies.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp9',
                        type: 'multiselect',
                        difficulty: 'hard',
                        question: 'Which distraction techniques are effective during procedures? (Select all that apply)',
                        options: ['Bubbles', 'Deep breathing', 'Watching videos', 'Focusing on the needle'],
                        correct: [0, 1, 2],
                        explanation: 'Bubbles, breathing exercises, and videos are effective distractions. Focusing on the procedure increases anxiety.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp10',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'At what developmental stage can children typically understand simple explanations about procedures?',
                        options: ['Infant (0-1 year)', 'Toddler (1-3 years)', 'Preschool (3-5 years)', 'School age (6-12 years)'],
                        correct: 2,
                        explanation: 'Preschoolers can understand simple explanations. Use concrete terms, short sentences, and play to aid understanding.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp11',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'It is acceptable to promise a child that a procedure will not hurt.',
                        correct: false,
                        explanation: 'Never promise "no pain." This destroys trust. Instead say "you might feel a pinch/pressure" and validate their feelings.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp12',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the purpose of medical play with dolls before a procedure?',
                        options: ['To keep the child entertained', 'To allow rehearsal and expression of fears', 'To teach medical skills', 'To assess intelligence'],
                        correct: 1,
                        explanation: 'Medical play allows children to rehearse procedures, express fears, ask questions, and gain sense of control.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp13',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'How far in advance should a toddler (1-3 years) be prepared for planned hospitalisation?',
                        options: ['1-2 weeks before', '1 week before', '2-3 days before', 'The night before only'],
                        correct: 2,
                        explanation: 'Toddlers have limited concept of time - 2-3 days is appropriate. Too early causes prolonged anxiety; too late prevents processing.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp14',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which help reduce pre-operative anxiety in children? (Select all that apply)',
                        options: ['Pre-operative visit to the ward', 'Age-appropriate information books', 'Bringing a comfort object from home', 'Detailed surgical explanations'],
                        correct: [0, 1, 2],
                        explanation: 'Familiarity, books, and comfort objects help. Detailed surgical explanations are inappropriate and may increase anxiety.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp15',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What should you do if a child becomes very distressed during preparation?',
                        options: ['Continue regardless - they need the information', 'Stop, comfort, and try again later using different approach', 'Cancel the procedure', 'Sedate the child'],
                        correct: 1,
                        explanation: 'Stop and comfort first. Forcing information increases trauma. Try different approaches - some children respond better to play, others to books.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'num11',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'Convert 0.5 grams to milligrams.',
                        options: ['5 mg', '50 mg', '500 mg', '5000 mg'],
                        correct: 2,
                        explanation: '1 gram = 1000 mg. Therefore 0.5 g × 1000 = 500 mg.'
                    , topic: 'numeracy'},
      {
                        id: 'num12',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'A child needs ibuprofen 10 mg/kg. They weigh 18 kg. The suspension is 100 mg/5ml. What volume is needed?',
                        options: ['4.5 ml', '9 ml', '18 ml', '36 ml'],
                        correct: 1,
                        explanation: 'Dose = 18 kg × 10 mg/kg = 180 mg. Volume = (180 ÷ 100) × 5 = 9 ml.'
                    , topic: 'numeracy'},
      {
                        id: 'num13',
                        type: 'tf',
                        difficulty: 'easy',
                        question: '1 mg equals 1000 micrograms (mcg).',
                        correct: true,
                        explanation: 'Correct. The conversion hierarchy is: 1 g = 1000 mg = 1,000,000 mcg.'
                    , topic: 'numeracy'},
      {
                        id: 'num14',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'An infusion runs at 42 ml/hr. How long will a 500 ml bag last?',
                        options: ['About 8 hours', 'About 10 hours', 'About 12 hours', 'About 14 hours'],
                        correct: 2,
                        explanation: 'Time = Volume ÷ Rate = 500 ÷ 42 = 11.9 hours ≈ 12 hours.'
                    , topic: 'numeracy'},
      {
                        id: 'num15',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'A child weighing 22 kg needs maintenance fluids. Using Holliday-Segar, what is the 24-hour requirement?',
                        options: ['1440 ml', '1540 ml', '1640 ml', '1740 ml'],
                        correct: 1,
                        explanation: 'First 10 kg: 1000 ml. Next 10 kg: 500 ml. Last 2 kg: 40 ml (20 ml/kg). Total = 1000 + 500 + 40 = 1540 ml.'
                    , topic: 'numeracy'},
      {
                        id: 'num16',
                        type: 'multiselect',
                        difficulty: 'easy',
                        question: 'Which are correct unit conversions? (Select all that apply)',
                        options: ['1 L = 1000 ml', '1 kg = 1000 g', '1 mg = 100 mcg', '1 g = 1000 mg'],
                        correct: [0, 1, 3],
                        explanation: '1 L = 1000 ml, 1 kg = 1000 g, and 1 g = 1000 mg are correct. 1 mg = 1000 mcg (not 100).'
                    , topic: 'numeracy'},
      {
                        id: 'num17',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Dopamine infusion: 400 mg in 250 ml. Child weighs 10 kg and needs 5 mcg/kg/min. What rate in ml/hr?',
                        options: ['1.25 ml/hr', '1.5 ml/hr', '1.875 ml/hr', '2.5 ml/hr'],
                        correct: 2,
                        explanation: 'Dose = 10 × 5 = 50 mcg/min = 3000 mcg/hr = 3 mg/hr. Concentration = 400 mg/250 ml = 1.6 mg/ml. Rate = 3 ÷ 1.6 = 1.875 ml/hr.'
                    , topic: 'numeracy'},
      {
                        id: 'num18',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'A drug comes as 50 mg/2 ml. You need 35 mg. What volume do you draw up?',
                        options: ['1.2 ml', '1.4 ml', '1.6 ml', '1.8 ml'],
                        correct: 1,
                        explanation: 'Concentration = 50 mg/2 ml = 25 mg/ml. Volume = 35 ÷ 25 = 1.4 ml.'
                    , topic: 'numeracy'},
      {
                        id: 'num19',
                        type: 'tf',
                        difficulty: 'medium',
                        question: 'When calculating paediatric doses, you should always round UP to ensure adequate treatment.',
                        correct: false,
                        explanation: 'In paediatrics, always check maximum doses and generally round DOWN or to practical volumes to avoid overdose. When in doubt, check with pharmacist.'
                    , topic: 'numeracy'},
      {
                        id: 'num20',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'A prescription says "500 micrograms." How many milligrams is this?',
                        options: ['0.05 mg', '0.5 mg', '5 mg', '50 mg'],
                        correct: 1,
                        explanation: '1000 mcg = 1 mg. Therefore 500 mcg = 0.5 mg.'
                    , topic: 'numeracy'},
      {
                        id: 're1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the most common cause of urinary tract infection in children?',
                        options: ['Streptococcus', 'E. coli', 'Staphylococcus', 'Klebsiella'],
                        correct: 1,
                        explanation: 'E. coli is the most common pathogen causing UTI in children, responsible for about 80% of cases.'
                    , topic: 'renal'},
      {
                        id: 're2',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'What is the expected urine output for a child (1-12 years)?',
                        options: ['0.5 ml/kg/hr', '1 ml/kg/hr', '2 ml/kg/hr', '3 ml/kg/hr'],
                        correct: 1,
                        explanation: 'Expected urine output for children is approximately 1 ml/kg/hr. Less than 0.5 ml/kg/hr suggests oliguria.'
                    , topic: 'renal'},
      {
                        id: 're3',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Nephrotic syndrome is characterized by proteinuria, hypoalbuminemia, and edema.',
                        correct: true,
                        explanation: 'Nephrotic syndrome is defined by heavy proteinuria, hypoalbuminemia, edema, and often hyperlipidemia.'
                    , topic: 'renal'},
      {
                        id: 're4',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'What is the first-line treatment for minimal change nephrotic syndrome?',
                        options: ['ACE inhibitors', 'Corticosteroids', 'Cyclophosphamide', 'Diuretics'],
                        correct: 1,
                        explanation: 'Corticosteroids (prednisolone) are first-line treatment for minimal change nephrotic syndrome.'
                    , topic: 'renal'},
      {
                        id: 're5',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are risk factors for UTI in children? (Select all that apply)',
                        options: ['Vesicoureteral reflux', 'Constipation', 'Poor hygiene', 'High fluid intake'],
                        correct: [0, 1, 2],
                        explanation: 'VUR, constipation, and poor hygiene are risk factors. High fluid intake actually helps prevent UTI.'
                    , topic: 'renal'},
      {
                        id: 'bf1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is colostrum?',
                        options: ['Mature milk', 'First milk produced', 'Formula supplement', 'Milk let-down'],
                        correct: 1,
                        explanation: 'Colostrum is the first milk produced, rich in antibodies and immune factors, produced in the first few days postpartum.'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf2',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'How often should a newborn breastfeed in 24 hours?',
                        options: ['4-6 times', '6-8 times', '8-12 times', '12-16 times'],
                        correct: 2,
                        explanation: 'Newborns typically breastfeed 8-12 times in 24 hours, roughly every 2-3 hours.'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf3',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'Breastfeeding should be painful if done correctly.',
                        correct: false,
                        explanation: 'Breastfeeding should not be painful with correct positioning and attachment. Pain suggests latch issues.'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf4',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Which hormone is primarily responsible for milk production?',
                        options: ['Estrogen', 'Oxytocin', 'Prolactin', 'Progesterone'],
                        correct: 2,
                        explanation: 'Prolactin is the primary hormone for milk production. Oxytocin triggers milk let-down.'
                    , topic: 'breastfeeding'},
      {
                        id: 'bf5',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are signs of effective breastfeeding? (Select all that apply)',
                        options: ['Audible swallowing', 'Relaxed baby after feeds', 'Adequate wet nappies', 'Feeds lasting over 1 hour'],
                        correct: [0, 1, 2],
                        explanation: 'Audible swallowing, relaxed baby, and adequate wet nappies indicate effective feeding. Very long feeds may suggest poor transfer.'
                    , topic: 'breastfeeding'},
      {
                        id: 'hp1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'What is the primary goal of preparing a child for hospitalization?',
                        options: ['Speed up treatment', 'Reduce anxiety', 'Improve compliance', 'Reduce costs'],
                        correct: 1,
                        explanation: 'The primary goal is to reduce anxiety and fear, which helps the child cope better and supports their emotional wellbeing.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp2',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'When should preparation for planned hospitalization ideally begin?',
                        options: ['Day of admission', '1-2 days before', '1-2 weeks before', '1-2 months before'],
                        correct: 2,
                        explanation: 'For school-age children, 1-2 weeks allows time to process information without excessive anticipatory anxiety.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp3',
                        type: 'tf',
                        difficulty: 'easy',
                        question: 'It\'s best to use medical jargon when explaining procedures to children.',
                        correct: false,
                        explanation: 'Age-appropriate, simple language should be used. Medical jargon can increase confusion and anxiety.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp4',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Which play technique is most appropriate for preparing a child for a blood test?',
                        options: ['Competitive games', 'Medical play with dolls', 'Board games', 'Physical exercise'],
                        correct: 1,
                        explanation: 'Medical play with dolls/models allows children to rehearse, express fears, and gain sense of control.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'hp5',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which help reduce procedural anxiety? (Select all that apply)',
                        options: ['Distraction techniques', 'Parental presence', 'Honest explanations', 'Promising no pain'],
                        correct: [0, 1, 2],
                        explanation: 'Distraction, parental presence, and honest explanations help. Promising no pain is dishonest and damages trust.'
                    , topic: 'hospitalPrep'},
      {
                        id: 'num1',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'A child weighs 20 kg and is prescribed paracetamol 15 mg/kg. What is the total dose required?',
                        options: ['200 mg', '250 mg', '300 mg', '350 mg'],
                        correct: 2,
                        explanation: 'Total dose = Weight × Dose per kg = 20 kg × 15 mg/kg = 300 mg. Always check this against maximum single dose limits.'
                    , topic: 'numeracy'},
      {
                        id: 'num2',
                        type: 'mcq',
                        difficulty: 'easy',
                        question: 'You need to give 250 mg of amoxicillin. The suspension contains 125 mg/5ml. What volume do you give?',
                        options: ['5 ml', '10 ml', '15 ml', '20 ml'],
                        correct: 1,
                        explanation: 'Using Want/Got formula: Volume = (What you WANT ÷ What you\'ve GOT) × Volume = (250 ÷ 125) × 5 = 10 ml'
                    , topic: 'numeracy'},
      {
                        id: 'num3',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'A child weighing 15 kg needs IV fluids using Holliday-Segar. What is the 24-hour maintenance requirement?',
                        options: ['1000 ml', '1250 ml', '1500 ml', '1750 ml'],
                        correct: 1,
                        explanation: 'Holliday-Segar: First 10 kg = 100 ml/kg = 1000 ml. Next 5 kg = 50 ml/kg = 250 ml. Total = 1000 + 250 = 1250 ml/24hr'
                    , topic: 'numeracy'},
      {
                        id: 'num4',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'An infusion of 500 ml is prescribed over 8 hours. What rate (ml/hr) should the pump be set to?',
                        options: ['50 ml/hr', '62.5 ml/hr', '75 ml/hr', '80 ml/hr'],
                        correct: 1,
                        explanation: 'Rate = Total volume ÷ Time = 500 ml ÷ 8 hours = 62.5 ml/hr'
                    , topic: 'numeracy'},
      {
                        id: 'num5',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'A child weighing 25 kg needs morphine 0.1 mg/kg IV. The stock solution is 10 mg/ml. What volume do you draw up?',
                        options: ['0.15 ml', '0.25 ml', '0.5 ml', '2.5 ml'],
                        correct: 1,
                        explanation: 'Step 1: Total dose = 25 kg × 0.1 mg/kg = 2.5 mg. Step 2: Volume = 2.5 mg ÷ 10 mg/ml = 0.25 ml. Always double-check opioid calculations.'
                    , topic: 'numeracy'},
      {
                        id: 'num6',
                        type: 'tf',
                        difficulty: 'easy',
                        question: '1 gram equals 1000 milligrams.',
                        correct: true,
                        explanation: 'Correct. 1 g = 1000 mg, and 1 mg = 1000 mcg (micrograms). Always convert units before calculating to ensure they match.'
                    , topic: 'numeracy'},
      {
                        id: 'num7',
                        type: 'mcq',
                        difficulty: 'medium',
                        question: 'A child weighing 8 kg is prescribed gentamicin 5 mg/kg. The vial contains 80 mg/2ml. What volume is needed?',
                        options: ['0.5 ml', '1 ml', '1.5 ml', '2 ml'],
                        correct: 1,
                        explanation: 'Step 1: Dose = 8 kg × 5 mg/kg = 40 mg. Step 2: Concentration = 80 mg/2 ml = 40 mg/ml. Step 3: Volume = 40 mg ÷ 40 mg/ml = 1 ml'
                    , topic: 'numeracy'},
      {
                        id: 'num8',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'Using Holliday-Segar, what is the hourly maintenance fluid rate for a 30 kg child?',
                        options: ['60 ml/hr', '70 ml/hr', '75 ml/hr', '80 ml/hr'],
                        correct: 1,
                        explanation: 'First 10 kg: 1000 ml/day. Next 10 kg: 500 ml/day. Final 10 kg: 200 ml/day. Total = 1700 ml/day ÷ 24 hr = 70.8 ml/hr ≈ 70 ml/hr'
                    , topic: 'numeracy'},
      {
                        id: 'num9',
                        type: 'multiselect',
                        difficulty: 'medium',
                        question: 'Which are essential safety checks when calculating drug doses? (Select all that apply)',
                        options: ['Check patient weight is recent and accurate', 'Verify units match before calculating', 'Ask if answer seems realistic', 'Skip double-checking to save time'],
                        correct: [0, 1, 2],
                        explanation: 'Always check weight accuracy, verify units match, and sense-check your answer. Never skip double-checking - medication errors can be fatal in children.'
                    , topic: 'numeracy'},
      {
                        id: 'num10',
                        type: 'mcq',
                        difficulty: 'hard',
                        question: 'A neonate weighing 3.2 kg needs caffeine citrate 20 mg/kg loading dose. Stock is 20 mg/ml. What volume is required?',
                        options: ['2.8 ml', '3.2 ml', '6.4 ml', '32 ml'],
                        correct: 1,
                        explanation: 'Step 1: Dose = 3.2 kg × 20 mg/kg = 64 mg. Step 2: Volume = 64 mg ÷ 20 mg/ml = 3.2 ml. Always double-check neonatal calculations as small errors have big impacts.'
                    , topic: 'numeracy'}
    ];

    // ==================== OSCE STATION BANK ====================
    const stationBank = [
      // ========== HANDWASHING & IPC STATIONS ==========
      {
        id: 'hand-1',
        topic: 'handwashing',
        title: 'WHO 6-Step Hand Hygiene Technique',
        difficulty: 'easy',
        estimatedMinutes: 6,
        candidateInstructions: 'Demonstrate the WHO 6-step hand hygiene technique using soap and water. Explain when to use soap vs alcohol gel.',
        equipment: ['Sink with running water', 'Liquid soap', 'Paper towels', 'Alcohol hand gel', 'Clinical waste bin'],
        checklist: {
          preparation: [
            'Remove all hand jewellery',
            'Ensure nails short and clean',
            'Bare below elbows',
            'Check water temperature'
          ],
          assessment: [
            'Identify need for hand hygiene',
            'Determine if soap or ABHR appropriate'
          ],
          interventions: [
            'Wet hands thoroughly',
            'Apply sufficient soap',
            'Step 1: Rub palms together',
            'Step 2: Right palm over left dorsum and vice versa',
            'Step 3: Palm to palm with fingers interlaced',
            'Step 4: Backs of fingers to opposing palms',
            'Step 5: Rotational rubbing of thumbs',
            'Step 6: Rotational rubbing with clasped fingers',
            'Continue for 15-20 seconds',
            'Rinse thoroughly',
            'Dry completely with paper towel',
            'Use paper towel to turn off tap'
          ],
          communication: [
            'Explain importance to parent',
            'Describe 5 Moments for hand hygiene',
            'Discuss when soap mandatory vs ABHR'
          ],
          safetyRedFlags: [
            'Duration less than 15 seconds',
            'Steps missed',
            'Wearing hand jewellery'
          ],
          documentation: [
            'Report hand skin issues to senior',
            'Follow local audit policy'
          ]
        },
        tips: [
          'C.diff and norovirus require soap and water',
          'Most missed areas: thumbs, fingertips, backs of fingers',
          'WHO 5 Moments: Before patient, Before aseptic, After body fluid, After patient, After surroundings'
        ],
        warnings: [
          'Never use ABHR on visibly soiled hands',
          'Hand hygiene is single most important IPC measure',
          'False nails not permitted in clinical practice'
        ],
        mnemonics: [
          '5 Moments: Before patient, Before aseptic, After body fluid, After patient, After surroundings'
        ],
        scoring: {
          criticalFails: [
            'Did not complete all 6 steps',
            'Duration less than 15 seconds'
          ],
          marks: [
            { item: 'Preparation (jewellery removal, bare below elbows)', points: 2, domain: 'preparation' },
            { item: 'All 6 steps performed correctly', points: 6, domain: 'interventions' },
            { item: 'Adequate duration (15-20 seconds)', points: 2, domain: 'interventions' }
          ]
        }
      },

      // ========== RESPIRATORY STATIONS ==========
      {
        id: 'resp-1',
        topic: 'respiratory',
        title: 'Respiratory Assessment in Child',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Perform a complete respiratory assessment on this 4-year-old child with suspected respiratory distress. Report findings using SBAR.',
        equipment: ['Stethoscope', 'Pulse oximeter', 'Watch with second hand', 'Observation chart'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain procedure in age-appropriate language',
            'Gain consent from parent and assent from child',
            'Wash hands',
            'Ensure child comfort and privacy'
          ],
          assessment: [
            'Observe work of breathing BEFORE touching',
            'Count respiratory rate for full 60 seconds',
            'Assess respiratory pattern (regular/irregular)',
            'Look for nasal flaring',
            'Check for head bobbing',
            'Observe for intercostal recession',
            'Check for subcostal recession',
            'Look for tracheal tug',
            'Listen for grunting, stridor, wheeze',
            'Assess color (cyanosis, pallor)',
            'Apply pulse oximeter',
            'Auscultate chest (anterior and posterior)',
            'Check capillary refill time'
          ],
          interventions: [
            'Document all findings accurately',
            'Calculate PEWS score if applicable',
            'Position child for comfort (upright if distressed)'
          ],
          communication: [
            'Explain findings to parent',
            'Use SBAR to handover to senior',
            'Reassure child throughout'
          ],
          safetyRedFlags: [
            'Silent chest - immediate escalation',
            'Grunting - severe distress sign',
            'SpO2 <92% - requires oxygen',
            'Severe recession - impending respiratory failure'
          ],
          documentation: [
            'Record all observations on chart',
            'Document PEWS score',
            'Note time and escalation actions'
          ]
        },
        tips: [
          'Always count RR for full 60 seconds in children',
          'Observe BEFORE touching - child may cry when touched',
          'Normal RR varies by age: Infant 30-60, Toddler 20-30, School age 18-25'
        ],
        warnings: [
          'Silent chest more serious than wheeze',
          'Grunting = serious sign - escalate immediately'
        ],
        mnemonics: [
          'TINS: Tracheal tug, Intercostal recession, Nasal flaring, Subcostal recession'
        ],
        scoring: {
          criticalFails: [
            'Did not count RR for full 60 seconds',
            'Did not assess before touching child',
            'Failed to recognize red flags'
          ],
          marks: [
            { item: 'Introduction and consent', points: 2, domain: 'preparation' },
            { item: 'Systematic respiratory assessment', points: 4, domain: 'assessment' },
            { item: 'SBAR handover', points: 2, domain: 'communication' }
          ]
        }
      },

      // ========== CIRCULATION STATIONS ==========
      {
        id: 'circ-1',
        topic: 'circulation',
        title: 'Pulse Assessment in Infant',
        difficulty: 'easy',
        estimatedMinutes: 6,
        candidateInstructions: 'Assess the pulse of this 8-month-old infant. Demonstrate correct technique and interpret findings.',
        equipment: ['Watch with second hand', 'Observation chart', 'Hand sanitizer'],
        checklist: {
          preparation: [
            'Introduce self to parent',
            'Explain procedure to parent',
            'Wash hands thoroughly',
            'Ensure infant calm (not crying)',
            'Position infant comfortably'
          ],
          assessment: [
            'Select appropriate pulse site (brachial or femoral)',
            'Use pads of index and middle fingers (NOT thumb)',
            'Palpate pulse gently',
            'Count for full 60 seconds',
            'Assess pulse rate',
            'Assess pulse rhythm (regular/irregular)',
            'Assess pulse volume/strength',
            'Compare both sides if appropriate',
            'Note skin temperature and color'
          ],
          interventions: [
            'Document pulse rate accurately',
            'Record pulse quality and rhythm',
            'Compare to age-appropriate norms'
          ],
          communication: [
            'Explain findings to parent',
            'Discuss normal ranges for infant age',
            'Report concerns to senior nurse'
          ],
          safetyRedFlags: [
            'Weak/thready pulse - signs of shock',
            'Bounding pulse - possible sepsis/fever',
            'Irregular rhythm - requires medical review',
            'Unable to palpate pulse - emergency'
          ],
          documentation: [
            'Record rate, rhythm, and volume',
            'Note time of assessment',
            'Document site used',
            'Include any escalation actions'
          ]
        },
        tips: [
          'Brachial pulse: inner aspect of upper arm between bicep and tricep',
          'Femoral pulse: groin crease, halfway between hip and pubic bone',
          'Normal infant HR: 100-160 bpm (awake), 80-140 bpm (sleeping)',
          'Never use your thumb - it has its own pulse!'
        ],
        warnings: [
          'Crying infant will have elevated HR - wait until calm',
          'Never use carotid in infants - short neck makes it difficult',
          'Weak pulse with tachycardia = shock until proven otherwise'
        ],
        mnemonics: [
          'RRV: Rate, Rhythm, Volume - assess all three components'
        ],
        scoring: {
          criticalFails: [
            'Used thumb instead of fingers',
            'Did not count for full 60 seconds',
            'Failed to identify abnormal pulse'
          ],
          marks: [
            { item: 'Correct pulse site selection', points: 2, domain: 'assessment' },
            { item: 'Proper technique (fingers, not thumb)', points: 2, domain: 'assessment' },
            { item: 'Counted for full 60 seconds', points: 2, domain: 'assessment' },
            { item: 'Assessed rate, rhythm, and volume', points: 2, domain: 'assessment' }
          ]
        }
      },

      {
        id: 'circ-2',
        topic: 'circulation',
        title: 'Blood Pressure Measurement in Child',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Measure the blood pressure of this 6-year-old child. Use correct equipment and technique.',
        equipment: ['Appropriately sized BP cuff', 'Sphygmomanometer or automated BP machine', 'Stethoscope (manual method)', 'Observation chart'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain procedure in child-friendly terms',
            'Wash hands',
            'Ensure child has rested for 5 minutes',
            'Position child seated or lying comfortably',
            'Ensure arm supported at heart level',
            'Remove tight clothing from arm'
          ],
          assessment: [
            'Select correct cuff size (bladder 80% of arm circumference)',
            'Locate brachial artery',
            'Apply cuff 2-3cm above antecubital fossa',
            'Ensure cuff snug but not tight',
            'Position cuff bladder over brachial artery',
            'Verify arm at heart level',
            'Allow child to relax (distraction if needed)',
            'Take measurement (manual or automated)',
            'Record systolic and diastolic pressure',
            'Repeat if reading abnormal or unclear'
          ],
          interventions: [
            'Document BP reading accurately',
            'Compare to age/height percentile charts',
            'Calculate mean arterial pressure if needed',
            'Note any difficulty obtaining reading'
          ],
          communication: [
            'Warn child about squeezing sensation',
            'Praise child for cooperation',
            'Explain findings to parent',
            'Report abnormal readings to senior'
          ],
          safetyRedFlags: [
            'Hypotension in child - late sign of shock',
            'Hypertension - may indicate renal/cardiac issues',
            'Wide pulse pressure - potential increased ICP',
            'Unable to obtain reading - may indicate poor perfusion'
          ],
          documentation: [
            'Record systolic/diastolic pressures',
            'Note cuff size used',
            'Document arm used (left/right)',
            'Record time and patient position'
          ]
        },
        tips: [
          'Cuff too small = falsely high reading',
          'Cuff too large = falsely low reading',
          'Normal pediatric BP varies by age, height, and sex - use charts',
          'Hypotension is a LATE sign in pediatric shock'
        ],
        warnings: [
          'Never assume child is normotensive based on BP alone',
          'Children compensate well in shock - normal BP does NOT rule out shock',
          'Always use age-appropriate cuff size'
        ],
        mnemonics: [
          'Cuff size rule: Width = 80% of arm circumference, Length = covers 80-100% of arm'
        ],
        scoring: {
          criticalFails: [
            'Used incorrect cuff size',
            'Did not position arm at heart level',
            'Failed to recognize abnormal reading'
          ],
          marks: [
            { item: 'Correct cuff size selection', points: 2, domain: 'preparation' },
            { item: 'Proper cuff placement and positioning', points: 2, domain: 'assessment' },
            { item: 'Accurate measurement technique', points: 2, domain: 'assessment' },
            { item: 'Interpretation and documentation', points: 2, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'circ-3',
        topic: 'circulation',
        title: 'Capillary Refill Time Assessment',
        difficulty: 'easy',
        estimatedMinutes: 5,
        candidateInstructions: 'Assess capillary refill time in this 3-year-old child. Demonstrate technique and interpret findings.',
        equipment: ['Watch with second hand', 'Observation chart', 'Hand sanitizer'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain procedure simply to child',
            'Wash hands',
            'Ensure child in warm environment',
            'Ensure adequate lighting',
            'Position child comfortably'
          ],
          assessment: [
            'Select appropriate site (fingertip or sternum)',
            'Apply firm pressure for 5 seconds',
            'Press until area blanches (turns white)',
            'Release pressure completely',
            'Start timing immediately upon release',
            'Observe color return',
            'Count seconds until normal color returns',
            'Assess if CRT <2 seconds or >2 seconds',
            'Check centrally AND peripherally',
            'Note skin temperature'
          ],
          interventions: [
            'Document CRT in seconds',
            'Assess for signs of poor perfusion',
            'Consider other circulatory markers'
          ],
          communication: [
            'Make it playful for child ("magic trick")',
            'Explain findings to parent',
            'Report prolonged CRT immediately',
            'Use SBAR if escalation needed'
          ],
          safetyRedFlags: [
            'CRT >2 seconds - poor perfusion/shock',
            'CRT >5 seconds - severe shock',
            'Mottled skin - serious perfusion issue',
            'Cool peripheries - circulatory compromise'
          ],
          documentation: [
            'Record CRT in seconds',
            'Note site assessed (central/peripheral)',
            'Document skin temperature and color',
            'Record time and escalation if needed'
          ]
        },
        tips: [
          'Normal CRT: <2 seconds',
          'Central CRT (sternum) more reliable than peripheral',
          'Cold environment can prolong CRT - consider this',
          'Combine with other circulatory signs (HR, BP, pulse, urine output)'
        ],
        warnings: [
          'CRT >2 seconds suggests shock - assess other signs urgently',
          'CRT can be normal in early compensated shock',
          'Never rely on CRT alone - use ABCDE approach'
        ],
        mnemonics: [
          'CRT mnemonic: "2 to trouble" - >2 seconds is prolonged and worrying'
        ],
        scoring: {
          criticalFails: [
            'Did not apply adequate pressure to blanch',
            'Failed to time accurately',
            'Did not recognize prolonged CRT as abnormal'
          ],
          marks: [
            { item: 'Correct technique (pressure and timing)', points: 3, domain: 'assessment' },
            { item: 'Accurate interpretation of CRT', points: 2, domain: 'assessment' },
            { item: 'Appropriate escalation if prolonged', points: 2, domain: 'communication' }
          ]
        }
      },

      // ========== SAFETY STATIONS ==========
      {
        id: 'safe-1',
        topic: 'safety',
        title: 'SBAR Handover Communication',
        difficulty: 'medium',
        estimatedMinutes: 7,
        candidateInstructions: 'You are concerned about a 3-year-old patient with increasing respiratory distress. Use SBAR to hand over to the senior nurse. You will be assessed on structure and content.',
        equipment: ['Patient notes/observation chart', 'Pen', 'SBAR prompt sheet (if needed)'],
        checklist: {
          preparation: [
            'Gather all relevant patient information',
            'Review recent observations',
            'Check medication chart',
            'Have patient notes available',
            'Prepare clear, concise handover'
          ],
          assessment: [
            'Review ABCDE assessment findings',
            'Note trend in observations',
            'Identify concerning signs',
            'Consider PEWS score if applicable'
          ],
          interventions: [
            'SITUATION: State name, role, patient details, and concern clearly',
            'SITUATION: State the problem in one clear sentence',
            'BACKGROUND: Provide relevant history (admission reason, diagnosis)',
            'BACKGROUND: State relevant medications and allergies',
            'BACKGROUND: Mention recent treatments/interventions',
            'ASSESSMENT: Present current observations systematically',
            'ASSESSMENT: State clinical findings (ABCDE)',
            'ASSESSMENT: Give your assessment of severity',
            'RECOMMENDATION: State what you think is needed',
            'RECOMMENDATION: Ask for specific action/review',
            'RECOMMENDATION: State urgency clearly'
          ],
          communication: [
            'Speak clearly and confidently',
            'Use structured approach throughout',
            'Avoid jargon or unclear abbreviations',
            'Listen to questions and respond appropriately',
            'Confirm understanding and actions',
            'Repeat back instructions if given'
          ],
          safetyRedFlags: [
            'Vague or unclear communication',
            'Missing critical information',
            'No clear recommendation',
            'Downplaying severity of situation',
            'Not stating urgency'
          ],
          documentation: [
            'Document handover in notes',
            'Record time and person handed over to',
            'Note instructions received',
            'Sign and date entry'
          ]
        },
        tips: [
          'SBAR keeps communication structured and complete',
          'Situation should be one clear sentence: "I am worried about..."',
          'Background gives context - keep it relevant and concise',
          'Assessment is your findings - be objective',
          'Recommendation - don\'t be afraid to suggest what you think is needed'
        ],
        warnings: [
          'Never assume senior knows the patient - give full context',
          'Don\'t minimize concerns - if worried, say so clearly',
          'Always state urgency - "I need you to see them now/within the hour"',
          'Missing SBAR components = incomplete handover = patient safety risk'
        ],
        mnemonics: [
          'SBAR: Situation, Background, Assessment, Recommendation',
          'Situation opener: "I\'m [name], [role], calling about [patient] in [location]. I\'m concerned because [problem]"'
        ],
        scoring: {
          criticalFails: [
            'Did not identify themselves and patient',
            'Failed to state clear concern',
            'No recommendation made',
            'Missing entire SBAR component'
          ],
          marks: [
            { item: 'Clear SITUATION statement with concern', points: 2, domain: 'interventions' },
            { item: 'Relevant BACKGROUND information', points: 2, domain: 'interventions' },
            { item: 'Systematic ASSESSMENT with findings', points: 2, domain: 'interventions' },
            { item: 'Clear RECOMMENDATION with urgency', points: 2, domain: 'interventions' },
            { item: 'Professional communication throughout', points: 1, domain: 'communication' },
            { item: 'Documentation', points: 1, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'safe-2',
        topic: 'safety',
        title: 'Patient Identification Check',
        difficulty: 'easy',
        estimatedMinutes: 5,
        candidateInstructions: 'Demonstrate the three-point patient identification check before administering medication to this 5-year-old child. Explain each step clearly.',
        equipment: ['Patient wristband (on manikin/actor)', 'Medication chart', 'Patient notes'],
        checklist: {
          preparation: [
            'Introduce yourself to child and parent',
            'Explain you will check identity',
            'Wash hands',
            'Have medication chart ready'
          ],
          assessment: [
            'Check patient wristband is present',
            'Verify wristband is intact and legible',
            'Assess if child able to state details (age appropriate)'
          ],
          interventions: [
            'POINT 1: Ask patient to state name and DOB (or ask parent)',
            'POINT 2: Check wristband details match (name, DOB, NHS number)',
            'POINT 3: Cross-check medication chart matches patient',
            'Verify all three identifiers match',
            'Do NOT proceed if any discrepancy found',
            'Check allergy status on wristband and chart'
          ],
          communication: [
            'Explain process to parent in friendly manner',
            'Use age-appropriate language for child',
            'Thank patient and parent for cooperation',
            'If discrepancy found, explain calmly and escalate'
          ],
          safetyRedFlags: [
            'No wristband present - do NOT proceed',
            'Wristband illegible - must replace before proceeding',
            'Details do not match - STOP and escalate immediately',
            'Skipping any of the three checks - critical fail'
          ],
          documentation: [
            'Document ID check completed',
            'Note any issues with wristband',
            'Report missing/illegible wristbands immediately'
          ]
        },
        tips: [
          'Three-point check: 1) Ask patient 2) Check wristband 3) Check chart',
          'NEVER skip ID check - even for familiar patients',
          'If child too young to state details, ask parent AND check wristband',
          'Always check allergy status as part of ID check'
        ],
        warnings: [
          'Wrong patient medication errors can be fatal',
          'Never rely on bed number or parent confirmation alone',
          'Missing wristband = DO NOT proceed with any procedure',
          'Never assume - always verify'
        ],
        mnemonics: [
          'Three-point ID: ASK (patient), SEE (wristband), CHECK (chart)'
        ],
        scoring: {
          criticalFails: [
            'Did not complete all three identification checks',
            'Proceeded despite discrepancy',
            'Did not check wristband'
          ],
          marks: [
            { item: 'Asked patient/parent to state name and DOB', points: 2, domain: 'interventions' },
            { item: 'Checked wristband matches', points: 2, domain: 'interventions' },
            { item: 'Cross-checked with medication chart', points: 2, domain: 'interventions' },
            { item: 'Checked allergy status', points: 1, domain: 'interventions' },
            { item: 'Clear communication throughout', points: 1, domain: 'communication' }
          ]
        }
      },

      // ========== PAIN ASSESSMENT STATIONS ==========
      {
        id: 'pain-1',
        topic: 'pain',
        title: 'Pain Assessment Using FLACC Scale',
        difficulty: 'easy',
        estimatedMinutes: 6,
        candidateInstructions: 'Assess pain in this 18-month-old infant who is post-operative. Use the FLACC scale and document your findings.',
        equipment: ['FLACC pain assessment tool', 'Observation chart', 'Pen', 'Watch'],
        checklist: {
          preparation: [
            'Introduce self to parent',
            'Explain pain assessment to parent',
            'Wash hands',
            'Ensure adequate lighting',
            'Position self to observe infant clearly'
          ],
          assessment: [
            'Assess FACE: relaxed vs grimacing/frowning',
            'Score Face 0-2',
            'Assess LEGS: normal vs tense/restless/kicking',
            'Score Legs 0-2',
            'Assess ACTIVITY: normal vs squirming/arched/rigid',
            'Score Activity 0-2',
            'Assess CRY: no cry vs moans/whimpers or screaming',
            'Score Cry 0-2',
            'Assess CONSOLABILITY: content vs difficult to console',
            'Score Consolability 0-2',
            'Calculate total FLACC score (0-10)',
            'Observe infant for at least 2-5 minutes'
          ],
          interventions: [
            'Document FLACC score accurately',
            'Interpret score (0=relaxed, 1-3=mild, 4-6=moderate, 7-10=severe)',
            'Plan pain management based on score',
            'Consider non-pharmacological comfort measures'
          ],
          communication: [
            'Explain findings to parent',
            'Ask parent about infant usual pain behaviors',
            'Discuss pain management plan',
            'Report significant pain to prescriber'
          ],
          safetyRedFlags: [
            'FLACC score ≥7 - severe pain requiring immediate analgesia',
            'Rigid/arched posturing - severe distress',
            'Inconsolable crying - requires urgent review',
            'Changed behavior from baseline - may indicate pain'
          ],
          documentation: [
            'Record FLACC score on pain chart',
            'Document all 5 component scores',
            'Note time of assessment',
            'Record parent concerns',
            'Document interventions planned'
          ]
        },
        tips: [
          'FLACC: Face, Legs, Activity, Cry, Consolability',
          'Each component scored 0-2, total 0-10',
          'FLACC used for children <3 years or non-verbal of any age',
          'Observe for 2-5 minutes before scoring',
          'Consider baseline behavior - ask parent what\'s normal'
        ],
        warnings: [
          'Never assume non-verbal children don\'t have pain',
          'Score 0 doesn\'t always mean no pain - consider other factors',
          'Sedation can mask pain behaviors - be cautious',
          'Always believe parent concerns about child pain'
        ],
        mnemonics: [
          'FLACC: Face, Legs, Activity, Cry, Consolability'
        ],
        scoring: {
          criticalFails: [
            'Did not assess all 5 FLACC components',
            'Incorrect calculation of total score',
            'Failed to escalate severe pain (score ≥7)'
          ],
          marks: [
            { item: 'Assessed all 5 FLACC components correctly', points: 3, domain: 'assessment' },
            { item: 'Accurate scoring (0-2 for each component)', points: 2, domain: 'assessment' },
            { item: 'Correct interpretation of total score', points: 2, domain: 'interventions' },
            { item: 'Appropriate pain management plan', points: 2, domain: 'interventions' },
            { item: 'Clear documentation', points: 1, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'pain-2',
        topic: 'pain',
        title: 'Pain Assessment Using Wong-Baker FACES',
        difficulty: 'easy',
        estimatedMinutes: 6,
        candidateInstructions: 'Assess pain in this 5-year-old child who has fallen and injured their arm. Use the Wong-Baker FACES scale appropriately.',
        equipment: ['Wong-Baker FACES pain scale (visual chart)', 'Pain assessment documentation', 'Pen'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain you will check how much pain child has',
            'Wash hands',
            'Position at child eye level',
            'Ensure child can see FACES chart clearly'
          ],
          assessment: [
            'Show child the FACES scale',
            'Explain each face in age-appropriate language',
            'Start from happy face (0 - no hurt)',
            'Progress to sad faces (2, 4, 6, 8)',
            'End with crying face (10 - hurts worst)',
            'Ask child to point to face that matches their pain NOW',
            'Confirm child understanding by asking them to explain choice',
            'Note non-verbal cues (facial expression, guarding, posture)',
            'Assess location of pain',
            'Ask when pain started and what makes it better/worse'
          ],
          interventions: [
            'Document pain score accurately',
            'Record pain location',
            'Plan appropriate pain relief',
            'Consider non-pharmacological strategies (distraction, comfort positioning)'
          ],
          communication: [
            'Use simple, child-friendly language',
            'Avoid leading questions',
            'Praise child for helping',
            'Explain findings to parent',
            'Discuss pain management options with child and parent',
            'Reassure child that help is available'
          ],
          safetyRedFlags: [
            'Pain score ≥7 - severe pain requiring analgesia',
            'Child pointing to worst face but appearing calm - may not understand',
            'Mismatch between score and behavior - needs clarification',
            'Pain affecting function (won\'t move limb, won\'t play)'
          ],
          documentation: [
            'Record numeric pain score (0-10)',
            'Document pain location',
            'Note pain characteristics (sharp, dull, constant, intermittent)',
            'Record child exact words about pain',
            'Document interventions provided'
          ]
        },
        tips: [
          'Wong-Baker FACES appropriate for ages 3-7 years',
          'Always explain ALL faces before asking child to choose',
          'Use words child understands: "hurt" better than "pain"',
          'Some children always point to crying face - check understanding',
          'Behavioral cues should match reported score'
        ],
        warnings: [
          'Never suggest which face to point to',
          'Don\'t ask "Does it hurt?" - ask "How much does it hurt?"',
          'Some children minimize pain to avoid medication/procedures',
          'Cultural differences affect pain expression - consider context'
        ],
        mnemonics: [
          'FACES scale: 0, 2, 4, 6, 8, 10 (even numbers only)',
          'Wong-Baker: Widely Observed for Noting Great pain - Brings Assessment of Kids\' Experience to Reality'
        ],
        scoring: {
          criticalFails: [
            'Did not explain all faces to child',
            'Led child to specific answer',
            'Dismissed child reported pain score'
          ],
          marks: [
            { item: 'Appropriate introduction and positioning', points: 2, domain: 'preparation' },
            { item: 'Explained all FACES to child clearly', points: 2, domain: 'assessment' },
            { item: 'Child-friendly communication throughout', points: 2, domain: 'communication' },
            { item: 'Accurate documentation', points: 2, domain: 'documentation' },
            { item: 'Appropriate pain management plan', points: 2, domain: 'interventions' }
          ]
        }
      },

      {
        id: 'pain-3',
        topic: 'pain',
        title: 'Comprehensive Pain Assessment in School-Age Child',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Perform a comprehensive pain assessment on this 9-year-old with abdominal pain. Use the numerical rating scale (0-10) and gather complete pain history.',
        equipment: ['Numerical rating scale (0-10)', 'Pain assessment chart', 'Body diagram', 'Pen'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain pain assessment process',
            'Gain consent and assent',
            'Wash hands',
            'Ensure privacy and comfort',
            'Position at child eye level'
          ],
          assessment: [
            'Use numerical scale 0-10 (0=no pain, 10=worst pain)',
            'Ask child current pain score',
            'PQRST assessment:',
            'P - Provokes: What makes pain worse/better?',
            'Q - Quality: Describe pain (sharp, dull, burning, aching)',
            'R - Radiates: Does pain spread anywhere?',
            'S - Severity: Rate 0-10, and at best/worst times',
            'T - Time: When started? Constant or comes and goes?',
            'Use body diagram for child to show pain location',
            'Assess impact on daily activities (eating, sleeping, playing)',
            'Observe for non-verbal pain cues',
            'Check vital signs if appropriate',
            'Ask about previous pain episodes',
            'Identify current pain relief measures tried'
          ],
          interventions: [
            'Document comprehensive pain assessment',
            'Interpret findings systematically',
            'Develop individualized pain management plan',
            'Consider pharmacological and non-pharmacological options',
            'Set realistic pain management goals with child'
          ],
          communication: [
            'Use age-appropriate language',
            'Allow child to describe pain in own words',
            'Ask open-ended questions',
            'Involve child in pain management decisions',
            'Explain pain management plan clearly',
            'Reassure child that pain is believed and will be addressed',
            'Educate about realistic pain expectations'
          ],
          safetyRedFlags: [
            'Severe pain (8-10/10) - urgent analgesia needed',
            'Acute abdominal pain with guarding - surgical emergency?',
            'Pain preventing sleep or eating - significant impact',
            'Changed behavior (withdrawn, irritable) - inadequate pain control',
            'Red flag symptoms (fever, vomiting, severe location-specific pain)'
          ],
          documentation: [
            'Record pain score (0-10)',
            'Complete PQRST documentation',
            'Document pain location on body diagram',
            'Note impact on activities of daily living',
            'Record child exact description of pain',
            'Document pain management plan',
            'Note reassessment time planned'
          ]
        },
        tips: [
          'PQRST: Provokes, Quality, Radiates, Severity, Time',
          'School-age children (7+) can use 0-10 scale reliably',
          'Always ask child FIRST before asking parent',
          'Pain is what child says it is - always believe them',
          'Assess pain regularly - "5th vital sign"'
        ],
        warnings: [
          'Never dismiss child pain as "attention-seeking"',
          'Abdominal pain in children can indicate serious pathology',
          'Inadequate pain control affects healing and psychological wellbeing',
          'Some children stoic/minimize pain - observe behavior too'
        ],
        mnemonics: [
          'PQRST: Provokes/Palliates, Quality, Radiates/Region, Severity, Time/Timing',
          'OLDCARTS: Onset, Location, Duration, Character, Aggravating factors, Relieving factors, Timing, Severity'
        ],
        scoring: {
          criticalFails: [
            'Did not use numerical scale appropriately',
            'Incomplete PQRST assessment (missing ≥2 components)',
            'Failed to identify red flag symptoms'
          ],
          marks: [
            { item: 'Appropriate pain scale for age', points: 1, domain: 'assessment' },
            { item: 'Complete PQRST assessment', points: 3, domain: 'assessment' },
            { item: 'Body diagram documentation', points: 1, domain: 'assessment' },
            { item: 'Child-centered communication', points: 2, domain: 'communication' },
            { item: 'Comprehensive pain management plan', points: 2, domain: 'interventions' },
            { item: 'Thorough documentation', points: 1, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'comm-1',
        topic: 'communication',
        title: 'Gaining Consent and Assent',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'You need to perform venepuncture on this 6-year-old child. Gain consent from the parent and assent from the child. Explain the difference between consent and assent.',
        equipment: ['Procedure information leaflet', 'Age-appropriate resources (e.g., visual aids, dolls)', 'Pen for consent documentation'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Create child-friendly environment',
            'Ensure privacy for discussion',
            'Have visual aids/resources ready',
            'Allow time for questions'
          ],
          assessment: [
            'Assess child\'s developmental level',
            'Determine child\'s understanding ability',
            'Check parent understanding of procedure',
            'Identify any previous experiences',
            'Note any fears or anxieties'
          ],
          interventions: [
            'Explain procedure to CHILD first in simple terms',
            'Use age-appropriate language (no jargon)',
            'Be honest - "It will hurt like a scratch but be quick"',
            'Show equipment if appropriate',
            'Use play/visual aids to demonstrate',
            'Ask child if they agree to procedure (assent)',
            'Explain procedure to PARENT with detail',
            'Discuss risks, benefits, alternatives',
            'Answer parent questions fully',
            'Gain formal CONSENT from parent',
            'Document both consent and assent',
            'Respect if child refuses (discuss with parent)'
          ],
          communication: [
            'Speak to child at eye level',
            'NEVER lie about pain or duration',
            'Use positive language ("Help us" not "Let us")',
            'Praise child for listening and being brave',
            'Allow child to ask questions',
            'Check understanding by asking child to explain back',
            'Involve child in choices (which arm, sit vs lie)',
            'Thank both child and parent'
          ],
          safetyRedFlags: [
            'Lying to child - destroys trust permanently',
            'Not gaining assent from child (if able)',
            'Proceeding without parental consent',
            'Forcing procedure on distressed child without discussion',
            'Using threatening language'
          ],
          documentation: [
            'Document consent obtained from parent',
            'Record assent obtained from child',
            'Note who gave consent and their relationship',
            'Document explanation given',
            'Note any refusal and actions taken'
          ]
        },
        tips: [
          'Consent = legal permission from parent. Assent = child\'s agreement',
          'Speak to child FIRST - they are your patient',
          'Never say "It won\'t hurt" - always be honest',
          'Give child some control - reduces anxiety',
          'If child refuses, explore why - can often resolve fears'
        ],
        warnings: [
          'Children under 16 cannot usually give legal consent (parent needed)',
          'Gillick competence applies to some older children - seek senior advice',
          'Never proceed without consent from person with parental responsibility',
          'Assent important for cooperation and trust - don\'t ignore it'
        ],
        mnemonics: [
          'CARE for consent: Competent person, All information given, Recorded in notes, Explicit permission',
          'Child communication: HONEST, Eye level, Age-appropriate, Respect refusal, Truth about pain'
        ],
        scoring: {
          criticalFails: [
            'Lied about pain ("won\'t hurt at all")',
            'Did not gain parental consent',
            'Ignored child completely',
            'Did not explain procedure'
          ],
          marks: [
            { item: 'Age-appropriate explanation to child', points: 2, domain: 'interventions' },
            { item: 'Honest about discomfort', points: 2, domain: 'communication' },
            { item: 'Gained child\'s assent', points: 2, domain: 'interventions' },
            { item: 'Full explanation to parent', points: 1, domain: 'interventions' },
            { item: 'Gained formal parental consent', points: 2, domain: 'interventions' },
            { item: 'Documentation', points: 1, domain: 'documentation' }
          ]
        }
      },

      // ========== PERSONAL CARE STATIONS ==========
      {
        id: 'care-1',
        topic: 'personalcare',
        title: 'Pressure Area Assessment in Child',
        difficulty: 'easy',
        estimatedMinutes: 6,
        candidateInstructions: 'Perform a pressure area assessment on this 8-year-old child who has been bedbound for 3 days. Identify at-risk areas and document findings.',
        equipment: ['Observation chart', 'Pressure area assessment tool', 'Hand sanitizer', 'Good lighting'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain procedure in age-appropriate language',
            'Gain consent from parent and assent from child',
            'Wash hands thoroughly',
            'Ensure privacy (close curtains/door)',
            'Position child comfortably',
            'Ensure adequate lighting'
          ],
          assessment: [
            'Assess Sacrum for redness/breakdown',
            'Assess Heels (both) for pressure damage',
            'Assess Elbows (both) for skin changes',
            'Assess Occiput (back of head) for pressure',
            'Assess Ears for redness or damage',
            'Check skin integrity at each site',
            'Look for blanching/non-blanching erythema',
            'Assess for skin discoloration',
            'Check for warmth or coolness',
            'Note any moisture or maceration',
            'Assess pain or tenderness at sites',
            'Grade any pressure damage found'
          ],
          interventions: [
            'Document all findings accurately',
            'Complete pressure ulcer risk assessment tool',
            'Plan repositioning schedule',
            'Consider pressure-relieving equipment needs'
          ],
          communication: [
            'Explain findings to parent',
            'Discuss prevention strategies',
            'Educate on repositioning importance',
            'Report concerns to senior nurse'
          ],
          safetyRedFlags: [
            'Non-blanching erythema - Grade 2+ pressure damage',
            'Broken skin - requires urgent management',
            'Deep tissue injury - purple/maroon discoloration',
            'Signs of infection at pressure site'
          ],
          documentation: [
            'Record assessment of all SHEOE areas',
            'Document grade of any pressure damage',
            'Note risk assessment score',
            'Record prevention plan implemented'
          ]
        },
        tips: [
          'SHEOE mnemonic: Sacrum, Heels, Elbows, Occiput, Ears',
          'Children have different pressure points than adults - occiput is major risk',
          'Blanching erythema = Grade 1 (reversible), Non-blanching = Grade 2+',
          'Prevention is key - repositioning every 2 hours minimum'
        ],
        warnings: [
          'Never massage reddened areas - can worsen tissue damage',
          'Occipital pressure ulcers in infants can develop rapidly',
          'Medical devices (O2 masks, NG tubes) can cause pressure damage'
        ],
        mnemonics: [
          'SHEOE: Sacrum, Heels, Elbows, Occiput (back of head), Ears'
        ],
        scoring: {
          criticalFails: [
            'Did not assess all SHEOE pressure points',
            'Failed to gain consent/assent',
            'Did not document findings'
          ],
          marks: [
            { item: 'Assessed all 5 SHEOE areas systematically', points: 3, domain: 'assessment' },
            { item: 'Correct grading of pressure damage', points: 2, domain: 'assessment' },
            { item: 'Appropriate prevention plan', points: 2, domain: 'interventions' },
            { item: 'Clear documentation', points: 1, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'care-2',
        topic: 'personalcare',
        title: 'Oral Hygiene in NBM Patient',
        difficulty: 'medium',
        estimatedMinutes: 7,
        candidateInstructions: 'Provide oral hygiene care for this 5-year-old who has been nil by mouth for 12 hours post-operatively. The child is drowsy but rousable.',
        equipment: ['Small soft toothbrush or foam sticks', 'Toothpaste or mouthwash', 'Water', 'Bowl/kidney dish', 'Gauze', 'Lip balm', 'Suction (available)', 'Gloves', 'Apron', 'Towel'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain procedure to parent and child',
            'Gain consent from parent',
            'Wash hands',
            'Put on gloves and apron',
            'Gather all equipment',
            'Ensure suction available at bedside',
            'Position child semi-upright or on side (NEVER flat)'
          ],
          assessment: [
            'Assess level of consciousness',
            'Check gag reflex present',
            'Inspect oral cavity for dryness',
            'Look for oral thrush (white patches)',
            'Check lips for cracking or bleeding',
            'Assess mucous membranes',
            'Note any foul odor'
          ],
          interventions: [
            'Place towel to protect clothing',
            'Moisten toothbrush/foam stick',
            'Apply small amount toothpaste',
            'Gently brush teeth and gums',
            'Clean tongue gently',
            'Clean inside of cheeks',
            'Use gauze to wipe away debris',
            'Rinse mouth with small amounts of water',
            'Use suction if needed to clear secretions',
            'Pat dry around mouth',
            'Apply lip balm to lips',
            'Dispose of equipment safely',
            'Remove gloves and apron',
            'Wash hands'
          ],
          communication: [
            'Talk to child throughout (even if drowsy)',
            'Explain each step before doing it',
            'Reassure and comfort child',
            'Praise child for cooperation',
            'Update parent on oral condition'
          ],
          safetyRedFlags: [
            'Absent gag reflex - high aspiration risk',
            'Child unable to protect airway',
            'Signs of oral thrush - requires treatment',
            'Bleeding gums - may indicate clotting issues'
          ],
          documentation: [
            'Record oral hygiene performed',
            'Document oral cavity condition',
            'Note any abnormalities found',
            'Record time performed',
            'Plan next oral hygiene time (4-6 hours)'
          ]
        },
        tips: [
          'NBM patients need oral care every 4-6 hours minimum',
          'Position is critical - NEVER flat (aspiration risk)',
          'Foam sticks better for very dry/sore mouths',
          'Small frequent mouth care better than infrequent thorough care'
        ],
        warnings: [
          'NEVER perform oral care on flat patient - aspiration risk',
          'Ensure suction available before starting',
          'Reduced consciousness = increased aspiration risk',
          'Oral thrush common in NBM patients - check carefully'
        ],
        mnemonics: [
          'NBM oral care frequency: "4 to 6 to avoid the fix" (every 4-6 hours prevents problems)'
        ],
        scoring: {
          criticalFails: [
            'Positioned child flat during procedure',
            'Did not check gag reflex/level of consciousness',
            'No suction available for drowsy patient'
          ],
          marks: [
            { item: 'Safe positioning (semi-upright or side)', points: 2, domain: 'preparation' },
            { item: 'Thorough oral assessment', points: 2, domain: 'assessment' },
            { item: 'Systematic cleaning technique', points: 3, domain: 'interventions' },
            { item: 'Documentation and care plan', points: 1, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'care-3',
        topic: 'personalcare',
        title: 'Bed Bath for Child',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Perform a bed bath for this bedbound 7-year-old child. Demonstrate correct technique and maintain dignity throughout.',
        equipment: ['Bowl of warm water', 'Soap/body wash', 'Two washcloths', 'Two towels', 'Clean clothing/gown', 'Gloves', 'Apron', 'Barrier cream if needed', 'Laundry bag'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain procedure to child',
            'Gain consent from parent and assent from child',
            'Wash hands',
            'Put on apron',
            'Ensure privacy (close curtains/door)',
            'Adjust bed to comfortable working height',
            'Ensure room warm enough',
            'Gather all equipment before starting',
            'Test water temperature (comfortably warm)'
          ],
          assessment: [
            'Assess skin integrity',
            'Check for rashes or breakdown',
            'Note any wounds or devices',
            'Assess mobility and cooperation level',
            'Identify any painful areas'
          ],
          interventions: [
            'Put on gloves',
            'Keep child covered (expose only area being washed)',
            'FACE: Wash with water only (no soap), pat dry',
            'NECK: Wash and dry thoroughly',
            'ARMS: Wash one at a time, including axilla, pat dry',
            'CHEST: Wash and dry, keep covered when not washing',
            'ABDOMEN: Wash and dry, check umbilicus if young child',
            'LEGS: Wash one at a time, pat dry',
            'BACK: Turn child on side, wash and dry back',
            'PERINEUM: Change water, put on fresh gloves',
            'PERINEUM: Wash front to back for girls, pat dry',
            'Apply barrier cream if needed',
            'Help child into clean clothing',
            'Ensure child comfortable',
            'Dispose of water and linens appropriately',
            'Remove gloves and apron',
            'Wash hands'
          ],
          communication: [
            'Talk to child throughout',
            'Maintain dignity and privacy',
            'Encourage child participation where possible',
            'Praise and reassure child',
            'Respect child modesty and preferences'
          ],
          safetyRedFlags: [
            'Skin breakdown or pressure damage',
            'Rash requiring medical review',
            'Signs of infection',
            'Child in pain during handling'
          ],
          documentation: [
            'Record bed bath completed',
            'Document skin condition',
            'Note any concerns or abnormalities',
            'Record child tolerance of procedure'
          ]
        },
        tips: [
          'Order: Clean to dirty (face to body to back to perineum)',
          'Face always washed with WATER ONLY (no soap)',
          'Change water and gloves before perineal care',
          'Keep child covered - only expose area being washed',
          'For girls: ALWAYS front to back to prevent UTI'
        ],
        warnings: [
          'Never leave child unattended during bed bath',
          'Water temperature critical - test thoroughly (not too hot)',
          'Maintain dignity - minimal exposure',
          'Fresh gloves and water for perineal care - infection prevention'
        ],
        mnemonics: [
          'Washing order: "Face Never Accepts Cheese And Lettuce Before Pasta" (Face, Neck, Arms, Chest, Abdomen, Legs, Back, Perineum)'
        ],
        scoring: {
          criticalFails: [
            'Did not maintain privacy/dignity',
            'Used soap on face',
            'Did not change water/gloves before perineal care',
            'Washed back to front on girl (UTI risk)'
          ],
          marks: [
            { item: 'Correct washing order (clean to dirty)', points: 2, domain: 'interventions' },
            { item: 'Maintained dignity and privacy throughout', points: 2, domain: 'communication' },
            { item: 'Proper perineal care (fresh water/gloves, correct direction)', points: 2, domain: 'interventions' },
            { item: 'Thorough skin assessment', points: 2, domain: 'assessment' }
          ]
        }
      },

      // ========== NG TUBE STATIONS ==========
      {
        id: 'ng-1',
        topic: 'ngtubes',
        title: 'NG Tube Position Verification - pH Testing',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Verify the position of this nasogastric tube before administering medication. Use pH testing method and demonstrate correct procedure.',
        equipment: ['pH indicator strips (range 0-6 or 1-11)', 'Clean gloves', 'Apron', '50ml syringe (catheter tip)', 'Receiver/bowl', 'Clean gauze', 'Documentation chart', 'Second nurse available if needed'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain procedure in age-appropriate language',
            'Gain consent from parent',
            'Wash hands thoroughly',
            'Put on apron and gloves',
            'Check NG tube secured appropriately',
            'Check external length marking visible and documented',
            'Ensure child comfortable position (upright or on left side)'
          ],
          assessment: [
            'Check when NG tube last used',
            'Review when position last confirmed',
            'Verify no contraindications to aspiration',
            'Assess child tolerance and cooperation',
            'Check pH strips in date and stored correctly'
          ],
          interventions: [
            'Verify external tube length matches documented measurement',
            'If length changed - STOP and escalate immediately',
            'Remove cap/bung from NG tube',
            'Attach 50ml syringe to NG tube',
            'Gently pull back plunger to aspirate',
            'Attempt to obtain at least 0.5ml aspirate',
            'If no aspirate obtained: try repositioning strategies',
            'Turn child onto LEFT side',
            'Wait 15-30 minutes and retry',
            'Advance or withdraw tube 10-20cm and retry',
            'Give 1-2ml air and retry aspiration',
            'Once aspirate obtained: observe appearance',
            'Note color (should be grassy green, clear/colorless, or brown)',
            'Place small amount on pH strip',
            'Wait for color change (follow strip instructions)',
            'Compare to color chart on pH strip container',
            'pH less than or equal to 5.5 = SAFE to use tube (gastric placement)',
            'pH greater than 5.5 = DO NOT USE - reposition or X-ray needed',
            'Return aspirate to patient if pH ≤5.5',
            'Flush tube with water if appropriate',
            'Replace cap/bung securely'
          ],
          communication: [
            'Explain each step to parent and child',
            'Warn may feel slight tugging sensation',
            'If unable to obtain aspirate, explain options',
            'If pH >5.5, explain cannot use tube',
            'Discuss need for X-ray if position unclear',
            'Document clearly and communicate to team'
          ],
          safetyRedFlags: [
            'External tube length changed - tube may have migrated',
            'pH greater than 5.5 - DO NOT USE tube for feeding or medication',
            'Unable to obtain aspirate after all attempts - X-ray required',
            'Using auscultation (whoosh test) - NEVER do this, not safe',
            'Proceeding without position confirmation - potential fatal error',
            'Respiratory distress during aspiration - tube may be in lung'
          ],
          documentation: [
            'Record pH result',
            'Document external tube length',
            'Note appearance of aspirate',
            'Record date and time of check',
            'Document repositioning attempts if made',
            'Sign and print name',
            'If X-ray required, document request and reason'
          ]
        },
        tips: [
          'pH less than or equal to 5.5 confirms gastric placement (acidic stomach)',
          'pH greater than 5.5 could indicate respiratory tract, esophagus, or small bowel',
          'Left lateral position helps aspirate flow to greater curve of stomach',
          'Advancing/withdrawing 10-20cm can move tube into fluid pool',
          '1-2ml air can displace tube slightly to help aspiration',
          'Some medications raise gastric pH - consider timing'
        ],
        warnings: [
          'NEVER use whoosh test (auscultation) - cannot differentiate stomach from lung',
          'pH greater than 5.5 means DO NOT USE - feeding into lung can be fatal',
          'If external length changed, tube has migrated - check position',
          'Cannot aspirate? Do NOT guess position - X-ray required',
          'Respiratory aspirate can look similar to gastric - pH is essential'
        ],
        mnemonics: [
          'pH safe limit: "5.5 or Less = Safe for Gastric Access"',
          'No aspirate? Try: "LEFT side, WAIT, WIGGLE tube (advance/withdraw), puff AIR"',
          'NEVER whoosh: "Whoosh is Worthless - Will Cause Wickedness (deaths)"'
        ],
        scoring: {
          criticalFails: [
            'Did not check pH before using tube',
            'Proceeded with pH greater than 5.5',
            'Did not check external tube length',
            'Used whoosh test instead of pH'
          ],
          marks: [
            { item: 'Checked external tube length', points: 2, domain: 'assessment' },
            { item: 'Correct aspiration technique', points: 2, domain: 'interventions' },
            { item: 'Appropriate repositioning if no aspirate', points: 2, domain: 'interventions' },
            { item: 'Accurate pH interpretation (less than or equal to 5.5 safe)', points: 2, domain: 'interventions' },
            { item: 'Documentation', points: 2, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'ng-2',
        topic: 'ngtubes',
        title: 'NG Tube Medication Administration',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Administer oral medication via NG tube to this 3-year-old child. Demonstrate correct technique including position verification and flushing.',
        equipment: ['Prescribed medication', 'Prescription chart', '50ml catheter-tip syringes (×2)', 'pH indicator strips', 'Cooled boiled water or sterile water', 'Gloves', 'Apron', 'Receiver/bowl', 'Medication pot'],
        checklist: {
          preparation: [
            'Check prescription (9 Rights)',
            'Verify patient identity (3-point check)',
            'Check allergies',
            'Wash hands and put on apron/gloves',
            'Prepare medication in oral form',
            'Draw up appropriate flush volume (5-10ml for children)',
            'Gather all equipment'
          ],
          assessment: [
            'Check NG tube position BEFORE medication',
            'Verify external tube length',
            'Obtain aspirate',
            'Check pH less than or equal to 5.5',
            'Assess child position (sitting upright 30-45°)',
            'Check tube patent (not blocked)'
          ],
          interventions: [
            'Position child upright or semi-upright (30-45°)',
            'Verify tube position confirmed (pH less than or equal to 5.5)',
            'Remove cap/bung from NG tube',
            'Attach syringe to NG tube',
            'FLUSH with 5ml water BEFORE medication',
            'Ensure flush goes through easily (tube patent)',
            'Draw up prepared medication into syringe',
            'Attach medication syringe to NG tube',
            'Administer medication slowly via gravity or gentle push',
            'Do NOT force if resistance felt',
            'FLUSH with 5-10ml water AFTER medication',
            'If multiple medications: flush between each one',
            'Final flush to ensure all medication delivered',
            'Replace cap/bung securely',
            'Keep child upright for 30 minutes post-administration',
            'Dispose of equipment safely',
            'Remove gloves and wash hands'
          ],
          communication: [
            'Explain procedure to child and parent',
            'Warn child about sensations',
            'Involve child where appropriate',
            'Educate parent about why position checking essential',
            'Inform about keeping child upright after',
            'Advise when next medication due'
          ],
          safetyRedFlags: [
            'Not checking tube position before medication - fatal error',
            'pH greater than 5.5 - DO NOT give medication',
            'Tube blocked - do NOT force, may cause tube to dislodge',
            'Child lying flat - aspiration risk',
            'Not flushing between medications - drug interactions/tube blockage',
            'Multiple medications mixed together - may be incompatible'
          ],
          documentation: [
            'Record pH checked and result',
            'Sign medication chart AFTER administration',
            'Document flush volumes given',
            'Note any difficulty or issues',
            'Record child position during administration',
            'Sign and time entry'
          ]
        },
        tips: [
          'ALWAYS check position before EVERY medication or feed',
          'Flush before, between, and after medications',
          'Use liquid formulations where possible',
          'Crushed tablets must be very fine powder and dissolved',
          'Upright positioning reduces aspiration and reflux risk',
          'Never mix multiple medications together'
        ],
        warnings: [
          'Not checking position before each use has caused deaths',
          'Some tablets cannot be crushed (modified release, enteric coated)',
          'Grapefruit juice interacts with many drugs - use water',
          'Lying flat during feeds increases aspiration risk',
          'Never force flush if blocked - tube may have migrated'
        ],
        mnemonics: [
          'NG medication: "Check Position First, Flush Before medication, Flush After"',
          'Keep upright: "30 minutes at 30 degrees minimum"'
        ],
        scoring: {
          criticalFails: [
            'Did not verify tube position before medication',
            'Administered with pH >5.5',
            'Did not flush tube before and after medication',
            'Child lying flat during administration'
          ],
          marks: [
            { item: 'Tube position verified (pH ≤5.5)', points: 3, domain: 'assessment' },
            { item: 'Appropriate positioning (upright/semi-upright)', points: 1, domain: 'preparation' },
            { item: 'Flushed before, between, and after medications', points: 2, domain: 'interventions' },
            { item: 'Medication administered safely', points: 2, domain: 'interventions' },
            { item: 'Documentation and signing chart', points: 2, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'ng-3',
        topic: 'ngtubes',
        title: 'NG Tube Care and Troubleshooting',
        difficulty: 'medium',
        estimatedMinutes: 7,
        candidateInstructions: 'This child has an NG tube in situ. Assess the tube position and security. Explain troubleshooting steps if unable to obtain aspirate.',
        equipment: ['pH indicator strips', '50ml catheter-tip syringe', 'Tape/securing device', 'Scissors', 'Gloves', 'Measurement tape', 'Documentation chart'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain assessment procedure',
            'Wash hands and put on gloves',
            'Position child comfortably',
            'Have equipment ready'
          ],
          assessment: [
            'Check NG tube secured appropriately to cheek',
            'Verify tape not causing pressure or skin damage',
            'Check nostril for redness, bleeding, or necrosis',
            'Measure and document external tube length',
            'Compare to previously documented length',
            'If length changed by >2cm - STOP and escalate',
            'Check tube marking visible at nostril',
            'Assess for signs of tube displacement',
            'Ask child/parent about discomfort or tube issues',
            'Inspect mouth for tube visible in oropharynx (coiled)'
          ],
          interventions: [
            'If tube security compromised: re-secure appropriately',
            'Clean skin before applying new tape',
            'Secure tube to cheek (NOT forehead)',
            'Avoid pressure on nostril',
            'Demonstrate aspiration technique',
            'If unable to aspirate, try troubleshooting:',
            'Reposition child onto LEFT lateral position',
            'Wait 15-30 minutes for gastric contents to settle',
            'Try advancing tube 10-20cm',
            'Try withdrawing tube 10-20cm',
            'Flush with 1-2ml air and retry aspiration',
            'If still no aspirate - X-ray required before use',
            'Never proceed with feed/medication without position confirmation'
          ],
          communication: [
            'Teach parent to recognize tube displacement',
            'Explain importance of checking external length',
            'Educate about when to report concerns',
            'Discuss signs of tube problems (gagging, coughing, distress)',
            'Explain troubleshooting steps',
            'Reassure about safety checks'
          ],
          safetyRedFlags: [
            'External tube length changed >2cm - tube migrated',
            'Tube visible in mouth - coiled in esophagus/throat',
            'Child coughing/gagging when tube flushed - may be in airway',
            'Unable to aspirate after all measures - X-ray needed',
            'Nostril showing pressure necrosis - tube needs repositioning',
            'Tape causing skin breakdown - need alternative securing method'
          ],
          documentation: [
            'Record external tube length',
            'Document tube security and skin integrity',
            'Note troubleshooting attempts made',
            'Record if X-ray required',
            'Document parent education provided',
            'Sign and date entry'
          ]
        },
        tips: [
          'External tube length should be measured and documented at each shift',
          'Change in length >2cm suggests tube migration',
          'Left lateral position best for obtaining aspirate',
          'Flush with air can help dislodge tube into fluid',
          'NG tubes should be re-secured daily to check skin integrity',
          'Check nasal septum for pressure damage regularly'
        ],
        warnings: [
          'Do NOT use tube if external length changed significantly',
          'Nostril pressure can cause necrosis - needs early recognition',
          'Tube coiled in throat = choking risk and wrong position',
          'Cannot aspirate? NEVER guess - X-ray required',
          'Some children remove tubes - never reinsert yourself'
        ],
        mnemonics: [
          'Securing NG tube: "Cheek not forehead, Avoid Nostril pressure, Check skin daily"',
          'Can\'t aspirate? "LEFT, WAIT, WIGGLE, AIR, X-RAY"',
          'Tube migration signs: "Length Changed = Location Changed"'
        ],
        scoring: {
          criticalFails: [
            'Did not measure external tube length',
            'Failed to recognize significant length change',
            'Recommended using tube without position verification',
            'Did not identify pressure damage to nostril'
          ],
          marks: [
            { item: 'Measured and compared external tube length', points: 2, domain: 'assessment' },
            { item: 'Assessed tube security and skin integrity', points: 2, domain: 'assessment' },
            { item: 'Appropriate troubleshooting steps demonstrated', points: 2, domain: 'interventions' },
            { item: 'Clear parent education about tube care', points: 2, domain: 'communication' },
            { item: 'Documentation', points: 2, domain: 'documentation' }
          ]
        }
      },

      // ========== ANTT STATIONS ==========
      {
        id: 'antt-1',
        topic: 'antt',
        title: 'Standard ANTT for IV Medication Administration',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Prepare and administer IV medication using Standard ANTT technique. Identify and protect all Key Parts and Key Sites throughout the procedure.',
        equipment: ['ANTT field/sterile tray', 'IV medication vial', 'Sterile syringe and needle', 'Alcohol wipes', 'IV cannula hub (on patient/manikin)', 'Gloves', 'Apron', 'Sharps bin', 'Hand sanitizer'],
        checklist: {
          preparation: [
            'Perform hand hygiene thoroughly',
            'Put on apron',
            'Gather all equipment on clean tray',
            'Create ANTT field (clean area/sterile tray)',
            'Check medication name, dose, expiry date',
            'Identify Key Parts to be protected',
            'Identify Key Sites to be protected'
          ],
          assessment: [
            'KEY PARTS identified: Syringe tip, needle tip, IV hub connector',
            'KEY SITES identified: IV insertion site, IV hub port',
            'Verify patient identity and check allergies',
            'Assess IV cannula site for patency',
            'Check for signs of phlebitis or infiltration'
          ],
          interventions: [
            'Perform hand hygiene again before ANTT',
            'Put on non-sterile gloves',
            'Open packaging without contaminating Key Parts',
            'Protect syringe tip (do NOT touch)',
            'Clean vial top with alcohol wipe (70% alcohol)',
            'Allow alcohol to dry completely',
            'Draw up medication using non-touch technique',
            'Protect needle/syringe tip throughout',
            'Change needle if required',
            'Clean IV hub (Key Site) with alcohol wipe',
            'Allow alcohol to dry for 30 seconds',
            'Attach syringe to hub without touching Key Parts',
            'Inject medication at appropriate rate',
            'Flush cannula if required',
            'Dispose of sharps immediately',
            'Remove gloves and perform hand hygiene'
          ],
          communication: [
            'Explain procedure to patient and parent',
            'Warn about any sensations',
            'Inform if any discomfort felt they should tell you',
            'Explain Key Parts concept if teaching moment'
          ],
          safetyRedFlags: [
            'Touching Key Parts with non-sterile item - contamination',
            'Not allowing alcohol to dry - inactivates alcohol and stings',
            'Proceeding with visibly contaminated Key Part',
            'Not protecting Key Parts continuously from start to finish',
            'Hub not cleaned for 30 seconds - infection risk'
          ],
          documentation: [
            'Sign medication chart after administration',
            'Document site condition',
            'Record any complications',
            'Note batch number and expiry date'
          ]
        },
        tips: [
          'Key Parts: must stay sterile - if contaminated, causes infection',
          'Key Sites: points of entry that must be protected (e.g., IV insertion site)',
          'Standard ANTT for procedures <20 min with small Key Parts',
          'Non-touch technique: NEVER touch Key Parts, even with gloved hand',
          'Alcohol must dry for 30 seconds to be effective'
        ],
        warnings: [
          'Touching Key Part = contamination = potential bloodstream infection',
          'Wet alcohol doesn\'t kill microorganisms - must dry',
          'Once Key Part contaminated, must start again with new equipment',
          'IV line infections can lead to sepsis - technique is critical'
        ],
        mnemonics: [
          'ANTT: Aseptic Non-Touch Technique',
          'Key Parts: "Parts that if contaminated, cause infection"',
          'Key Sites: "Sites where Key Parts enter patient"',
          'Protection: "From Package to Patient - protect throughout"'
        ],
        scoring: {
          criticalFails: [
            'Touched Key Part with non-sterile item or hand',
            'Did not clean hub before access',
            'Proceeded with contaminated equipment'
          ],
          marks: [
            { item: 'Correct identification of Key Parts and Key Sites', points: 2, domain: 'assessment' },
            { item: 'Non-touch technique maintained throughout', points: 3, domain: 'interventions' },
            { item: 'Appropriate use of alcohol wipes and drying time', points: 2, domain: 'interventions' },
            { item: 'Protected Key Parts from preparation to completion', points: 2, domain: 'interventions' },
            { item: 'Hand hygiene at appropriate points', points: 1, domain: 'preparation' }
          ]
        }
      },

      {
        id: 'antt-2',
        topic: 'antt',
        title: 'Surgical ANTT for Central Line Dressing Change',
        difficulty: 'hard',
        estimatedMinutes: 12,
        candidateInstructions: 'Perform a central venous catheter (CVC) dressing change using Surgical ANTT. Maintain sterile field throughout and protect all Key Parts and Key Sites.',
        equipment: ['Sterile dressing pack', 'Sterile gloves (correct size)', 'Chlorhexidine 2% solution or wipes', 'Sterile transparent dressing', 'Sterile gauze', 'Apron', 'Mask', 'Non-sterile gloves', 'Sharps bin', 'Clinical waste bag'],
        checklist: {
          preparation: [
            'Perform hand hygiene',
            'Explain procedure to patient and parent',
            'Ensure privacy (close curtains)',
            'Position patient comfortably (supine, head turned away)',
            'Put on apron and mask',
            'Gather all equipment before starting',
            'Check sterile pack expiry date and integrity'
          ],
          assessment: [
            'Assess CVC site for signs of infection',
            'Check for redness, swelling, discharge, pain',
            'Verify CVC external length not changed',
            'Identify KEY PARTS: CVC exit site, CVC lumens, sterile gauze/dressing',
            'Identify KEY SITES: CVC insertion site, CVC hubs',
            'Note when dressing last changed'
          ],
          interventions: [
            'Perform hand hygiene',
            'Open sterile pack to create sterile field',
            'Put on non-sterile gloves',
            'Carefully remove old dressing',
            'Inspect site thoroughly',
            'Remove gloves and perform hand hygiene',
            'Put on STERILE gloves using correct technique',
            'Clean site with chlorhexidine using aseptic technique',
            'Start from center and work outward in circular motion',
            'Allow antiseptic to dry completely (30 seconds minimum)',
            'Apply new sterile dressing without touching adhesive or site',
            'Ensure dressing secure and date labeled',
            'Dispose of waste in clinical waste',
            'Remove gloves and perform hand hygiene'
          ],
          communication: [
            'Explain procedure before starting',
            'Warn patient not to touch sterile field',
            'Ask patient to keep still and turn head away',
            'Inform about any sensations during cleaning',
            'Report any concerns about site to senior immediately'
          ],
          safetyRedFlags: [
            'Contamination of sterile field - restart procedure',
            'Touching CVC exit site with non-sterile item',
            'Not wearing sterile gloves for dressing application',
            'Signs of infection at site - requires medical review',
            'CVC length changed - tube may have migrated'
          ],
          documentation: [
            'Document dressing change performed',
            'Record site condition (no redness, swelling, discharge)',
            'Note external CVC length',
            'Document any concerns or abnormalities',
            'Date dressing applied',
            'Sign and print name clearly'
          ]
        },
        tips: [
          'Surgical ANTT for procedures >20 min or with large sterile field',
          'Sterile gloves required when directly touching Key Sites',
          'CVC infections serious - meticulous technique essential',
          'If sterile field contaminated at ANY point - start again',
          'Chlorhexidine 2% is gold standard for CVC site cleaning'
        ],
        warnings: [
          'CVC-related bloodstream infections have high mortality',
          'Never touch CVC exit site or lumens with non-sterile item',
          'If site shows infection signs (redness, discharge, swelling) - escalate',
          'CVC migration can be life-threatening - always check external length',
          'Contaminated sterile field = restart entire procedure with new pack'
        ],
        mnemonics: [
          'Surgical ANTT: "Sterile gloves, Sterile field, Surgical precision"',
          'CVC site cleaning: "Center Outward, Dry completely, Dress Carefully"',
          'Sterile glove donning: "Cuff inside, finger outside" technique'
        ],
        scoring: {
          criticalFails: [
            'Contaminated sterile field and continued',
            'Touched CVC exit site without sterile gloves',
            'Did not allow antiseptic to dry'
          ],
          marks: [
            { item: 'Correct creation and maintenance of sterile field', points: 3, domain: 'interventions' },
            { item: 'Appropriate use of sterile gloves', points: 2, domain: 'interventions' },
            { item: 'Aseptic cleaning technique (center outward)', points: 2, domain: 'interventions' },
            { item: 'Allowed antiseptic to dry completely', points: 1, domain: 'interventions' },
            { item: 'Thorough site assessment', points: 1, domain: 'assessment' },
            { item: 'Complete documentation', points: 1, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'antt-3',
        topic: 'antt',
        title: 'Differentiating Standard vs Surgical ANTT',
        difficulty: 'easy',
        estimatedMinutes: 6,
        candidateInstructions: 'Explain the difference between Standard and Surgical ANTT. Provide examples of when each should be used in paediatric nursing.',
        equipment: ['ANTT guidelines/reference', 'Visual aids showing Key Parts and Key Sites'],
        checklist: {
          preparation: [
            'Review ANTT principles',
            'Understand Key Parts and Key Sites concepts',
            'Know local ANTT policy'
          ],
          assessment: [
            'Can identify Key Parts in various procedures',
            'Can identify Key Sites in various procedures',
            'Can determine which ANTT approach needed',
            'Understands infection risk assessment'
          ],
          interventions: [
            'Explain Standard ANTT criteria:',
            '- Procedure duration <20 minutes',
            '- Small Key Parts (e.g., syringe tip, needle tip)',
            '- Technically simple procedures',
            '- Non-sterile gloves and non-touch technique',
            'Explain Surgical ANTT criteria:',
            '- Procedure duration >20 minutes',
            '- Large or multiple Key Parts',
            '- Complex procedures requiring critical asepsis',
            '- Sterile gloves and sterile field required',
            'Give Standard ANTT examples: IV drug admin, blood cultures, simple dressings',
            'Give Surgical ANTT examples: CVC insertion, complex wound care, catheter insertion'
          ],
          communication: [
            'Clear explanation of Key Parts concept',
            'Clear explanation of Key Sites concept',
            'Explain rationale for choosing ANTT type',
            'Discuss consequences of poor technique',
            'Give practical clinical examples'
          ],
          safetyRedFlags: [
            'Using Standard ANTT when Surgical ANTT required',
            'Not understanding Key Parts/Key Sites concept',
            'Touching Key Parts inappropriately',
            'Not recognizing when technique has been breached'
          ],
          documentation: [
            'Understand documentation requirements for ANTT procedures',
            'Know when to escalate concerns about technique',
            'Record any breaches in aseptic technique'
          ]
        },
        tips: [
          'Standard ANTT: Simple, Short, Small Key Parts',
          'Surgical ANTT: Sterile, Sustained, Serious procedures',
          'Both types protect Key Parts - just different methods',
          'Key Parts must NEVER be touched - this is fundamental',
          'When in doubt, use higher level of asepsis (Surgical ANTT)'
        ],
        warnings: [
          'Wrong ANTT type can lead to healthcare-associated infections',
          'Standard ANTT is NOT less important - just different approach',
          'ALWAYS protect Key Parts regardless of ANTT type',
          'Any breach in technique = contamination = potential infection'
        ],
        mnemonics: [
          'Standard ANTT: "Short Simple Small" (<20 min, simple procedure, small Key Parts)',
          'Surgical ANTT: "Sustained Sterile Serious" (>20 min, sterile field, serious risk)',
          'Key Parts: "If it touches patient or fluid, it\'s Key"'
        ],
        scoring: {
          criticalFails: [
            'Could not explain difference between Standard and Surgical ANTT',
            'Could not identify Key Parts or Key Sites',
            'Gave incorrect examples of when to use each type'
          ],
          marks: [
            { item: 'Clear explanation of Standard ANTT criteria', points: 2, domain: 'interventions' },
            { item: 'Clear explanation of Surgical ANTT criteria', points: 2, domain: 'interventions' },
            { item: 'Correct identification of Key Parts and Key Sites', points: 2, domain: 'assessment' },
            { item: 'Appropriate clinical examples provided', points: 2, domain: 'communication' },
            { item: 'Understanding of infection risk rationale', points: 2, domain: 'assessment' }
          ]
        }
      },

      // ========== INJECTION TECHNIQUE STATIONS ==========
      {
        id: 'inj-1',
        topic: 'injection',
        title: 'IM Injection - Vastus Lateralis Site',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Administer an intramuscular injection to this 18-month-old infant using the vastus lateralis site. Demonstrate correct technique including site selection, needle angle, and safe disposal.',
        equipment: ['Prescribed medication and chart', 'Appropriate syringe (2-3ml)', '23-25G needle (25mm)', 'Alcohol wipes', 'Cotton wool/gauze', 'Sharps bin', 'Gloves', 'Tray'],
        checklist: {
          preparation: [
            'Check prescription and perform 9 Rights',
            'Wash hands thoroughly',
            'Gather all equipment on clean tray',
            'Check medication name, dose, expiry',
            'Draw up medication using aseptic technique',
            'Label syringe if not giving immediately',
            'Check sharps bin available at point of use'
          ],
          assessment: [
            'Introduce self to parent and infant',
            'Verify patient identity (3-point check)',
            'Check allergies',
            'Assess injection site for contraindications',
            'Explain procedure to parent',
            'Position infant appropriately (lying/held by parent)'
          ],
          interventions: [
            'Put on gloves',
            'Identify vastus lateralis muscle (outer thigh)',
            'Locate site: middle third between hip and knee',
            'Clean site with alcohol wipe (circular motion)',
            'Allow alcohol to dry completely',
            'Stretch skin taut with non-dominant hand',
            'Hold syringe like a dart',
            'Insert needle at 90-degree angle with swift, smooth motion',
            'Aspirate briefly (if policy requires)',
            'Inject medication slowly and steadily',
            'Withdraw needle swiftly at same angle',
            'Apply gentle pressure with gauze (do NOT rub)',
            'Dispose of needle IMMEDIATELY in sharps bin WITHOUT resheathing',
            'Comfort infant',
            'Remove gloves and wash hands'
          ],
          communication: [
            'Warn parent about quick scratch sensation',
            'Provide distraction for infant during procedure',
            'Praise infant after procedure',
            'Advise parent about post-injection care',
            'Inform about possible side effects (soreness, redness)',
            'Explain when to seek help (signs of infection)'
          ],
          safetyRedFlags: [
            'Resheathing needle - needlestick injury risk',
            'Wrong angle (not 90°) - medication may not reach muscle',
            'Not allowing alcohol to dry - inactivates medication and stings',
            'Leaving needle on surface - sharps injury risk',
            'Rubbing site after injection - increases pain and bruising'
          ],
          documentation: [
            'Sign prescription chart immediately after administration',
            'Document injection site used',
            'Record time of administration',
            'Note any adverse reactions',
            'Document batch number and expiry date'
          ]
        },
        tips: [
          'Vastus lateralis preferred site for infants/toddlers - large, well-developed muscle',
          'Site location: middle third of outer thigh (divide thigh into thirds)',
          'Always insert at 90° for IM - this ensures medication reaches muscle',
          'Never leave needle on work surface - immediate disposal essential',
          'Sharps bin should be at point of use (within arm\'s reach)'
        ],
        warnings: [
          'NEVER resheath needles - most common cause of needlestick injuries',
          'Gluteal site NOT used in children under 3 years (underdeveloped muscle, sciatic nerve risk)',
          'Alcohol must dry completely - wet alcohol inactivates some vaccines',
          'Never inject into inflamed, scarred, or broken skin'
        ],
        mnemonics: [
          'Vastus lateralis location: "Middle third of outer thigh"',
          'IM injection: "90 degrees to reach the muscle"',
          'Safety: "See sharp, drop sharp" - immediate disposal without resheathing'
        ],
        scoring: {
          criticalFails: [
            'Resheathed needle',
            'Did not dispose of needle immediately',
            'Wrong injection angle (not 90°)',
            'Did not verify patient identity'
          ],
          marks: [
            { item: '9 Rights checked including patient ID', points: 2, domain: 'preparation' },
            { item: 'Correct site selection and identification', points: 2, domain: 'interventions' },
            { item: 'Correct 90° angle technique', points: 2, domain: 'interventions' },
            { item: 'Safe immediate needle disposal', points: 2, domain: 'interventions' },
            { item: 'Clear communication with parent', points: 1, domain: 'communication' },
            { item: 'Accurate documentation', points: 1, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'inj-2',
        topic: 'injection',
        title: 'Subcutaneous Injection Technique',
        difficulty: 'medium',
        estimatedMinutes: 7,
        candidateInstructions: 'Administer a subcutaneous injection (insulin) to this 10-year-old child with diabetes. Demonstrate correct technique including site selection, rotation, and angle.',
        equipment: ['Insulin pen or vial and insulin syringe', 'Alcohol wipes', 'Cotton wool', 'Sharps bin', 'Gloves', 'Injection site rotation chart'],
        checklist: {
          preparation: [
            'Check prescription and 9 Rights',
            'Wash hands thoroughly',
            'Check insulin type, dose, and expiry date',
            'Ensure insulin at room temperature (if refrigerated, remove 30 min prior)',
            'Inspect insulin for clarity (clear/cloudy as expected)',
            'Draw up correct dose or dial pen correctly',
            'Double-check dose',
            'Have sharps bin at point of use'
          ],
          assessment: [
            'Introduce self and verify patient identity',
            'Check allergies',
            'Check blood glucose level if required',
            'Review injection site rotation chart',
            'Select appropriate injection site',
            'Assess site for lumps (lipohypertrophy), redness, or bruising',
            'Avoid sites with lipohypertrophy'
          ],
          interventions: [
            'Put on gloves',
            'Clean injection site with alcohol wipe',
            'Allow alcohol to dry',
            'Pinch up skin fold with non-dominant hand',
            'Hold syringe/pen like a dart',
            'Insert needle at 45-90° angle (depending on needle length and child size)',
            'Release skin pinch after insertion',
            'Inject medication slowly',
            'Count to 5 before withdrawing (ensures full dose delivery)',
            'Withdraw needle smoothly',
            'Apply gentle pressure if needed (do NOT rub)',
            'Dispose of needle immediately in sharps bin',
            'Remove gloves and wash hands',
            'Update site rotation chart'
          ],
          communication: [
            'Explain procedure in age-appropriate language',
            'Involve child in site selection if appropriate',
            'Encourage child participation (older children may self-inject)',
            'Praise child for cooperation',
            'Discuss importance of site rotation',
            'Educate about recognizing lipohypertrophy',
            'Review timing in relation to meals'
          ],
          safetyRedFlags: [
            'Not rotating injection sites - causes lipohypertrophy',
            'Injecting into lipohypertrophy - erratic absorption',
            'Not waiting 5 seconds before withdrawal - medication leakage',
            'Rubbing site after injection - affects absorption',
            'Using cold insulin - painful and poor absorption'
          ],
          documentation: [
            'Sign prescription chart',
            'Document injection site used on rotation chart',
            'Record blood glucose if checked',
            'Note time of administration',
            'Document any site abnormalities'
          ]
        },
        tips: [
          'SC injection sites: Abdomen, outer thighs, outer upper arms, buttocks',
          'Abdomen absorption fastest, thighs slowest - be consistent',
          '45° angle for longer needles or thin children, 90° for shorter needles',
          'Site rotation prevents lipohypertrophy (lumpy areas with poor absorption)',
          'Count to 5-10 after injection before removing needle'
        ],
        warnings: [
          'Lipohypertrophy causes unpredictable insulin absorption - avoid these sites',
          'Site rotation is essential - same site daily causes tissue damage',
          'Cold insulin is painful and poorly absorbed',
          'Never inject into moles, scars, or lumpy areas'
        ],
        mnemonics: [
          'SC sites: "Belly, Bum, Thighs, Arms" (BBTA)',
          'SC angle: "45 if thin, 90 if not" (depends on needle length)',
          'After injection: "Wait 5, Don\'t Drive" (count 5 seconds, don\'t rub site)'
        ],
        scoring: {
          criticalFails: [
            'Injected into lipohypertrophy site',
            'Did not check insulin type/dose',
            'Wrong injection technique (e.g., injected into muscle)',
            'Did not rotate sites'
          ],
          marks: [
            { item: 'Correct site selection and rotation', points: 2, domain: 'assessment' },
            { item: 'Appropriate angle (45-90° based on factors)', points: 2, domain: 'interventions' },
            { item: 'Waited 5+ seconds before needle withdrawal', points: 1, domain: 'interventions' },
            { item: 'Updated site rotation chart', points: 1, domain: 'documentation' },
            { item: 'Patient education about site rotation', points: 2, domain: 'communication' },
            { item: 'Safe disposal and documentation', points: 2, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'inj-3',
        topic: 'injection',
        title: 'Needle Stick Injury Management',
        difficulty: 'medium',
        estimatedMinutes: 6,
        candidateInstructions: 'You have sustained a needlestick injury while administering an injection. Demonstrate immediate first aid and explain the steps you would take following the injury.',
        equipment: ['Running water and soap', 'Incident form', 'Occupational health contact details', 'Patient notes (source patient information)'],
        checklist: {
          preparation: [
            'Remain calm',
            'Put patient safety first (secure sharp, ensure patient safe)',
            'Note time of injury',
            'Note circumstances of injury'
          ],
          assessment: [
            'Assess depth and location of injury',
            'Assess source patient if known',
            'Note source patient bloodborne virus status if known',
            'Consider source patient risk factors'
          ],
          interventions: [
            'DO NOT squeeze or suck wound',
            'Encourage bleeding by gentle pressure around wound',
            'Wash wound thoroughly under running water',
            'Use soap and water for at least 5 minutes',
            'Dry and cover with waterproof dressing',
            'Dispose of sharp safely if not already done',
            'Report to senior nurse/person in charge immediately',
            'Contact occupational health urgently (within 1 hour)',
            'Complete incident report form',
            'Attend A&E or occupational health as directed'
          ],
          communication: [
            'Inform senior nurse immediately',
            'Report to occupational health within 1 hour',
            'Explain incident clearly',
            'Provide source patient details if known',
            'Follow occupational health instructions',
            'Inform own GP if advised',
            'Attend all follow-up appointments'
          ],
          safetyRedFlags: [
            'Delaying occupational health contact - PEP (post-exposure prophylaxis) time-critical',
            'Not knowing source patient status - affects management',
            'Squeezing or sucking wound - can increase infection risk',
            'Not completing incident report - legal and safety requirement',
            'Not following up - may need blood tests and vaccinations'
          ],
          documentation: [
            'Complete incident report form fully',
            'Document: Date, time, location, activity, how injury occurred',
            'Document source patient details if known',
            'Record immediate first aid given',
            'Document occupational health contact and advice',
            'Keep record of all follow-up appointments'
          ]
        },
        tips: [
          'PEP for HIV most effective if started within 1 hour (max 72 hours)',
          'Hepatitis B vaccination protects most healthcare workers',
          'Most needlestick injuries do NOT result in infection',
          'Prevention is key - never resheath needles',
          'Occupational health contact within 1 hour is crucial'
        ],
        warnings: [
          'DO NOT squeeze or suck wound - may increase infection risk',
          'Contact occupational health within 1 hour - PEP is time-critical',
          'Source patient testing requires consent - occupational health will arrange',
          'You may need time off work or adjustments - follow occupational health advice',
          'Needlestick injuries are often due to unsafe practices - reflect and learn'
        ],
        mnemonics: [
          'Needlestick first aid: "WASH" - Wound care (encourage bleeding), Alert senior, Seek occupational health within 1 Hour, Help yourself by documenting',
          'DO NOT: "Suck, Squeeze, or Stall" (don\'t suck wound, squeeze wound, or stall reporting)'
        ],
        scoring: {
          criticalFails: [
            'Did not wash wound under running water',
            'Did not contact occupational health urgently',
            'Squeezed or sucked the wound',
            'Did not complete incident report'
          ],
          marks: [
            { item: 'Immediate wound first aid (encourage bleeding, wash)', points: 2, domain: 'interventions' },
            { item: 'Contacted occupational health urgently (within 1 hour)', points: 3, domain: 'communication' },
            { item: 'Reported to senior nurse immediately', points: 2, domain: 'communication' },
            { item: 'Completed incident report fully', points: 2, domain: 'documentation' },
            { item: 'Explained follow-up requirements', points: 1, domain: 'communication' }
          ]
        }
      },

      // ========== DETERIORATING CHILD STATIONS ==========
      {
        id: 'det-1',
        topic: 'deteriorating',
        title: 'PEWS Score Calculation and Escalation',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Calculate the PEWS score for this 4-year-old child with respiratory symptoms. Determine if escalation is required and communicate using SBAR.',
        equipment: ['PEWS chart', 'Observation chart with vital signs', 'Stethoscope', 'Pulse oximeter', 'SBAR communication tool', 'Phone/call bell'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Wash hands',
            'Gather patient notes and observation chart',
            'Have PEWS chart available',
            'Ensure emergency equipment nearby'
          ],
          assessment: [
            'Review recent vital signs systematically',
            'Assess BEHAVIOUR: Playing/appropriate vs Sleeping/irritable/lethargic',
            'Score behaviour 0-3',
            'Assess CARDIOVASCULAR: HR, CRT, color',
            'Score cardiovascular 0-3',
            'Assess RESPIRATORY: RR, work of breathing, oxygen therapy',
            'Score respiratory 0-3',
            'Calculate TOTAL PEWS score',
            'Compare to escalation thresholds',
            'Identify if score triggers escalation',
            'Assess trend - is child improving or deteriorating?',
            'Note concerning signs not captured by PEWS'
          ],
          interventions: [
            'Document PEWS score on chart',
            'If score triggers escalation: ACT IMMEDIATELY',
            'Call for senior nurse/doctor as per protocol',
            'Prepare SBAR handover',
            'Continue monitoring closely',
            'Implement any immediate interventions needed',
            'Increase observation frequency if required'
          ],
          communication: [
            'Use SBAR framework for escalation',
            'SITUATION: State concern clearly and urgently',
            'BACKGROUND: Provide relevant history',
            'ASSESSMENT: Present PEWS score and observations',
            'RECOMMENDATION: State what you think is needed',
            'Explain to parent why escalating',
            'Reassure child and parent',
            'Document escalation and response'
          ],
          safetyRedFlags: [
            'PEWS ≥5: Immediate senior review required',
            'PEWS increase by 2+ points: Urgent escalation',
            'Respiratory score 3: Critical - immediate action',
            'Downplaying concerns - always escalate if worried',
            'Delaying escalation - minutes matter'
          ],
          documentation: [
            'Record PEWS score on observation chart',
            'Document time score calculated',
            'Note escalation made (who, when, response)',
            'Record any interventions implemented',
            'Document parent discussion'
          ]
        },
        tips: [
          'PEWS is objective tool to identify deterioration early',
          'Score ≥5 requires immediate senior review',
          'Increase of 2+ points in score requires urgent escalation',
          'Trust your gut - if child looks unwell, escalate even if PEWS not triggered',
          'PEWS does not replace clinical judgement - it supports it'
        ],
        warnings: [
          'Never delay escalation waiting for "a bit longer" - deterioration rapid in children',
          'PEWS trigger ignored = potential cardiac arrest',
          'Some sick children have deceptively "normal" PEWS - always consider whole picture',
          'Documenting PEWS without acting on triggers is negligent'
        ],
        mnemonics: [
          'PEWS components: "BCR" - Behaviour, Cardiovascular, Respiratory',
          'Escalation: "5 is High, 2 Up is Action Now" (Score ≥5 or increase ≥2)'
        ],
        scoring: {
          criticalFails: [
            'Did not calculate PEWS score correctly',
            'Failed to escalate when triggered',
            'Delayed escalation inappropriately'
          ],
          marks: [
            { item: 'Accurate PEWS calculation (all 3 components)', points: 3, domain: 'assessment' },
            { item: 'Recognized escalation trigger', points: 2, domain: 'assessment' },
            { item: 'Immediate appropriate escalation', points: 2, domain: 'interventions' },
            { item: 'Effective SBAR communication', points: 2, domain: 'communication' },
            { item: 'Documentation', points: 1, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'det-2',
        topic: 'deteriorating',
        title: 'ABCDE Assessment of Unwell Child',
        difficulty: 'hard',
        estimatedMinutes: 10,
        candidateInstructions: 'Perform a systematic ABCDE assessment on this 3-year-old who has become increasingly unwell over the past hour. Identify problems and take appropriate action.',
        equipment: ['Stethoscope', 'Pulse oximeter', 'BP cuff', 'Thermometer', 'Torch', 'Oxygen', 'Suction', 'Watch', 'Emergency call bell'],
        checklist: {
          preparation: [
            'Approach safely',
            'Wash hands/use gel',
            'Introduce self briefly',
            'Call for help if child appears critically unwell',
            'Ensure emergency equipment available',
            'Position child appropriately'
          ],
          assessment: [
            'A - AIRWAY: Check if patent and maintainable',
            'A - Look for obstruction signs (stridor, see-saw breathing)',
            'A - Listen for noisy breathing',
            'A - If airway compromised: STOP and manage immediately',
            'B - BREATHING: Assess respiratory effort',
            'B - Count RR for 60 seconds',
            'B - Observe work of breathing (recession, grunting, nasal flaring)',
            'B - Auscultate chest',
            'B - Apply pulse oximeter - check SpO2',
            'B - If breathing inadequate: Give oxygen, call for help',
            'C - CIRCULATION: Palpate pulse (rate, rhythm, volume)',
            'C - Assess CRT and peripheral perfusion',
            'C - Check BP if appropriate',
            'C - Assess color (pale, mottled, cyanosed)',
            'C - Feel peripheries (warm/cool)',
            'C - If circulation compromised: Call for help urgently',
            'D - DISABILITY: Assess consciousness (AVPU)',
            'D - Check pupil size and reaction',
            'D - Assess tone and movement',
            'D - Check blood glucose if available',
            'E - EXPOSURE: Check temperature',
            'E - Look for rash (non-blanching?)',
            'E - Examine for injury/surgical cause',
            'E - Maintain dignity and warmth'
          ],
          interventions: [
            'Treat problems as you find them - do NOT wait',
            'Open airway if needed (head tilt-chin lift)',
            'Give high-flow oxygen if SpO2 <92% or respiratory distress',
            'Call for senior help IMMEDIATELY if red flags',
            'Position child for optimal airway/breathing',
            'Keep child calm (parent nearby)',
            'Prepare for deterioration',
            'Document all findings'
          ],
          communication: [
            'Brief, focused communication with child/parent',
            'Call for help early using emergency call',
            'Use SBAR when senior arrives',
            'Clearly state urgency level',
            'Keep parent informed throughout',
            'Reassure child in age-appropriate way'
          ],
          safetyRedFlags: [
            'Airway obstruction - IMMEDIATE emergency',
            'Silent chest - pre-arrest sign',
            'Grunting respirations - severe respiratory distress',
            'Weak/absent pulse - cardiac arrest imminent',
            'Mottled/blue skin - shock/poor perfusion',
            'Unresponsive to pain (AVPU = U) - critical',
            'Non-blanching rash - meningococcal sepsis?'
          ],
          documentation: [
            'Record full ABCDE assessment findings',
            'Document time of assessment',
            'Note all interventions performed',
            'Record who escalated to and when',
            'Document parent communication'
          ]
        },
        tips: [
          'ABCDE approach is systematic and life-saving',
          'ALWAYS assess and treat in order: A -> B -> C -> D -> E',
          'Treat life-threatening problems IMMEDIATELY before moving to next step',
          'Call for help early - don\'t wait until child arrests',
          'Airway and breathing always take priority'
        ],
        warnings: [
          'Never complete full assessment before treating airway problem',
          'Silent chest is worse than wheeze - means minimal air entry',
          'Hypotension is LATE sign in children - child may be in shock with normal BP',
          'Grunting is serious - not just "noisy breathing"'
        ],
        mnemonics: [
          'ABCDE: Airway, Breathing, Circulation, Disability (neuro), Exposure (temp/wounds)',
          'AVPU: Alert, Voice, Pain, Unresponsive',
          'Assessment priority: "Air Before Blood Before Brain" (ABC order critical)'
        ],
        scoring: {
          criticalFails: [
            'Did not follow ABCDE order',
            'Failed to treat life-threatening problem before progressing',
            'Did not call for help when indicated',
            'Missed critical red flag sign'
          ],
          marks: [
            { item: 'Systematic ABCDE approach followed', points: 3, domain: 'assessment' },
            { item: 'Treated problems as found (not waiting)', points: 2, domain: 'interventions' },
            { item: 'Recognized all red flags', points: 2, domain: 'assessment' },
            { item: 'Appropriate escalation/called for help', points: 2, domain: 'communication' },
            { item: 'Complete documentation', points: 1, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'det-3',
        topic: 'deteriorating',
        title: 'Recognizing Sepsis Red Flags',
        difficulty: 'medium',
        estimatedMinutes: 7,
        candidateInstructions: 'This 18-month-old has been unwell for 12 hours with fever. Assess for signs of sepsis and explain the red flag features requiring urgent escalation.',
        equipment: ['Thermometer', 'Pulse oximeter', 'Watch', 'Observation chart', 'Sepsis screening tool', 'Emergency call bell'],
        checklist: {
          preparation: [
            'Introduce self to parent',
            'Wash hands',
            'Gather recent observation history',
            'Have sepsis screening tool ready',
            'Be aware of sepsis 6 protocol'
          ],
          assessment: [
            'Assess BEHAVIOUR: Lethargic? Not responding normally?',
            'Check if child rousable/interacting appropriately',
            'Assess APPEARANCE: Mottled/ashen/cyanosed skin?',
            'Look for non-blanching rash',
            'Assess BREATHING: Tachypnoea? Increased work?',
            'Check oxygen saturations',
            'Assess CIRCULATION: Tachycardia?',
            'Check CRT >2 seconds?',
            'Feel peripheries - cold?',
            'Assess HYDRATION: Reduced urine output?',
            'Check skin turgor and mucous membranes',
            'Review temperature - fever >38°C or hypothermia <36°C?',
            'Ask parent: "Does your child seem different to you?"',
            'Apply sepsis screening criteria for age',
            'Identify any RED FLAGS present'
          ],
          interventions: [
            'If red flags present: Call for help IMMEDIATELY',
            'Do not wait - sepsis is time-critical emergency',
            'Commence sepsis 6 pathway if trained',
            'Give high-flow oxygen if any breathing concerns',
            'Keep child with parent for comfort',
            'Prepare for rapid deterioration',
            'Ensure emergency equipment ready'
          ],
          communication: [
            'Escalate urgently using SBAR',
            'State "I am concerned about sepsis" clearly',
            'Communicate specific red flags identified',
            'Explain to parent why escalating urgently',
            'Keep parent informed throughout',
            'Document all concerns clearly'
          ],
          safetyRedFlags: [
            'RED FLAGS (UNDER 5): Appears ill to healthcare professional',
            'Non-blanching rash',
            'Objective evidence of altered mental state',
            'Tachycardia',
            'Reduced skin turgor',
            'Age <3 months with temp ≥38°C',
            'RED FLAGS (OVER 5): Same as above plus: Rigors, New altered mental state, Respiratory rate raised for age, Immune compromise'
          ],
          documentation: [
            'Complete sepsis screening tool',
            'Document all red flags identified',
            'Record vital signs',
            'Note time of escalation and to whom',
            'Document parent concerns',
            'Record interventions commenced'
          ]
        },
        tips: [
          'Sepsis can progress to septic shock rapidly in children',
          'Red flags require IMMEDIATE medical review',
          'Parent concern that "child not themselves" is significant',
          'Non-blanching rash + fever = meningococcal sepsis until proven otherwise',
          'Sepsis 6 should be completed within 1 hour of recognition'
        ],
        warnings: [
          'Never send parent away with "come back if worse" if red flags present',
          'Sepsis kills rapidly - minutes to hours',
          'Children can look relatively well then crash suddenly',
          'If you\'re worried about sepsis, escalate immediately - better false alarm than missed sepsis'
        ],
        mnemonics: [
          'Sepsis 6: "3 In, 3 Out within 1 Hour" (Oxygen, Fluids, Antibiotics IN; Blood cultures, Lactate, Urine output OUT)',
          'RED FLAGS: "Rash (non-blanching), Extremities cold, Decreased urine, Funny behavior (altered), Looks ill to me, Added tachycardia, Going fast (tachypnoea), Skin turgor reduced"'
        ],
        scoring: {
          criticalFails: [
            'Failed to identify red flag sepsis signs',
            'Did not escalate urgently',
            'Dismissed parent concerns about child being "different"'
          ],
          marks: [
            { item: 'Systematic sepsis assessment', points: 2, domain: 'assessment' },
            { item: 'Identified all red flags present', points: 3, domain: 'assessment' },
            { item: 'Immediate urgent escalation', points: 2, domain: 'communication' },
            { item: 'Parent education and communication', points: 2, domain: 'communication' },
            { item: 'Complete documentation', points: 1, domain: 'documentation' }
          ]
        }
      },

      // ========== POSITIONING & THERAPEUTIC HOLDING STATIONS ==========
      {
        id: 'pos-1',
        topic: 'positioning',
        title: 'Therapeutic Holding for Venepuncture',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Demonstrate appropriate therapeutic holding technique for a 4-year-old requiring venepuncture. Discuss consent, assent, and alternatives to holding.',
        equipment: ['Age-appropriate distraction toys', 'Topical anaesthetic cream', 'Comfort positioning aids (pillows)', 'Parent present', 'Second nurse available'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain procedure in age-appropriate language',
            'Gain consent from parent for procedure',
            'Gain assent from child',
            'Discuss therapeutic holding with parent',
            'Assess child anxiety and cooperation level',
            'Ensure parent understands they comfort, not restrain',
            'Identify second nurse to assist with holding if needed'
          ],
          assessment: [
            'Assess child developmental level',
            'Identify previous experiences with procedures',
            'Assess child pain/anxiety using appropriate tool',
            'Determine if holding necessary or avoidable',
            'Consider alternatives: distraction, preparation, play therapy',
            'Assess topical anaesthesia applied and working'
          ],
          interventions: [
            'Attempt distraction techniques first',
            'Use play therapy/explanation with visual aids',
            'Give child choices where possible (which arm)',
            'Position child comfortably (sitting on parent lap or bed)',
            'Parent positioned for comfort role (not restraint)',
            'If holding needed: use minimal necessary restriction',
            'Hold limb securely but gently',
            'Avoid holding over joints',
            'Second nurse stabilizes arm for venepuncture',
            'Maintain child dignity throughout',
            'Praise child during and after procedure',
            'Allow child to express feelings'
          ],
          communication: [
            'Speak directly to child throughout',
            'Be honest about sensation ("sharp scratch")',
            'Never lie or use threatening language',
            'Explain to parent their role (cuddle, not hold down)',
            'Reassure child constantly',
            'Praise cooperation and bravery',
            'Debrief with child and parent after',
            'Provide comfort item/reward if appropriate'
          ],
          safetyRedFlags: [
            'Excessive force used - risk of injury',
            'Parent holding child against will - damages trust',
            'Not gaining assent from child - ethical concern',
            'Lying about pain - destroys trust permanently',
            'Using holding as first resort - should be last',
            'Restraining without clinical need - becomes restraint not holding'
          ],
          documentation: [
            'Document consent and assent obtained',
            'Record therapeutic holding used',
            'Note who held child and technique used',
            'Document alternatives attempted first',
            'Record child response to procedure',
            'Note any distress or concerns'
          ]
        },
        tips: [
          'Therapeutic holding is LAST resort - try preparation, distraction, topical anaesthesia first',
          'Parents comfort, staff hold - preserves parent-child trust',
          'Always gain assent from child where developmentally appropriate',
          'Minimal necessary restriction - enough for safety, not more',
          'Holding becomes restraint if excessive force or for staff convenience'
        ],
        warnings: [
          'Never use excessive force - can cause physical injury',
          'Parent restraining child damages parent-child relationship',
          'Therapeutic holding without consent/assent is restraint',
          'Must be in child best interest and last resort',
          'Document thoroughly - legal and safeguarding implications'
        ],
        mnemonics: [
          'Before holding: "PREP" - Preparation, Reduce anxiety, Explain, Play therapy',
          'During holding: "MINIMAL" - Minimum force, Inform constantly, No joints held, Involve child, Maintain dignity, Always last resort, Love and reassure'
        ],
        scoring: {
          criticalFails: [
            'Did not gain consent from parent',
            'Did not attempt alternatives before holding',
            'Used excessive force',
            'Parent forced to restrain child'
          ],
          marks: [
            { item: 'Consent and assent appropriately gained', points: 2, domain: 'preparation' },
            { item: 'Alternatives attempted (distraction, explanation)', points: 2, domain: 'assessment' },
            { item: 'Minimal necessary holding technique', points: 2, domain: 'interventions' },
            { item: 'Parent positioned for comfort not restraint', points: 2, domain: 'interventions' },
            { item: 'Honest, age-appropriate communication', points: 1, domain: 'communication' },
            { item: 'Thorough documentation', points: 1, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'pos-2',
        topic: 'positioning',
        title: 'Positioning for Lumbar Puncture',
        difficulty: 'medium',
        estimatedMinutes: 7,
        candidateInstructions: 'Position this 6-month-old infant for lumbar puncture. Demonstrate correct positioning while maintaining airway safety.',
        equipment: ['Clean procedure trolley', 'Pillow or rolled towel', 'Monitoring equipment', 'Oxygen and suction available'],
        checklist: {
          preparation: [
            'Introduce self to parent',
            'Explain procedure and positioning to parent',
            'Gain consent from parent',
            'Wash hands thoroughly',
            'Ensure emergency equipment available',
            'Position bed/trolley at appropriate height',
            'Ensure adequate lighting',
            'Have second person to assist'
          ],
          assessment: [
            'Assess infant baseline observations',
            'Check infant not recently fed (aspiration risk)',
            'Assess for contraindications (raised ICP signs)',
            'Note any breathing difficulties',
            'Assess skin integrity at positioning sites'
          ],
          interventions: [
            'Position infant in LATERAL position (on side)',
            'Draw knees up towards chest (fetal position)',
            'Flex head forward gently',
            'Support head with one hand',
            'Hold knees with other hand',
            'Keep spine curved and flexed',
            'Maintain position firmly but gently',
            'DO NOT over-flex neck (airway compromise risk)',
            'Ensure infant can breathe freely',
            'Monitor oxygen saturation continuously',
            'Watch for breathing difficulties',
            'Maintain position throughout procedure',
            'Talk soothingly to infant',
            'Release immediately if airway compromised'
          ],
          communication: [
            'Explain positioning rationale to parent',
            'Warn parent infant may cry',
            'Reassure throughout procedure',
            'Communicate with doctor performing LP',
            'Alert immediately if infant distress',
            'Update parent on progress'
          ],
          safetyRedFlags: [
            'Over-flexion of neck - airway obstruction risk',
            'Desaturation during procedure - STOP immediately',
            'Infant not breathing freely - release and reassess',
            'Excessive crying/distress - may indicate pain or compromise',
            'Cyanosis - immediate emergency'
          ],
          documentation: [
            'Document positioning technique used',
            'Record monitoring during procedure',
            'Note any difficulties or concerns',
            'Document infant tolerance of position',
            'Record vital signs before, during, after'
          ]
        },
        tips: [
          'Lateral fetal position opens lumbar spaces for LP',
          'NEVER over-flex neck - can obstruct airway in infants',
          'Continuous monitoring essential - SpO2, breathing, color',
          'Position should be firm enough to maintain but allow breathing',
          'Have suction and oxygen immediately available'
        ],
        warnings: [
          'Neck over-flexion in infants can cause airway obstruction and death',
          'Monitor breathing constantly - infants cannot tolerate prolonged flexion',
          'Stop immediately if any airway compromise',
          'Never proceed if infant not breathing freely'
        ],
        mnemonics: [
          'LP position: "C-Curve Spine, Open Line" (curved spine opens spaces, but keep airway open)',
          'Safety: "Never Flex neck Excessively" - NFE rule'
        ],
        scoring: {
          criticalFails: [
            'Over-flexed neck compromising airway',
            'Did not monitor breathing/SpO2',
            'Proceeded despite infant distress/desaturation'
          ],
          marks: [
            { item: 'Correct lateral fetal position', points: 2, domain: 'interventions' },
            { item: 'Appropriate neck flexion (NOT over-flexed)', points: 3, domain: 'interventions' },
            { item: 'Continuous monitoring of breathing and SpO2', points: 2, domain: 'interventions' },
            { item: 'Clear communication with parent', points: 1, domain: 'communication' },
            { item: 'Recognition of safety concerns', points: 2, domain: 'assessment' }
          ]
        }
      },

      {
        id: 'pos-3',
        topic: 'positioning',
        title: 'Safe Positioning and Handling Principles',
        difficulty: 'easy',
        estimatedMinutes: 6,
        candidateInstructions: 'Discuss the principles of safe positioning and therapeutic holding in children. Explain when holding becomes restraint and legal/ethical considerations.',
        equipment: ['Information leaflet', 'Documentation examples', 'Hospital policy reference'],
        checklist: {
          preparation: [
            'Understand local therapeutic holding policy',
            'Know difference between holding and restraint',
            'Be aware of legal frameworks',
            'Understand children\'s rights',
            'Know escalation procedures'
          ],
          assessment: [
            'Can procedure be delayed until child more cooperative?',
            'Has child been adequately prepared?',
            'Are there alternatives to holding?',
            'Is holding in child best interest?',
            'Is parent informed and consenting?'
          ],
          interventions: [
            'ALWAYS try alternatives first:',
            '- Age-appropriate preparation',
            '- Play therapy and demonstration',
            '- Distraction techniques',
            '- Topical anaesthesia where appropriate',
            '- Giving child choices and control',
            'Therapeutic holding only if:',
            '- In child best interest',
            '- Clinically necessary',
            '- Last resort after alternatives tried',
            '- Minimum force necessary',
            '- Shortest duration possible',
            'Holding becomes RESTRAINT if:',
            '- Excessive force used',
            '- Not in child best interest',
            '- For staff convenience',
            '- No consent/assent obtained',
            '- Alternatives not tried'
          ],
          communication: [
            'Explain difference to parents: holding vs restraint',
            'Discuss parent role (comfort not restraint)',
            'Be honest with child about what will happen',
            'Debrief with child and family after',
            'Document thoroughly and accurately'
          ],
          safetyRedFlags: [
            'Using holding routinely without trying alternatives',
            'Excessive force causing injury',
            'Child extremely distressed without clinical emergency',
            'Parent forced to restrain against wishes',
            'No documentation of decision-making'
          ],
          documentation: [
            'Document alternatives attempted',
            'Record rationale for therapeutic holding',
            'Note consent and assent status',
            'Document technique used and who involved',
            'Record child response and any concerns',
            'Follow local policy for reporting/review'
          ]
        },
        tips: [
          'Therapeutic holding is clinical intervention requiring consent',
          'Always last resort after alternatives exhausted',
          'Minimum necessary force for shortest necessary time',
          'Parents comfort, staff hold - preserves trust',
          'Thorough documentation protects child, family, and staff'
        ],
        warnings: [
          'Restraint without legal justification is assault',
          'Excessive force can cause physical and psychological harm',
          'Poor practice damages trust and future healthcare engagement',
          'Inadequate documentation has legal implications'
        ],
        mnemonics: [
          'HOLDING principles: "Help child, Only if needed, Last resort, Dignity maintained, Informed consent, No excessive force, Gentle minimal restriction"',
          'When it\'s RESTRAINT: "Excessive force, No consent, Damage to child, Staff convenience"'
        ],
        scoring: {
          criticalFails: [
            'Could not differentiate holding from restraint',
            'Did not understand legal/ethical issues',
            'Suggested holding as first-line approach'
          ],
          marks: [
            { item: 'Clear understanding of therapeutic holding principles', points: 3, domain: 'assessment' },
            { item: 'Identified when holding becomes restraint', points: 2, domain: 'assessment' },
            { item: 'Described alternatives to holding', points: 2, domain: 'interventions' },
            { item: 'Explained consent and documentation requirements', points: 2, domain: 'communication' },
            { item: 'Demonstrated awareness of child rights', points: 1, domain: 'preparation' }
          ]
        }
      },

      // ========== PERIOPERATIVE CARE STATIONS ==========
      {
        id: 'peri-1',
        topic: 'perioperative',
        title: 'Pre-Operative Fasting Assessment',
        difficulty: 'easy',
        estimatedMinutes: 6,
        candidateInstructions: 'Assess this 4-year-old child scheduled for elective surgery at 10am. Verify fasting status and educate the parent about NPO guidelines.',
        equipment: ['Pre-operative checklist', 'Patient notes', 'Fasting guideline reference', 'Pen'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Verify patient identity (3-point check)',
            'Check consent form signed',
            'Review surgical procedure scheduled',
            'Note scheduled surgery time'
          ],
          assessment: [
            'Ask when child last ate solid food',
            'Ask when child last had formula/milk',
            'Ask when child last had clear fluids',
            'Check type of fluids consumed',
            'Verify child has not chewed gum',
            'Ask about any sweets/snacks given',
            'Assess child hydration status',
            'Note any difficulty with fasting'
          ],
          interventions: [
            'Apply 2-4-6 fasting rule for children over 6 months',
            'Verify clear fluids allowed up to 2 hours pre-op',
            'Verify breast milk allowed up to 4 hours pre-op',
            'Verify formula/solid food allowed up to 6 hours pre-op',
            'Check fasting times meet requirements',
            'Document last oral intake (time and type)',
            'If fasting breached, inform anaesthetist immediately',
            'Apply NPO sign to bed/cot if required'
          ],
          communication: [
            'Explain reason for fasting (aspiration risk)',
            'Educate parent on 2-4-6 rule',
            'Clarify what counts as clear fluids (water, dilute squash)',
            'Explain what is NOT allowed (milk, juice with pulp, chewing gum)',
            'Reassure about child safety',
            'Discuss distraction strategies for hungry child',
            'Inform when child can eat/drink post-operatively'
          ],
          safetyRedFlags: [
            'Fasting times not met - surgery must be delayed',
            'Parent unclear about what was consumed - clarify urgently',
            'Child given food/drink within fasting period - inform anaesthetist',
            'Chewing gum consumed - counts as solid food'
          ],
          documentation: [
            'Record last food intake (time and type)',
            'Record last fluid intake (time and type)',
            'Document fasting compliance verified',
            'Note any fasting breach and escalation',
            'Sign pre-operative checklist'
          ]
        },
        tips: [
          '2-4-6 rule: Clear fluids 2hrs, Breast milk 4hrs, Formula/Food 6hrs',
          'Clear fluids: water, dilute squash (NOT milk, juice with pulp, fizzy drinks)',
          'Chewing gum counts as solid food - stimulates gastric secretions',
          'Infants under 6 months may have different guidelines - check policy'
        ],
        warnings: [
          'Never proceed if fasting breached - aspiration risk during anaesthesia',
          'Some medications need to be given with small sips of water - check with anaesthetist',
          'Prolonged fasting can cause hypoglycaemia - especially in diabetic children',
          'Clear documentation essential - theatre will check'
        ],
        mnemonics: [
          '2-4-6 rule: "2 for Water, 4 for Breast, 6 for the Rest"',
          'NPO = Nil Per Os (nothing by mouth)'
        ],
        scoring: {
          criticalFails: [
            'Did not verify fasting times',
            'Allowed surgery to proceed with fasting breach',
            'Gave incorrect fasting guidelines to parent'
          ],
          marks: [
            { item: 'Thorough fasting history taken', points: 2, domain: 'assessment' },
            { item: 'Correctly applied 2-4-6 rule', points: 2, domain: 'interventions' },
            { item: 'Clear parent education about fasting', points: 2, domain: 'communication' },
            { item: 'Accurate documentation', points: 2, domain: 'documentation' }
          ]
        }
      },

      {
        id: 'peri-2',
        topic: 'perioperative',
        title: 'Post-Operative Observations and ABCDE',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'This 7-year-old child has just returned from theatre following appendicectomy. Perform initial post-operative assessment using ABCDE approach.',
        equipment: ['Observation chart', 'Pulse oximeter', 'Thermometer', 'Stethoscope', 'Blood pressure cuff', 'Watch', 'Torch', 'Pain assessment tool'],
        checklist: {
          preparation: [
            'Receive handover from recovery nurse/anaesthetist',
            'Note procedure performed and anaesthetic type',
            'Check post-operative instructions',
            'Wash hands',
            'Ensure emergency equipment available',
            'Position child appropriately (recovery position if drowsy)'
          ],
          assessment: [
            'AIRWAY: Check airway patent and maintained',
            'AIRWAY: Look for airway obstruction signs',
            'AIRWAY: Listen for noisy breathing, stridor',
            'BREATHING: Count respiratory rate for 60 seconds',
            'BREATHING: Assess work of breathing',
            'BREATHING: Auscultate chest bilaterally',
            'BREATHING: Apply pulse oximeter and record SpO2',
            'CIRCULATION: Palpate pulse (rate, rhythm, volume)',
            'CIRCULATION: Measure blood pressure',
            'CIRCULATION: Assess capillary refill time',
            'CIRCULATION: Check colour (pallor, cyanosis)',
            'CIRCULATION: Assess surgical site for bleeding',
            'DISABILITY: Assess level of consciousness (AVPU)',
            'DISABILITY: Check pupils (size, equality, reaction)',
            'DISABILITY: Assess pain score',
            'EXPOSURE: Check temperature',
            'EXPOSURE: Inspect wound dressing',
            'EXPOSURE: Check drain output if present'
          ],
          interventions: [
            'Record all observations on chart',
            'Compare with baseline pre-operative observations',
            'Ensure oxygen therapy if prescribed',
            'Position for comfort and safety',
            'Administer analgesia as prescribed',
            'Provide anti-emetic if nausea/vomiting',
            'Continue NBM until appropriate',
            'Plan observation frequency (every 15 min initially)'
          ],
          communication: [
            'Explain to parent what you are doing',
            'Reassure child',
            'Report any concerns immediately using SBAR',
            'Document findings clearly',
            'Inform parent of post-op care plan'
          ],
          safetyRedFlags: [
            'Airway obstruction - immediate emergency',
            'SpO2 <92% - oxygen required',
            'Severe pain unrelieved by analgesia - surgical complication?',
            'Tachycardia + pallor + low BP - bleeding/shock',
            'Not rousing appropriately - prolonged sedation',
            'Excessive wound drainage - haemorrhage risk'
          ],
          documentation: [
            'Complete post-operative observation chart',
            'Document ABCDE assessment findings',
            'Record time returned from theatre',
            'Note pain score and analgesia given',
            'Document fluid balance',
            'Sign and time all entries'
          ]
        },
        tips: [
          'ABCDE approach ensures systematic assessment',
          'Treat problems as you find them - don\'t wait to finish assessment',
          'Airway is ALWAYS priority in post-op patient',
          'Initial observations every 15 minutes until stable',
          'Compare to baseline - significant changes need escalation'
        ],
        warnings: [
          'Never leave drowsy child unattended - airway risk',
          'Hypotension is LATE sign in children - look for early shock signs',
          'Post-op bleeding can be internal - monitor for shock signs',
          'Unrelieved pain may indicate surgical complication'
        ],
        mnemonics: [
          'ABCDE: Airway, Breathing, Circulation, Disability (neuro), Exposure (temp/wounds)',
          'AVPU: Alert, Voice responsive, Pain responsive, Unresponsive',
          'Post-op priorities: "Air Before Blood Before Brain" (A, B, C, D, E order)'
        ],
        scoring: {
          criticalFails: [
            'Did not assess airway first',
            'Failed to use systematic ABCDE approach',
            'Did not recognize red flag signs',
            'Left drowsy child unattended'
          ],
          marks: [
            { item: 'Complete systematic ABCDE assessment', points: 4, domain: 'assessment' },
            { item: 'Appropriate positioning for airway safety', points: 1, domain: 'interventions' },
            { item: 'Recognition of red flags and escalation', points: 2, domain: 'assessment' },
            { item: 'Thorough documentation', points: 2, domain: 'documentation' },
            { item: 'Clear communication with parent', points: 1, domain: 'communication' }
          ]
        }
      },

      {
        id: 'peri-3',
        topic: 'perioperative',
        title: 'Pre-Operative Checklist and Safety Checks',
        difficulty: 'medium',
        estimatedMinutes: 7,
        candidateInstructions: 'Complete the pre-operative checklist for this 6-year-old about to go to theatre for tonsillectomy. Perform all safety checks.',
        equipment: ['Pre-operative checklist', 'Patient notes', 'Consent form', 'Patient wristband', 'Surgical site marking pen (if applicable)', 'Allergy band'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Verify patient identity with 3-point check',
            'Check child changed into theatre gown',
            'Ensure child has voided (passed urine)',
            'Check all jewellery removed (including piercings)',
            'Remove nail polish if present',
            'Check hair secured (no clips/bands if metal)'
          ],
          assessment: [
            'Verify correct patient for correct procedure',
            'Check consent form: signed, dated, correct procedure',
            'Verify person with parental responsibility signed consent',
            'Check patient wristband: name, DOB, NHS number',
            'Verify allergy status documented',
            'Check allergy band applied if allergies present',
            'Verify fasting status documented and compliant',
            'Review anaesthetic assessment completed',
            'Check baseline observations recorded',
            'Verify any pre-medication given if prescribed',
            'Check surgical site marked if applicable (WHO guidelines)'
          ],
          interventions: [
            'Complete all sections of pre-operative checklist',
            'Document patient ready for theatre',
            'Ensure notes, X-rays, and consent accompany patient',
            'Apply identification bands if missing',
            'Ensure emergency contact details documented',
            'Remove any loose teeth/dental appliances',
            'Provide comfort item if allowed (toy to anaesthetic room)',
            'Prepare parent if accompanying to anaesthetic room'
          ],
          communication: [
            'Explain theatre process to child in age-appropriate way',
            'Discuss with parent what will happen',
            'Explain who can accompany child (usually one parent to anaesthetic room)',
            'Reassure child and parent',
            'Answer any last-minute questions',
            'Handover to theatre team using SBAR',
            'Document all verbal information given'
          ],
          safetyRedFlags: [
            'Consent not signed - surgery cannot proceed',
            'Wrong patient/wrong procedure - NEVER proceed',
            'Fasting breached - inform anaesthetist immediately',
            'Allergy not documented - critical safety issue',
            'Incomplete checklist - do not send to theatre'
          ],
          documentation: [
            'Complete entire pre-operative checklist',
            'Sign and print name on all relevant sections',
            'Document time patient left ward',
            'Record who accompanied patient',
            'Note any concerns or incidents',
            'Ensure all documents with patient'
          ]
        },
        tips: [
          'WHO Surgical Safety Checklist prevents wrong site/wrong patient surgery',
          'Never rush checklist - each item is there for patient safety',
          'If in doubt about ANY item - stop and clarify',
          'Two patient identifiers minimum - name and DOB',
          'Parent can usually accompany to anaesthetic room - check local policy'
        ],
        warnings: [
          'Missing consent = cancelled surgery',
          'Wrong patient identification is Never Event - check carefully',
          'Incomplete checklist puts patient at risk - every item matters',
          'Allergy information MUST be accurate - anaphylaxis risk'
        ],
        mnemonics: [
          'Pre-op safety: "ID, Consent, Fast, Allergies, Site" - essentials before theatre',
          'WHO checklist: "Sign In, Time Out, Sign Out" - three stages of surgical safety'
        ],
        scoring: {
          criticalFails: [
            'Did not verify patient identity adequately',
            'Sent patient to theatre with incomplete checklist',
            'Failed to check consent form',
            'Did not verify fasting status'
          ],
          marks: [
            { item: 'Thorough patient identification checks', points: 2, domain: 'assessment' },
            { item: 'Complete pre-operative checklist', points: 3, domain: 'interventions' },
            { item: 'Verification of consent and fasting', points: 2, domain: 'assessment' },
            { item: 'Appropriate SBAR handover to theatre', points: 2, domain: 'communication' },
            { item: 'Complete documentation', points: 1, domain: 'documentation' }
          ]
        }
      },

      // ========== MEDICATION MANAGEMENT STATIONS ==========
      {
        id: 'med-1',
        topic: 'medication',
        title: 'Medication Administration - 9 Rights Check',
        difficulty: 'easy',
        estimatedMinutes: 6,
        candidateInstructions: 'Prepare and administer oral paracetamol to this 5-year-old child. Demonstrate all 9 Rights of medication administration.',
        equipment: ['Prescription chart', 'Paracetamol suspension', 'Oral syringe', 'BNFc (British National Formulary for Children)', 'Medicine pot', 'Water', 'Patient wristband'],
        checklist: {
          preparation: [
            'Wash hands thoroughly',
            'Check prescription is legible and valid',
            'Verify prescription signed by prescriber',
            'Check no allergies documented',
            'Gather medication and equipment',
            'Check medication not already given'
          ],
          assessment: [
            'RIGHT PATIENT: Check 3-point ID (ask name/DOB, check wristband, check chart)',
            'RIGHT DRUG: Check medication name matches prescription exactly',
            'RIGHT DOSE: Calculate dose using weight/age, check with BNFc',
            'RIGHT ROUTE: Confirm oral route as prescribed',
            'RIGHT TIME: Check due time and timing interval correct',
            'RIGHT DOCUMENTATION: Check prescription chart complete',
            'RIGHT REASON: Understand why medication prescribed',
            'RIGHT RESPONSE: Know expected effect and monitoring needed',
            'RIGHT TO REFUSE: Acknowledge child/parent can refuse'
          ],
          interventions: [
            'Check medication expiry date',
            'Measure dose accurately using oral syringe',
            'Double-check dose measurement',
            'Explain medication to child in simple terms',
            'Gain child cooperation/assent',
            'Position child upright',
            'Administer medication safely',
            'Offer drink of water after',
            'Stay with child until medication swallowed',
            'Dispose of equipment safely',
            'Wash hands',
            'Sign prescription chart IMMEDIATELY AFTER administration'
          ],
          communication: [
            'Introduce self to child and parent',
            'Explain medication name and purpose to parent',
            'Use age-appropriate language for child',
            'Check child/parent understanding',
            'Advise when next dose due',
            'Inform about potential side effects'
          ],
          safetyRedFlags: [
            'Signing chart before administration - NEVER do this',
            'Wrong patient - critical medication error',
            'Wrong dose - can cause harm/overdose',
            'Exceeding maximum daily dose (e.g., >4 paracetamol doses in 24h)',
            'Not checking allergies - anaphylaxis risk'
          ],
          documentation: [
            'Sign prescription chart with full signature',
            'Print name clearly',
            'Record time of administration',
            'Document if dose refused or omitted',
            'Note any adverse reactions'
          ]
        },
        tips: [
          '9 Rights: Patient, Drug, Dose, Route, Time, Documentation, Reason, Response, Right to Refuse',
          'NEVER sign chart before giving medication - falsification of records',
          'If in doubt, don\'t give it out - check with senior/pharmacist',
          'Maximum 4 paracetamol doses in 24 hours - always check timing',
          'Weight-based dosing in children - always verify calculation'
        ],
        warnings: [
          'Signing before administration is professional misconduct',
          'Paracetamol overdose causes liver failure - check timing carefully',
          'Always check allergies - even for common medications',
          'Never leave medications at bedside in paediatrics'
        ],
        mnemonics: [
          '9 Rights mnemonic: "Peter\'s Dog Definitely Runs Towards Dogs Regularly, Refuses Rest" (Patient, Drug, Dose, Route, Time, Documentation, Reason, Response, Refuse)'
        ],
        scoring: {
          criticalFails: [
            'Did not check patient ID with 3-point check',
            'Signed chart before administering medication',
            'Incorrect dose calculation',
            'Did not check allergies'
          ],
          marks: [
            { item: 'Correct 3-point patient identification', points: 2, domain: 'assessment' },
            { item: 'All 9 Rights checked systematically', points: 3, domain: 'assessment' },
            { item: 'Accurate dose preparation', points: 2, domain: 'interventions' },
            { item: 'Signed chart after administration only', points: 2, domain: 'documentation' },
            { item: 'Clear communication with child and parent', points: 1, domain: 'communication' }
          ]
        }
      },

      {
        id: 'med-2',
        topic: 'medication',
        title: 'Controlled Drug Administration',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Administer oral morphine (controlled drug) to this 8-year-old post-operative patient. Demonstrate correct CD procedure with two nurses.',
        equipment: ['Controlled drug register', 'CD keys', 'Morphine solution', 'Oral syringe', 'Prescription chart', 'Calculator', 'Second registered nurse (examiner will role-play)', 'CD cupboard'],
        checklist: {
          preparation: [
            'Identify second registered nurse to witness',
            'Both nurses wash hands',
            'Obtain CD keys',
            'Check prescription chart together',
            'Verify patient ID together (3-point check)',
            'Check allergies together',
            'Open CD cupboard together'
          ],
          assessment: [
            'Both nurses check drug name on bottle',
            'Both nurses check drug strength',
            'Both nurses calculate required dose',
            'Both nurses independently verify calculation',
            'Check expiry date together',
            'Check previous CD register entry',
            'Verify stock balance in cupboard'
          ],
          interventions: [
            'First nurse draws up dose',
            'Second nurse observes and checks dose',
            'Both nurses verify dose in syringe',
            'Lock CD cupboard',
            'Both nurses go to patient together',
            'Confirm patient ID again at bedside',
            'Both nurses witness administration',
            'Ensure patient swallows medication',
            'Both nurses return to CD cupboard together',
            'Both nurses complete CD register',
            'Record: Date, Time, Patient name/details, Dose given, New stock balance',
            'Both nurses sign CD register',
            'Print names clearly',
            'Lock CD cupboard',
            'Return keys to designated person',
            'Both nurses sign prescription chart'
          ],
          communication: [
            'Explain to parent why two nurses required',
            'Inform child about medication in simple terms',
            'Discuss pain relief expectations',
            'Advise about monitoring for effectiveness',
            'Inform about potential side effects (drowsiness, nausea)',
            'Clear handover between nurses about CD procedure'
          ],
          safetyRedFlags: [
            'Single nurse administering CD - must be two RNs',
            'Discrepancy in CD stock - STOP and report immediately',
            'Calculation error - can cause fatal overdose',
            'Not both witnessing administration - both must see patient swallow',
            'CD register not completed - legal requirement'
          ],
          documentation: [
            'CD register: Both nurses sign',
            'CD register: Stock balance calculated and recorded',
            'Prescription chart: Both nurses sign',
            'Document time of administration',
            'Note pain score before and plan reassessment time'
          ]
        },
        tips: [
          'TWO registered nurses required for entire CD process',
          'Both must witness drawing up, administration, and sign register',
          'CD register is legal document - must be accurate',
          'Check stock balance - discrepancies must be reported immediately',
          'Morphine dosing in children is weight-based - verify carefully'
        ],
        warnings: [
          'Single-nurse CD administration is illegal and unsafe',
          'CD stock discrepancies can indicate diversion/theft - escalate',
          'Morphine respiratory depression risk - monitor closely',
          'Never leave CD cupboard unlocked or unattended'
        ],
        mnemonics: [
          'CD procedure: "Two Check Together" - two nurses check everything together throughout'
        ],
        scoring: {
          criticalFails: [
            'Did not have second nurse present throughout',
            'Did not both witness administration',
            'Did not complete CD register',
            'CD cupboard left unlocked'
          ],
          marks: [
            { item: 'Second nurse present throughout entire procedure', points: 2, domain: 'preparation' },
            { item: 'Both nurses checked dose calculation', points: 2, domain: 'assessment' },
            { item: 'Both nurses witnessed administration', points: 2, domain: 'interventions' },
            { item: 'CD register completed correctly by both', points: 2, domain: 'documentation' },
            { item: 'Stock balance verified and recorded', points: 1, domain: 'documentation' },
            { item: 'Clear communication about CD procedure', points: 1, domain: 'communication' }
          ]
        }
      },

      {
        id: 'med-3',
        topic: 'medication',
        title: 'Medication Calculation and Administration',
        difficulty: 'medium',
        estimatedMinutes: 7,
        candidateInstructions: 'Calculate and prepare IV antibiotics for this 10-year-old child weighing 32kg. Demonstrate accurate calculation and preparation using aseptic technique.',
        equipment: ['Prescription chart', 'Gentamicin vial (80mg/2ml)', 'IV fluid bag (50ml 0.9% sodium chloride)', 'Needles and syringes', 'Alcohol wipes', 'Calculator', 'BNFc', 'Sharps bin'],
        checklist: {
          preparation: [
            'Wash hands thoroughly',
            'Check prescription legible and valid',
            'Gather drug information from BNFc',
            'Verify patient weight documented',
            'Check allergies',
            'Gather all equipment',
            'Clean preparation area'
          ],
          assessment: [
            'Check prescribed dose: mg/kg/dose',
            'Calculate required dose for patient weight',
            'CALCULATION: Dose (mg) = weight (kg) × mg/kg prescribed',
            'Example: 32kg × 5mg/kg = 160mg',
            'Calculate volume needed from vial strength',
            'CALCULATION: Volume = (Dose required ÷ Vial strength) × Volume in vial',
            'Example: (160mg ÷ 80mg) × 2ml = 4ml',
            'Double-check calculation independently',
            'Verify dose within safe range (check BNFc max dose)',
            'Check drug compatibility with IV fluid'
          ],
          interventions: [
            'Perform hand hygiene',
            'Check drug name and expiry date',
            'Clean vial top with alcohol wipe',
            'Draw up calculated volume using aseptic technique',
            'Check volume in syringe matches calculation',
            'Label syringe clearly (drug name, dose, patient name, date/time)',
            'Add to IV infusion bag using ANTT',
            'Mix thoroughly',
            'Label IV bag completely',
            'Dispose of needle in sharps bin immediately',
            'Do NOT resheath needle',
            'Take to patient with prescription chart'
          ],
          communication: [
            'Have second nurse check calculation',
            'Explain procedure to parent and child',
            'Discuss expected duration of infusion',
            'Advise about monitoring during infusion',
            'Document calculation clearly'
          ],
          safetyRedFlags: [
            'Calculation error - can cause fatal overdose or under-treatment',
            'Wrong weight used - always verify patient weight',
            'Exceeding maximum dose - check BNFc limits',
            'No second check of calculation - required for high-risk drugs',
            'Unlabeled syringe - drug error risk'
          ],
          documentation: [
            'Document calculation in notes',
            'Show: Weight used, mg/kg dose, total dose calculated, volume drawn',
            'Record second checker name and signature',
            'Sign prescription chart after administration',
            'Document start time of infusion'
          ]
        },
        tips: [
          'Weight-based calculation formula: mg/kg × weight = total dose',
          'Volume calculation: (Required dose ÷ Stock strength) × Stock volume',
          'Always get second nurse to check calculation for IV/high-risk drugs',
          'Write calculation down - don\'t rely on mental math',
          'Check max dose in BNFc - especially important in large/small children'
        ],
        warnings: [
          'Calculation errors are common cause of medication incidents',
          'Aminoglycosides (like gentamicin) can cause kidney/hearing damage - accurate dosing essential',
          'Always use actual patient weight - never estimate',
          'Decimal point errors can cause 10-fold dosing errors'
        ],
        mnemonics: [
          'Calculation check: "Weight × dose per kg = Total dose, then check the Max"',
          'Volume formula: "What you want ÷ What you\'ve got × Volume it\'s in"'
        ],
        scoring: {
          criticalFails: [
            'Incorrect dose calculation',
            'Did not verify patient weight',
            'Exceeded maximum safe dose',
            'No second nurse check'
          ],
          marks: [
            { item: 'Accurate dose calculation using weight', points: 2, domain: 'assessment' },
            { item: 'Accurate volume calculation', points: 2, domain: 'assessment' },
            { item: 'Second nurse check obtained', points: 1, domain: 'communication' },
            { item: 'Aseptic technique during preparation', points: 2, domain: 'interventions' },
            { item: 'Clear documentation of calculation', points: 2, domain: 'documentation' },
            { item: 'Correct labeling of prepared medication', points: 1, domain: 'interventions' }
          ]
        }
      },

      // ========== LINES & TAPES STATIONS (NEW) ==========
      {
        id: 'lines-1',
        topic: 'lines',
        title: 'Securing Peripheral IV Cannula',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Demonstrate how to secure a peripheral IV cannula on a 3-year-old child. Explain your technique and the importance of proper securing to the parent.',
        equipment: ['IV cannula (already inserted on manikin)', 'Transparent IV dressing (e.g., Tegaderm)', 'Sterile gauze', 'Hypoallergenic tape', 'Bandage for splinting', 'Arm splint/board', 'Gloves', 'Documentation chart'],
        checklist: {
          preparation: [
            'Wash hands and apply gloves',
            'Introduce self to child and parent',
            'Explain procedure in age-appropriate terms',
            'Gather all equipment before starting',
            'Ensure child is comfortable and distracted'
          ],
          assessment: [
            'Check cannula is correctly positioned',
            'Assess insertion site for redness, swelling, leakage',
            'Confirm cannula flushes without resistance',
            'Check skin integrity around site',
            'Assess need for splinting based on location and child age'
          ],
          interventions: [
            'Clean around insertion site if needed',
            'Apply transparent dressing over insertion site',
            'Ensure insertion site remains VISIBLE through dressing',
            'Secure tubing with loop to prevent traction',
            'Apply tape to secure extension set',
            'Apply splint if cannula at joint (elbow/wrist)',
            'Ensure fingers visible to check circulation',
            'Avoid circumferential taping',
            'Label dressing with date, time, and initials'
          ],
          communication: [
            'Explain to parent why site must be visible',
            'Teach parent signs of extravasation to report',
            'Discuss importance of not pulling on tubing',
            'Explain when to call for help'
          ],
          safetyRedFlags: [
            'Insertion site NOT visible - risk of undetected extravasation',
            'Circumferential taping - risk of circulation compromise',
            'Too tight splinting - check distal circulation',
            'Signs of extravasation: swelling, blanching, coolness, pain'
          ],
          documentation: [
            'Record cannula site and gauge',
            'Document date and time of insertion',
            'Record VIP score (Visual Infusion Phlebitis)',
            'Note condition of site and any concerns'
          ]
        },
        tips: [
          'Transparent dressing allows continuous site monitoring',
          'Loop tubing before securing to prevent accidental pull-out',
          'Distraction techniques: bubbles, videos, parental comfort',
          'Check VIP score every shift minimum'
        ],
        warnings: [
          'NEVER cover insertion site with opaque dressing',
          'Extravasation can cause tissue necrosis within hours',
          'Tight bandaging can cause compartment syndrome',
          'Always check distal circulation after securing'
        ],
        mnemonics: [
          'VIP score: Visual Infusion Phlebitis - check for pain, redness, swelling',
          'STOP infusion if: Swelling, Tightness, Oozing, Pain'
        ],
        scoring: {
          criticalFails: [
            'Insertion site not visible after securing',
            'Failed to check distal circulation',
            'Circumferential taping applied'
          ],
          marks: [
            { item: 'Site visible through dressing', points: 3, domain: 'interventions' },
            { item: 'Appropriate splinting technique', points: 2, domain: 'interventions' },
            { item: 'Parent education on warning signs', points: 2, domain: 'communication' },
            { item: 'Documentation complete', points: 1, domain: 'documentation' }
          ]
        }
      },
      {
        id: 'lines-2',
        topic: 'lines',
        title: 'Securing Nasogastric Tube',
        difficulty: 'medium',
        estimatedMinutes: 7,
        candidateInstructions: 'Demonstrate how to secure a nasogastric tube on a 6-month-old infant. The tube has already been inserted and position confirmed. Focus on safe securing technique.',
        equipment: ['NG tube (already in situ on manikin)', 'Hydrocolloid dressing', 'Hypoallergenic tape', 'Skin barrier wipe', 'Tape measure', 'Marker pen', 'Documentation chart'],
        checklist: {
          preparation: [
            'Wash hands thoroughly',
            'Introduce self and explain to parent',
            'Ensure infant is settled and comfortable',
            'Gather all equipment',
            'Check NG tube position has been confirmed'
          ],
          assessment: [
            'Verify tube position confirmed (pH/X-ray)',
            'Note measurement at nostril (cm marking)',
            'Assess skin condition on face/cheek',
            'Check nostril for pressure damage',
            'Ensure tube is patent'
          ],
          interventions: [
            'Apply skin barrier to cheek if needed',
            'Cut tape to appropriate size',
            'Secure tube to cheek (NOT forehead)',
            'Avoid pressure on nostril or nasal septum',
            'Ensure tube follows natural curve',
            'Mark tube at nostril level with marker',
            'Create safety loop to prevent traction',
            'Ensure tape not too tight on skin'
          ],
          communication: [
            'Explain securing method to parent',
            'Teach signs of tube displacement',
            'Discuss importance of checking position before feeds',
            'Advise not to pull or adjust tube themselves'
          ],
          safetyRedFlags: [
            'Pressure on nostril - risk of necrosis',
            'Tube secured to forehead - incorrect technique',
            'Tube measurement changed - possible displacement',
            'Skin breakdown under tape'
          ],
          documentation: [
            'Record tube size (Fr) and type',
            'Document measurement at nostril',
            'Note skin condition',
            'Record confirmation method (pH/X-ray)'
          ]
        },
        tips: [
          'Hydrocolloid base protects delicate infant skin',
          'Change tape when soiled or loose - never wait',
          'Natural curve: tube should not pull against nostril',
          'Check tube position before EVERY feed'
        ],
        warnings: [
          'NEVER tape to forehead - pulls on nostril',
          'Nostril pressure can cause necrosis within hours',
          'Displaced tube + feed = aspiration risk',
          'Always confirm position before use, even if just secured'
        ],
        mnemonics: [
          'NG Safety: Position, pH, Prevent pressure',
          'Before every feed: Check position, Check pH, Check patency'
        ],
        scoring: {
          criticalFails: [
            'Taped to forehead',
            'Pressure on nostril',
            'Did not mark/note measurement at nostril'
          ],
          marks: [
            { item: 'Correct tape placement on cheek', points: 3, domain: 'interventions' },
            { item: 'No pressure on nostril/septum', points: 2, domain: 'interventions' },
            { item: 'Measurement documented', points: 2, domain: 'documentation' },
            { item: 'Parent education completed', points: 1, domain: 'communication' }
          ]
        }
      },
      {
        id: 'lines-3',
        topic: 'lines',
        title: 'Central Line Dressing Change',
        difficulty: 'hard',
        estimatedMinutes: 12,
        candidateInstructions: 'Perform a central venous catheter (CVC) dressing change on a 7-year-old child with a Hickman line. Use aseptic non-touch technique throughout.',
        equipment: ['CVC dressing pack', 'Sterile gloves (2 pairs)', 'Chlorhexidine 2% in alcohol', 'Transparent semipermeable dressing', 'Sterile gauze', 'Steri-strips', 'Face mask', 'Apron', 'Sharps bin', 'Documentation chart'],
        checklist: {
          preparation: [
            'Explain procedure to child and parent',
            'Gain consent/assent',
            'Perform hand hygiene',
            'Put on apron and mask',
            'Create aseptic field',
            'Open dressing pack using ANTT',
            'Apply sterile gloves'
          ],
          assessment: [
            'Assess current dressing condition',
            'Check exit site for signs of infection',
            'Assess surrounding skin integrity',
            'Check line is secured and not kinked',
            'Note any discharge or redness',
            'Check external line length/measurement'
          ],
          interventions: [
            'Remove old dressing carefully',
            'Dispose of gloves and re-apply sterile gloves',
            'Clean site with chlorhexidine 2%',
            'Clean from exit site outward in circular motion',
            'Allow to dry completely (30 seconds minimum)',
            'Do NOT fan or blow to dry',
            'Apply new transparent dressing',
            'Ensure exit site visible',
            'Secure line with steri-strips if needed',
            'Ensure no tension on line'
          ],
          communication: [
            'Keep child informed throughout',
            'Use distraction techniques',
            'Explain findings to parent',
            'Discuss signs of infection to report'
          ],
          safetyRedFlags: [
            'Signs of infection: redness, swelling, discharge, fever',
            'Line displacement - external length changed',
            'Cracked or damaged line - do not use, report immediately',
            'Air embolism risk - keep line clamped when open'
          ],
          documentation: [
            'Record date and time of dressing change',
            'Document exit site condition',
            'Note external line length',
            'Record any concerns or actions taken',
            'Sign CVC care bundle'
          ]
        },
        tips: [
          'ANTT throughout - key fields and key parts',
          'Chlorhexidine must dry for full antimicrobial effect',
          'Schedule dressing changes - every 7 days or when soiled',
          'Two-person technique safer for uncooperative child'
        ],
        warnings: [
          'CVCs are HIGH infection risk - strict asepsis essential',
          'Line sepsis can be fatal - report any concerns immediately',
          'Never use scissors near the line',
          'Cracked line = air embolism risk - clamp proximal to crack'
        ],
        mnemonics: [
          'CVC checks: Exit site, External length, Expiry of dressing',
          'ANTT: Aseptic Non-Touch Technique - protect key parts, key sites'
        ],
        scoring: {
          criticalFails: [
            'Broke aseptic technique',
            'Did not allow chlorhexidine to dry',
            'Exit site not visible after dressing',
            'Failed to identify signs of infection'
          ],
          marks: [
            { item: 'Maintained ANTT throughout', points: 4, domain: 'interventions' },
            { item: 'Correct cleaning technique', points: 2, domain: 'interventions' },
            { item: 'Thorough site assessment', points: 2, domain: 'assessment' },
            { item: 'Complete documentation', points: 2, domain: 'documentation' }
          ]
        }
      },

      // ========== ADDITIONAL HANDWASHING STATIONS ==========
      {
        id: 'hand-2',
        topic: 'handwashing',
        title: 'PPE Donning and Doffing Sequence',
        difficulty: 'medium',
        estimatedMinutes: 8,
        candidateInstructions: 'Demonstrate the correct sequence for putting on (donning) and removing (doffing) PPE for contact precautions. Explain the rationale for the sequence.',
        equipment: ['Disposable apron', 'Non-sterile gloves', 'Fluid-resistant surgical mask', 'Eye protection/visor', 'Hand sanitizer', 'Clinical waste bin'],
        checklist: {
          preparation: [
            'Identify correct PPE for precaution type',
            'Perform hand hygiene before donning',
            'Gather all required PPE',
            'Check PPE for defects/damage',
            'Remove watch and jewellery'
          ],
          assessment: [
            'Assess type of precautions required (contact/droplet/airborne)',
            'Check correct size of gloves',
            'Ensure adequate PPE stock available',
            'Identify waste disposal location'
          ],
          interventions: [
            'DONNING - Apron first',
            'DONNING - Mask second (fit over nose and mouth)',
            'DONNING - Eye protection third',
            'DONNING - Gloves last (over apron cuffs)',
            'Enter patient area',
            'Perform care',
            'DOFFING - Gloves first (most contaminated)',
            'DOFFING - Hand hygiene',
            'DOFFING - Apron second',
            'DOFFING - Hand hygiene',
            'DOFFING - Eye protection third',
            'DOFFING - Mask last (by straps only)',
            'Final hand hygiene'
          ],
          communication: [
            'Explain PPE use to parent',
            'Reassure child about appearance in PPE',
            'Discuss reason for precautions appropriately'
          ],
          safetyRedFlags: [
            'Wrong doffing sequence - self-contamination risk',
            'Touching front of mask when removing',
            'Not performing hand hygiene between steps',
            'Gloves removed after apron - contaminates arms'
          ],
          documentation: [
            'Document precaution type in place',
            'Report any PPE breaches',
            'Note any supply issues'
          ]
        },
        tips: [
          'Donning: AMEG (Apron, Mask, Eyes, Gloves)',
          'Doffing: GHAE+M (Gloves, Hands, Apron, Eyes, Mask) with hand hygiene throughout',
          'Gloves most contaminated - always remove first',
          'Touch only straps/ties when removing mask'
        ],
        warnings: [
          'Self-contamination most common during DOFFING',
          'Mask removal is highest risk - viral load on front surface',
          'Never reuse single-use PPE',
          'Report any PPE breaches immediately'
        ],
        mnemonics: [
          'DON: Apron, Mask, Eyes, Gloves (AMEG)',
          'DOFF: Gloves off, Hands clean, Apron off, Eyes off, Mask off - hands clean between EACH step'
        ],
        scoring: {
          criticalFails: [
            'Gloves removed after apron',
            'Touched front of mask during removal',
            'No hand hygiene between doffing steps'
          ],
          marks: [
            { item: 'Correct donning sequence', points: 2, domain: 'interventions' },
            { item: 'Correct doffing sequence', points: 3, domain: 'interventions' },
            { item: 'Hand hygiene at all required points', points: 3, domain: 'interventions' },
            { item: 'Explained rationale', points: 2, domain: 'communication' }
          ]
        }
      },
      {
        id: 'hand-3',
        topic: 'handwashing',
        title: 'Alcohol Hand Rub Technique',
        difficulty: 'easy',
        estimatedMinutes: 5,
        candidateInstructions: 'Demonstrate the correct technique for using alcohol-based hand rub (ABHR). Explain when ABHR is appropriate and when soap and water must be used instead.',
        equipment: ['Alcohol-based hand rub dispenser', 'Information poster (WHO 5 Moments)', 'Sink with soap (for comparison discussion)'],
        checklist: {
          preparation: [
            'Ensure hands are visibly clean',
            'Remove hand jewellery',
            'Bare below elbows',
            'Check ABHR dispenser has product'
          ],
          assessment: [
            'Confirm hands not visibly soiled',
            'Confirm patient not C.diff or norovirus',
            'Identify this as appropriate WHO moment'
          ],
          interventions: [
            'Apply palm-full of ABHR to cupped hand',
            'Step 1: Rub palms together',
            'Step 2: Right palm over left dorsum and vice versa',
            'Step 3: Palm to palm with fingers interlaced',
            'Step 4: Backs of fingers to opposing palms',
            'Step 5: Rotational rubbing of thumbs',
            'Step 6: Rotational rubbing with clasped fingers in palms',
            'Continue until hands completely dry',
            'Do not wipe or rinse off'
          ],
          communication: [
            'Explain when ABHR is/isn\'t appropriate',
            'Discuss C.diff and norovirus exceptions',
            'Describe WHO 5 Moments to parent'
          ],
          safetyRedFlags: [
            'Using ABHR on visibly soiled hands',
            'Using ABHR for C.diff or norovirus patients',
            'Wiping hands before ABHR is dry',
            'Insufficient volume of ABHR used'
          ],
          documentation: [
            'Participate in hand hygiene audits',
            'Report empty dispensers',
            'Note any skin reactions'
          ]
        },
        tips: [
          'ABHR is faster and more effective than soap for most pathogens',
          'Must use enough product - palm full, not a few drops',
          'Hands must air dry - alcohol needs contact time',
          'Most commonly missed areas: thumbs, fingertips, between fingers'
        ],
        warnings: [
          'ABHR does NOT kill C.diff spores or norovirus',
          'Visibly soiled hands = soap and water mandatory',
          'After caring for vomiting/diarrhoea patient = soap and water',
          'ABHR near flames/oxygen = fire risk'
        ],
        mnemonics: [
          'When to use soap: "If in doubt, wash it out" - visible soil, C.diff, norovirus, after toilet',
          '5 Moments: Before touching, Before clean procedure, After body fluid, After touching, After surroundings'
        ],
        scoring: {
          criticalFails: [
            'Used ABHR on visibly soiled hands',
            'Did not cover all hand surfaces',
            'Wiped hands before dry'
          ],
          marks: [
            { item: 'Correct volume applied', points: 2, domain: 'interventions' },
            { item: 'All 6 steps performed', points: 3, domain: 'interventions' },
            { item: 'Allowed to air dry completely', points: 2, domain: 'interventions' },
            { item: 'Explained exceptions correctly', points: 2, domain: 'communication' }
          ]
        }
      },

      // ========== ADDITIONAL RESPIRATORY STATIONS ==========
      {
        id: 'resp-2',
        topic: 'respiratory',
        title: 'Oxygen Administration via Nasal Cannula',
        difficulty: 'easy',
        estimatedMinutes: 7,
        candidateInstructions: 'Administer oxygen via nasal cannula to a 5-year-old child with SpO2 of 91% on room air. Target SpO2 is ≥94%.',
        equipment: ['Oxygen supply (wall/cylinder)', 'Paediatric nasal cannula', 'Flowmeter', 'Pulse oximeter', 'Humidification (if high flow)', 'Observation chart'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain procedure in simple terms',
            'Check oxygen prescription',
            'Wash hands',
            'Gather equipment and check oxygen supply',
            'Select correct size nasal cannula'
          ],
          assessment: [
            'Assess current respiratory status',
            'Confirm current SpO2 reading',
            'Check nasal patency (not blocked)',
            'Assess work of breathing',
            'Check for contraindications'
          ],
          interventions: [
            'Connect cannula to flowmeter',
            'Set prescribed flow rate (usually 0.5-2L/min for child)',
            'Check oxygen is flowing (feel at prongs)',
            'Position prongs in nostrils (curve downward)',
            'Secure tubing behind ears and under chin',
            'Ensure comfortable fit - not too tight',
            'Monitor SpO2 response',
            'Adjust flow to achieve target SpO2'
          ],
          communication: [
            'Reassure child - explain it helps breathing',
            'Explain to parent why oxygen is needed',
            'Teach parent to monitor for displacement',
            'Explain target SpO2 range'
          ],
          safetyRedFlags: [
            'SpO2 not improving - escalate',
            'Flow rate >2L/min via simple cannula may need humidification',
            'Nasal irritation or bleeding',
            'Child removing cannula repeatedly - consider alternative delivery'
          ],
          documentation: [
            'Record oxygen prescription',
            'Document flow rate and delivery device',
            'Record SpO2 before and after',
            'Note any adverse effects'
          ]
        },
        tips: [
          'Low flow (1-2L/min) suitable for mild hypoxia',
          'Nasal cannula allows eating, drinking, talking',
          'Humidification recommended if >2L/min or prolonged use',
          'Wean oxygen gradually - don\'t stop suddenly'
        ],
        warnings: [
          'Never use oil-based products near oxygen (fire risk)',
          'High flow through simple cannula dries mucosa',
          'Oxygen is a drug - must be prescribed',
          'Over-oxygenation harmful in some conditions (chronic lung disease)'
        ],
        mnemonics: [
          'Oxygen checks: Prescription, Patency, Position, Percentage (SpO2)',
          'Target SpO2: >94% for most, 88-92% for chronic lung disease'
        ],
        scoring: {
          criticalFails: [
            'Did not check prescription',
            'Wrong flow rate set',
            'Did not monitor SpO2 response'
          ],
          marks: [
            { item: 'Correct equipment selection', points: 2, domain: 'preparation' },
            { item: 'Proper cannula positioning', points: 2, domain: 'interventions' },
            { item: 'Monitored SpO2 response', points: 2, domain: 'assessment' },
            { item: 'Clear communication with child/parent', points: 2, domain: 'communication' }
          ]
        }
      },
      {
        id: 'resp-3',
        topic: 'respiratory',
        title: 'Peak Flow Measurement',
        difficulty: 'easy',
        estimatedMinutes: 6,
        candidateInstructions: 'Demonstrate how to measure peak expiratory flow rate (PEFR) on an 8-year-old child with asthma. Explain the technique and interpret a reading.',
        equipment: ['Peak flow meter with disposable mouthpiece', 'Peak flow diary/chart', 'Predicted PEFR chart for age/height', 'Observation chart'],
        checklist: {
          preparation: [
            'Introduce self to child and parent',
            'Explain purpose of peak flow measurement',
            'Wash hands',
            'Attach clean mouthpiece to meter',
            'Reset pointer to zero',
            'Ensure child is standing or sitting upright'
          ],
          assessment: [
            'Check child understands technique',
            'Assess child\'s current respiratory status',
            'Identify child\'s predicted/best PEFR',
            'Note any current symptoms'
          ],
          interventions: [
            'Demonstrate technique first',
            'Ask child to stand or sit up straight',
            'Take a deep breath in (maximum inspiration)',
            'Place mouthpiece in mouth with tight seal',
            'Blast out as hard and fast as possible',
            'Read the number indicated by pointer',
            'Reset and repeat 3 times total',
            'Record the BEST of 3 readings',
            'Compare to predicted/personal best'
          ],
          communication: [
            'Use encouraging language - "blow out birthday candles hard"',
            'Explain what the reading means',
            'Discuss traffic light zones if applicable',
            'Teach when to use peak flow at home'
          ],
          safetyRedFlags: [
            'PEFR <50% predicted = severe - escalate',
            'PEFR <33% predicted = life-threatening',
            'Unable to perform test = severe breathlessness',
            'Declining trend over time'
          ],
          documentation: [
            'Record best of 3 readings',
            'Document as % of predicted/personal best',
            'Note time and any symptoms',
            'Update peak flow chart/diary'
          ]
        },
        tips: [
          'Best of 3 readings - not average',
          'Morning readings typically lower than evening',
          'Personal best more useful than predicted values',
          'Traffic light system: Green >80%, Amber 50-80%, Red <50%'
        ],
        warnings: [
          'Poor technique gives falsely low readings',
          'Do not perform during acute severe attack',
          'Coughing during test invalidates that attempt',
          'Ensure tight lip seal around mouthpiece'
        ],
        mnemonics: [
          'Traffic lights: Green (go, >80%), Amber (caution, 50-80%), Red (danger, <50%)',
          'Technique: Stand tall, Breathe in, Seal lips, Blast out'
        ],
        scoring: {
          criticalFails: [
            'Used average instead of best reading',
            'Did not compare to predicted/personal best',
            'Failed to recognise concerning reading'
          ],
          marks: [
            { item: 'Correct demonstration of technique', points: 3, domain: 'interventions' },
            { item: 'Took best of 3 readings', points: 2, domain: 'interventions' },
            { item: 'Compared to predicted/personal best', points: 2, domain: 'assessment' },
            { item: 'Child-friendly explanation', points: 2, domain: 'communication' }
          ]
        }
      },

      // ========== ADDITIONAL COMMUNICATION STATIONS ==========
      {
        id: 'comm-2',
        topic: 'communication',
        title: 'SBAR Handover',
        difficulty: 'medium',
        estimatedMinutes: 6,
        candidateInstructions: 'You are handing over a deteriorating 4-year-old patient to the senior nurse using SBAR. The child has developed increased work of breathing and falling SpO2.',
        equipment: ['Patient observation chart', 'PEWS chart', 'Medical notes', 'Telephone (if practicing remote handover)'],
        checklist: {
          preparation: [
            'Gather all relevant information before handover',
            'Have observations chart in front of you',
            'Calculate PEWS score if applicable',
            'Know what you are recommending/requesting',
            'Identify yourself and your role'
          ],
          assessment: [
            'Current vital signs to hand',
            'Trend of observations (getting better/worse)',
            'Recent interventions and response',
            'Current clinical status'
          ],
          interventions: [
            'SITUATION: State your name, location, patient name and DOB',
            'SITUATION: "I am calling about... I am concerned because..."',
            'BACKGROUND: Reason for admission, relevant history',
            'BACKGROUND: Recent changes or interventions',
            'ASSESSMENT: Current observations with trends',
            'ASSESSMENT: PEWS score, your clinical concern',
            'RECOMMENDATION: What you need/what you think should happen',
            'RECOMMENDATION: How urgent - when do you need response'
          ],
          communication: [
            'Speak clearly and concisely',
            'State level of urgency clearly',
            'Use closed-loop communication',
            'Confirm understanding and agreed actions',
            'Document conversation and outcomes'
          ],
          safetyRedFlags: [
            'Critical information omitted',
            'Urgency not clearly communicated',
            'No clear recommendation made',
            'Handover not documented'
          ],
          documentation: [
            'Record time of handover',
            'Document who you handed over to',
            'Note agreed actions and timeframe',
            'Record if escalation needed'
          ]
        },
        tips: [
          'Prepare before calling - have all info ready',
          'Lead with your concern - don\'t bury the headline',
          'Be specific: "SpO2 dropped from 98% to 91%" not "sats are low"',
          'If concerned, say "I am worried about this child"'
        ],
        warnings: [
          'Never assume the receiver knows the patient',
          'Don\'t minimize your concerns',
          'If you are worried, escalate even if observations "normal"',
          'Follow up if agreed actions don\'t happen'
        ],
        mnemonics: [
          'SBAR: Situation, Background, Assessment, Recommendation',
          'Situation opener: "I am [name], calling about [patient], I am concerned because..."'
        ],
        scoring: {
          criticalFails: [
            'Patient not correctly identified',
            'No recommendation made',
            'Urgency not communicated',
            'Critical information omitted'
          ],
          marks: [
            { item: 'Clear Situation statement', points: 2, domain: 'communication' },
            { item: 'Relevant Background provided', points: 2, domain: 'communication' },
            { item: 'Accurate Assessment with observations', points: 2, domain: 'communication' },
            { item: 'Clear Recommendation made', points: 2, domain: 'communication' },
            { item: 'Handover documented', points: 1, domain: 'documentation' }
          ]
        }
      },
      {
        id: 'comm-3',
        topic: 'communication',
        title: 'Breaking Bad News with Empathy',
        difficulty: 'hard',
        estimatedMinutes: 10,
        candidateInstructions: 'You need to inform a parent that their 2-year-old child\'s blood test shows they need to stay in hospital for IV antibiotics. The parent was expecting to go home. Deliver this news with empathy.',
        equipment: ['Private room/space', 'Tissues', 'Results/documentation', 'Information leaflet if available'],
        checklist: {
          preparation: [
            'Find a private, quiet space',
            'Ensure you have correct information',
            'Allow adequate time - no rushing',
            'Sit at same level as parent',
            'Minimise interruptions (phone on silent)',
            'Consider if other family member should be present'
          ],
          assessment: [
            'Assess parent\'s current understanding',
            'Gauge emotional state',
            'Ask what they have been told so far',
            'Identify any language or communication needs'
          ],
          interventions: [
            'Give a "warning shot" - "I have the results and I need to discuss them with you"',
            'Deliver news clearly using simple language',
            'Pause - allow information to sink in',
            'Acknowledge and validate emotions',
            'Use empathic statements: "I can see this is upsetting"',
            'Check understanding - "What questions do you have?"',
            'Provide clear plan for what happens next',
            'Offer support and reassurance'
          ],
          communication: [
            'Use clear, jargon-free language',
            'Maintain appropriate eye contact',
            'Use open body language',
            'Listen actively without interrupting',
            'Normalise emotional reactions',
            'Summarise and check understanding'
          ],
          safetyRedFlags: [
            'Parent not understanding information',
            'Extreme emotional distress - may need additional support',
            'Safeguarding concerns arising',
            'Parent wanting to leave against medical advice'
          ],
          documentation: [
            'Record conversation in notes',
            'Document parent\'s understanding',
            'Note any concerns or follow-up needed',
            'Record plan agreed'
          ]
        },
        tips: [
          'Silence is okay - let parent process',
          'Empathy before information - acknowledge emotions first',
          'Avoid false reassurance: "I\'m sure it will be fine"',
          'Ask "What would be most helpful right now?"'
        ],
        warnings: [
          'Never deliver significant news in corridor or public area',
          'Avoid medical jargon - parents may not ask for clarification',
          'Don\'t overload with information - focus on key points',
          'Never appear rushed even if busy'
        ],
        mnemonics: [
          'SPIKES: Setting, Perception, Invitation, Knowledge, Empathy, Summary',
          'Empathic responses: Name emotion, Understand, Respect, Support'
        ],
        scoring: {
          criticalFails: [
            'News delivered in inappropriate setting',
            'No empathy or acknowledgment of emotions',
            'Medical jargon without explanation',
            'Parent understanding not checked'
          ],
          marks: [
            { item: 'Appropriate setting and preparation', points: 2, domain: 'preparation' },
            { item: 'Clear delivery of information', points: 2, domain: 'communication' },
            { item: 'Empathic response to emotions', points: 3, domain: 'communication' },
            { item: 'Checked understanding', points: 2, domain: 'communication' },
            { item: 'Documented conversation', points: 1, domain: 'documentation' }
          ]
        }
      },

      // ========== ADDITIONAL SAFETY STATION ==========
      {
        id: 'safety-3',
        topic: 'safety',
        title: 'Patient Identity Check (3-Point ID)',
        difficulty: 'easy',
        estimatedMinutes: 5,
        candidateInstructions: 'Demonstrate how to correctly verify a patient\'s identity before administering medication using three-point identification. The patient is a 6-year-old child with their parent present.',
        equipment: ['Patient wristband', 'Prescription chart', 'Medication to be given', 'Patient notes'],
        checklist: {
          preparation: [
            'Wash hands',
            'Approach patient and parent',
            'Introduce yourself and explain what you are doing',
            'Have prescription chart ready',
            'Ensure adequate lighting to read wristband'
          ],
          assessment: [
            'Check prescription chart is for correct patient',
            'Verify patient has wristband in place',
            'Assess patient\'s ability to state own details',
            'Note any allergies documented'
          ],
          interventions: [
            'POINT 1: Ask patient/parent to STATE full name',
            'Do NOT ask "Are you John Smith?" (leading question)',
            'Ask open question: "Can you tell me your full name?"',
            'POINT 2: Ask patient/parent to STATE date of birth',
            'POINT 3: Check wristband matches stated details',
            'Cross-reference with prescription chart',
            'Check NHS number if available',
            'Check allergy status on wristband and chart match'
          ],
          communication: [
            'Explain why checking identity is important',
            'Use age-appropriate language with child',
            'Thank patient/parent for confirming details',
            'Never rush or skip steps even if you "know" the patient'
          ],
          safetyRedFlags: [
            'No wristband - do not proceed until applied',
            'Details do not match - stop and investigate',
            'Wristband damaged or illegible - replace first',
            'Patient unable to confirm and no family present - check notes/photo ID'
          ],
          documentation: [
            'Sign prescription to confirm ID check done',
            'Report any identification issues',
            'Document if wristband replaced'
          ]
        },
        tips: [
          'Ask OPEN questions - never suggest the answer',
          'Check wristband on patient, not lying on table',
          'Even familiar patients must be checked every time',
          'Verbal confirmation alone is not sufficient - always check wristband'
        ],
        warnings: [
          'Wrong patient medication errors can be fatal',
          'Children may answer "yes" to any name suggested',
          'Wristbands can be swapped in shared rooms - always verify',
          'Never assume - always check'
        ],
        mnemonics: [
          '3-Point ID: Ask name, Ask DOB, Check wristband',
          'Open questions: WHO are you? WHEN were you born?'
        ],
        scoring: {
          criticalFails: [
            'Asked leading question (e.g., "Are you John?")',
            'Did not check wristband',
            'Proceeded without matching all identifiers',
            'Did not check against prescription'
          ],
          marks: [
            { item: 'Open question for name', points: 2, domain: 'interventions' },
            { item: 'Open question for DOB', points: 2, domain: 'interventions' },
            { item: 'Wristband checked against verbal confirmation', points: 2, domain: 'interventions' },
            { item: 'Cross-referenced with prescription', points: 2, domain: 'interventions' },
            { item: 'Allergy status confirmed', points: 1, domain: 'assessment' }
          ]
        }
      }
    ];

 // ==================== PDF GENERATION FUNCTIONS ====================
    
    // ==================== PDF GENERATION (robust) ====================
    window.downloadQuizResultsPDF = async () => {
      try {
        if (!window.jspdf || !window.html2canvas) {
          alert('PDF libraries failed to load. Check your internet connection and try again.');
          return;
        }
        const { jsPDF } = window.jspdf;

        // Capture the visible results screen (main-content)
        const target = document.getElementById('main-content') || document.body;
        const canvas = await window.html2canvas(target, {
          scale: 2,
          backgroundColor: null,
          useCORS: true,
          allowTaint: true,
          logging: false
        });

        const imgData = canvas.toDataURL('image/png');
        const pdf = new jsPDF('p', 'mm', 'a4');

        const pageWidth = pdf.internal.pageSize.getWidth();
        const pageHeight = pdf.internal.pageSize.getHeight();

        // Fit image to page width
        const imgProps = pdf.getImageProperties(imgData);
        const imgWidth = pageWidth;
        const imgHeight = (imgProps.height * imgWidth) / imgProps.width;

        // Multi-page if needed
        let y = 0;
        let remaining = imgHeight;

        // Add first page
        pdf.addImage(imgData, 'PNG', 0, y, imgWidth, imgHeight, undefined, 'FAST');
        remaining -= pageHeight;

        // Add extra pages by shifting image up
        while (remaining > 0) {
          pdf.addPage();
          y = -((imgHeight - remaining));
          pdf.addImage(imgData, 'PNG', 0, y, imgWidth, imgHeight, undefined, 'FAST');
          remaining -= pageHeight;
        }

        pdf.save('nursing-theory-quiz-results.pdf');
      } catch (err) {
        console.error(err);
        alert('PDF export failed. Try again, or use your browser Print → Save as PDF as a backup.');
      }
    };
;

    window.downloadOSCEResultsPDF = async () => {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF('p', 'mm', 'a4');
      
      let totalItems = 0;
      let totalChecked = 0;
      const stationResults = [];

      sessionStations.forEach(station => {
        const stId = station.id;
        const checklist = currentStationChecklist[stId] || {};
        const allItems = [
          ...station.checklist.preparation,
          ...station.checklist.assessment,
          ...station.checklist.interventions,
          ...station.checklist.communication,
          ...station.checklist.safetyRedFlags,
          ...station.checklist.documentation
        ];
        const checkedCount = Object.values(checklist).filter(v => v).length;
        const percentage = allItems.length > 0 ? Math.round((checkedCount / allItems.length) * 100) : 0;
        
        totalItems += allItems.length;
        totalChecked += checkedCount;
        
        const domainBreakdown = {};
        const domains = ['preparation', 'assessment', 'interventions', 'communication', 'safetyRedFlags', 'documentation'];
        domains.forEach(domain => {
          const items = station.checklist[domain] || [];
          const checked = items.filter(item => checklist[item]).length;
          domainBreakdown[domain] = {
            checked,
            total: items.length,
            percentage: items.length > 0 ? Math.round((checked / items.length) * 100) : 0
          };
        });

        stationResults.push({
          station,
          percentage,
          checkedCount,
          totalCount: allItems.length,
          domainBreakdown,
          isFlagged: flaggedStations.includes(stId)
        });
      });

      const overallPercentage = totalItems > 0 ? Math.round((totalChecked / totalItems) * 100) : 0;
      const grade = overallPercentage >= 90 ? 'Outstanding' : overallPercentage >= 75 ? 'Strong Pass' : overallPercentage >= 60 ? 'Pass' : overallPercentage >= 50 ? 'Borderline' : 'Needs Work';
      
      const currentDate = new Date().toLocaleDateString('en-GB', { 
        day: '2-digit', 
        month: 'short', 
        year: 'numeric' 
      });
      
      let yPos = 20;
      
      // Header
      doc.setFillColor(167, 70, 224);
      doc.rect(0, 0, 210, 40, 'F');
      doc.setTextColor(255, 255, 255);
      doc.setFontSize(24);
      doc.setFont(undefined, 'bold');
      doc.text('OSCE Practice Results', 105, 20, { align: 'center' });
      doc.setFontSize(12);
      doc.setFont(undefined, 'normal');
      doc.text(`Nursing Theory Quiz`, 105, 28, { align: 'center' });
      doc.text(`Date: ${currentDate}`, 105, 34, { align: 'center' });
      
      yPos = 50;
      doc.setTextColor(0, 0, 0);
      
      // Summary Box
      doc.setFillColor(240, 240, 240);
      doc.rect(15, yPos, 180, 40, 'F');
      doc.setDrawColor(167, 70, 224);
      doc.setLineWidth(1);
      doc.rect(15, yPos, 180, 40, 'S');
      
      doc.setFontSize(16);
      doc.setFont(undefined, 'bold');
      doc.text('Performance Summary', 20, yPos + 10);
      
      doc.setFontSize(11);
      doc.setFont(undefined, 'normal');
      doc.text(`Overall: ${overallPercentage}%`, 20, yPos + 20);
      doc.text(`Stations: ${sessionStations.length}`, 20, yPos + 27);
      doc.text(`Completed: ${totalChecked}`, 80, yPos + 20);
      doc.text(`Missed: ${totalItems - totalChecked}`, 80, yPos + 27);
      
      doc.setFont(undefined, 'bold');
      doc.text(`Grade: ${grade}`, 140, yPos + 23.5);
      
      yPos += 50;
      
      // Domain Performance
      const domainLabels = {
        preparation: 'Preparation',
        assessment: 'Assessment',
        interventions: 'Interventions',
        communication: 'Communication',
        safetyRedFlags: 'Safety',
        documentation: 'Documentation'
      };
      
      const overallDomains = {};
      Object.keys(domainLabels).forEach(domain => {
        let domainChecked = 0;
        let domainTotal = 0;
        stationResults.forEach(sr => {
          domainChecked += sr.domainBreakdown[domain].checked;
          domainTotal += sr.domainBreakdown[domain].total;
        });
        overallDomains[domain] = {
          checked: domainChecked,
          total: domainTotal,
          percentage: domainTotal > 0 ? Math.round((domainChecked / domainTotal) * 100) : 0
        };
      });
      
      doc.setFontSize(14);
      doc.setFont(undefined, 'bold');
      doc.text('Performance by Domain', 15, yPos);
      yPos += 8;
      
      doc.setFontSize(10);
      doc.setFont(undefined, 'normal');
      
      Object.entries(overallDomains).forEach(([domain, data]) => {
        if (data.total === 0) return;
        
        if (yPos > 270) {
          doc.addPage();
          yPos = 20;
        }
        
        const barWidth = 130;
        const barHeight = 6;
        const fillWidth = (data.percentage / 100) * barWidth;
        
        doc.text(`${domainLabels[domain]}`, 20, yPos);
        doc.text(`${data.checked}/${data.total}`, 110, yPos);
        doc.text(`${data.percentage}%`, 135, yPos);
        
        yPos += 5;
        
        doc.setFillColor(220, 220, 220);
        doc.rect(20, yPos - 3, barWidth, barHeight, 'F');
        
        const barColor = data.percentage >= 75 ? [34, 197, 94] : data.percentage >= 50 ? [245, 158, 11] : [239, 68, 68];
        doc.setFillColor(...barColor);
        doc.rect(20, yPos - 3, fillWidth, barHeight, 'F');
        
        yPos += 8;
      });
      
      yPos += 5;
      
      // Station Breakdown
      doc.addPage();
      yPos = 20;
      
      doc.setFontSize(14);
      doc.setFont(undefined, 'bold');
      doc.text('Station-by-Station Breakdown', 15, yPos);
      yPos += 10;
      
      doc.setFontSize(10);
      
      stationResults.forEach((sr, idx) => {
        if (yPos > 250) {
          doc.addPage();
          yPos = 20;
        }
        
        const topic = topics.find(t => t.id === sr.station.topic);
        
        doc.setFont(undefined, 'bold');
        doc.text(`Station ${idx + 1}: ${sr.station.title}`, 20, yPos);
        yPos += 5;
        
        doc.setFont(undefined, 'normal');
        doc.setFontSize(9);
        doc.text(`${topic?.name || 'Unknown'} • ${sr.station.difficulty} • ${sr.station.estimatedMinutes} min`, 20, yPos);
        yPos += 5;
        
        doc.setFontSize(10);
        doc.setFont(undefined, 'bold');
        const scoreColor = sr.percentage >= 75 ? [34, 197, 94] : sr.percentage >= 50 ? [245, 158, 11] : [239, 68, 68];
        doc.setTextColor(...scoreColor);
        doc.text(`${sr.percentage}% (${sr.checkedCount}/${sr.totalCount})`, 160, yPos - 5);
        doc.setTextColor(0, 0, 0);
        
        yPos += 3;
        
        // Domain bars
        doc.setFont(undefined, 'normal');
        doc.setFontSize(8);
        Object.entries(sr.domainBreakdown).forEach(([domain, data]) => {
          if (data.total === 0) return;
          
          const miniBarWidth = 40;
          const miniBarHeight = 3;
          const miniFillWidth = (data.percentage / 100) * miniBarWidth;
          
          doc.text(domainLabels[domain].substring(0, 10), 20, yPos);
          doc.setFillColor(220, 220, 220);
          doc.rect(55, yPos - 2, miniBarWidth, miniBarHeight, 'F');
          
          const miniBarColor = data.percentage >= 75 ? [34, 197, 94] : data.percentage >= 50 ? [245, 158, 11] : [239, 68, 68];
          doc.setFillColor(...miniBarColor);
          doc.rect(55, yPos - 2, miniFillWidth, miniBarHeight, 'F');
          
          doc.text(`${data.percentage}%`, 98, yPos);
          yPos += 5;
        });
        
        yPos += 5;
        doc.setDrawColor(200, 200, 200);
        doc.line(20, yPos, 190, yPos);
        yPos += 8;
      });
      
      // Footer
      const pageCount = doc.internal.getNumberOfPages();
      for (let i = 1; i <= pageCount; i++) {
        doc.setPage(i);
        doc.setFontSize(8);
        doc.setTextColor(128, 128, 128);
        doc.text(`Page ${i} of ${pageCount}`, 105, 290, { align: 'center' });
        doc.text(`Generated by Nursing Theory Quiz`, 105, 285, { align: 'center' });
      }
      
      doc.save(`OSCE-Results-${currentDate.replace(/ /g, '-')}.pdf`);
    };

  // ==================== UTILITY FUNCTIONS ====================
    // (Note: shuffleArray and createParticles were in Part 1, ensuring we don't duplicate or miss them)
    
    // ==================== RENDER FUNCTIONS ====================
    function render() {
      const container = document.getElementById('main-content');
      
      switch(currentView) {
        case 'selection':
          renderSelection(container);
          break;
        case 'quiz':
          renderQuiz(container);
          break;
        case 'quizResults':
          renderQuizResults(container);
          break;
        case 'osce':
          renderOSCE(container);
          break;
        case 'osceResults':
          renderOSCEResults(container);
          break;
        default:
          container.innerHTML = `
            <div class="fade-in max-w-4xl mx-auto text-center">
              <h1 class="text-4xl text-white font-bold mb-4">Coming Soon</h1>
              <p class="text-slate-300 mb-8">Full functionality being implemented</p>
              <button onclick="currentView='selection'; render();" class="btn-gradient px-8 py-3 rounded-xl text-white">
                Back to Selection
              </button>
            </div>
          `;
      }
      
      if (window.lucide) {
        window.lucide.createIcons();
      }
    }

    function renderQuiz(container) {
      const currentQuestion = sessionQuestions[currentIndex];
      const isMulti = currentQuestion?.type === 'multiselect';
      const userAnswer = sessionAnswers[currentIndex];
      const confidence = sessionMeta?.[currentIndex]?.confidence || null;
      const submitted = Array.isArray(sessionSubmitted) && sessionSubmitted[currentIndex] === true;
      const hasSelection = isMulti ? (Array.isArray(userAnswer) && userAnswer.length > 0) : (userAnswer !== null && userAnswer !== undefined);

      // In practice mode, show feedback only after the user submits (needed for multi-select)
      const showFeedback = (quizMode === 'practice') && (isMulti ? submitted : (hasSelection && submitted));
      const isCorrect = showFeedback && window.isAnswerCorrect(currentQuestion, userAnswer);
      const multiDiag = (showFeedback && isMulti) ? computeMultiselectDiagnostics(currentQuestion.correct, userAnswer) : null;

      container.innerHTML = `
        <div class="fade-in max-w-4xl mx-auto">
          <div class="glass-card rounded-2xl p-8 mb-6">
            <div class="flex items-center justify-between mb-6">
              <button onclick="exitToSelection()" class="btn-secondary px-4 py-2 rounded-lg text-white text-sm">
                <i data-lucide="arrow-left" class="w-4 h-4 inline mr-1"></i>
                Exit Quiz
              </button>
              <div class="flex items-center gap-4">
                ${quizTimerEnabled ? `
                  <div class="flex items-center gap-2 px-3 py-1 rounded-lg bg-white bg-opacity-10">
                    <i data-lucide="clock" class="w-4 h-4 text-purple-400"></i>
                    <span id="quiz-timer" class="text-white font-mono font-bold">${Math.floor(timeRemaining / 60)}:${(timeRemaining % 60).toString().padStart(2, '0')}</span>
                  </div>
                ` : ''}
                <div class="text-white text-sm mono">
                  Question ${currentIndex + 1} / ${sessionQuestions.length}
                </div>
                ${quizMode === 'exam' ? '<span class="px-2 py-1 rounded bg-orange-500 bg-opacity-20 text-orange-300 text-xs font-bold">EXAM MODE</span>' : ''}
              </div>
            </div>
            
            <div class="mb-8">
              <div class="flex items-center gap-2 mb-4">
                <span class="inline-block px-3 py-1 rounded-full text-xs font-semibold" style="background: ${topics.find(t => t.id === currentQuestion.topic)?.color}22; color: ${topics.find(t => t.id === currentQuestion.topic)?.color};">
                  ${topics.find(t => t.id === currentQuestion.topic)?.name}
                </span>
                <span class="px-2 py-1 rounded text-xs font-medium ${currentQuestion.difficulty === 'easy' ? 'bg-green-500 bg-opacity-20 text-green-300' : currentQuestion.difficulty === 'medium' ? 'bg-yellow-500 bg-opacity-20 text-yellow-300' : 'bg-red-500 bg-opacity-20 text-red-300'}">
                  ${currentQuestion.difficulty}
                </span>
              </div>
              <h2 class="text-2xl text-white font-bold mb-6">${currentQuestion.question}</h2>
            </div>
            
            <div class="space-y-3 mb-8">
              ${currentQuestion.options.map((option, idx) => {
                const isSelected = isMulti
                  ? (Array.isArray(userAnswer) && userAnswer.includes(idx))
                  : (userAnswer === idx);

                const correctSet = isMulti
                  ? new Set(Array.isArray(currentQuestion.correct) ? currentQuestion.correct : [])
                  : new Set([currentQuestion.correct]);

                const showCorrect = showFeedback && correctSet.has(idx);
                const showIncorrect = showFeedback && isSelected && !correctSet.has(idx);

                return `
                  <button 
                    onclick="${isMulti ? `toggleMultiAnswer(${idx})` : `answerQuestion(${idx})`}" 
                    ${showFeedback ? 'disabled' : ''}
                    class="w-full p-4 rounded-xl text-left transition-all ${
                      showCorrect ? 'bg-green-500 bg-opacity-20 border-2 border-green-500' :
                      showIncorrect ? 'bg-red-500 bg-opacity-20 border-2 border-red-500' :
                      isSelected ? 'bg-purple-500 bg-opacity-20 border-2 border-purple-500' :
                      'bg-white bg-opacity-5 border-2 border-transparent hover:border-purple-400'
                    }"
                    ${showFeedback ? '' : 'style="cursor: pointer;"'}
                  >
                    <div class="flex items-center gap-3">
                      <div class="w-8 h-8 rounded-full flex items-center justify-center ${
                        showCorrect ? 'bg-green-500' :
                        showIncorrect ? 'bg-red-500' :
                        isSelected ? 'bg-purple-500' :
                        'bg-white bg-opacity-10'
                      }">
                        ${showCorrect
                          ? '<i data-lucide="check" class="w-5 h-5 text-white"></i>'
                          : showIncorrect
                            ? '<i data-lucide="x" class="w-5 h-5 text-white"></i>'
                            : isSelected
                              ? '<i data-lucide="check" class="w-5 h-5 text-white"></i>'
                              : '<span class="text-slate-300 text-sm font-bold">' + String.fromCharCode(65 + idx) + '</span>'
                        }
                      </div>
                      <div class="text-white">${option}</div>
                    </div>
                  </button>
                `;
              }).join('')}
            </div>
            
            ${showFeedback ? `
              <div class="glass-card p-6 rounded-xl mb-6">
                <div class="flex items-start gap-3">
                  <i data-lucide="lightbulb" class="w-6 h-6 ${isCorrect ? 'text-green-400' : 'text-yellow-400'} flex-shrink-0"></i>
                  <div>
                    <h3 class="text-white font-bold mb-2">${isCorrect ? 'Correct!' : 'Explanation'}</h3>
                    <p class="text-slate-300">${currentQuestion.explanation}</p>
                    ${multiDiag ? `
                      <div class="mt-3 p-3 rounded-xl bg-white bg-opacity-5 border border-white border-opacity-10">
                        <div class="text-slate-200 text-sm font-semibold mb-1">Multi-select breakdown</div>
                        <div class="text-slate-300 text-sm">
                          You selected <span class="text-white font-bold">${multiDiag.correctSelected}</span> / <span class="text-white font-bold">${multiDiag.totalCorrect}</span> correct.
                          ${multiDiag.extras.length ? `<br><span class="text-red-300">Extra options picked:</span> ${multiDiag.extras.map(i => currentQuestion.options?.[i]).join(', ')}` : ''}
                          ${multiDiag.missed.length ? `<br><span class="text-yellow-200">Correct options missed:</span> ${multiDiag.missed.map(i => currentQuestion.options?.[i]).join(', ')}` : ''}
                          <br><span class="text-slate-400">Precision:</span> ${(multiDiag.precision*100).toFixed(0)}% · <span class="text-slate-400">Recall:</span> ${(multiDiag.recall*100).toFixed(0)}%
                        </div>
                      </div>
                    ` : ''}
                  </div>
                </div>
              </div>
            ` : ''}
            

            <div class="mt-6 mb-4">
              <div class="flex items-center justify-between mb-2">
                <span class="text-slate-300 text-sm">Confidence (optional)</span>
                <span class="text-slate-400 text-xs">${confidence ? confidence.toUpperCase() : '—'}</span>
              </div>
              <div class="flex flex-wrap gap-2">
                <button onclick="setConfidence('low')" class="px-4 py-2 rounded-xl text-sm font-semibold transition-all ${confidence === 'low' ? 'bg-red-500 bg-opacity-30 text-red-200 border border-red-400 border-opacity-50' : 'bg-white bg-opacity-5 text-slate-300 hover:bg-opacity-10 border border-white border-opacity-10'}">
                  Low
                </button>
                <button onclick="setConfidence('med')" class="px-4 py-2 rounded-xl text-sm font-semibold transition-all ${confidence === 'med' ? 'bg-yellow-500 bg-opacity-25 text-yellow-200 border border-yellow-400 border-opacity-50' : 'bg-white bg-opacity-5 text-slate-300 hover:bg-opacity-10 border border-white border-opacity-10'}">
                  Medium
                </button>
                <button onclick="setConfidence('high')" class="px-4 py-2 rounded-xl text-sm font-semibold transition-all ${confidence === 'high' ? 'bg-green-500 bg-opacity-25 text-green-200 border border-green-400 border-opacity-50' : 'bg-white bg-opacity-5 text-slate-300 hover:bg-opacity-10 border border-white border-opacity-10'}">
                  High
                </button>
              </div>
            </div>
            <div class="flex justify-between items-center">
              <button 
                onclick="previousQuestion()" 
                ${currentIndex === 0 ? 'disabled' : ''}
                class="btn-secondary px-6 py-3 rounded-xl text-white disabled:opacity-30"
              >
                <i data-lucide="chevron-left" class="w-5 h-5 inline mr-1"></i>
                Previous
              </button>

              ${isMulti && quizMode === 'practice' ? `
                <div class="flex items-center gap-2">
                  ${submitted ? `
                    <button onclick="editMultiAnswer()" class="btn-secondary px-4 py-3 rounded-xl text-white">
                      Edit selection
                    </button>
                  ` : `
                    <button 
                      onclick="submitMultiAnswer()" 
                      ${!hasSelection ? 'disabled' : ''}
                      class="btn-gradient px-5 py-3 rounded-xl text-white font-bold disabled:opacity-40"
                    >
                      Check answer
                      <i data-lucide="check-circle" class="w-5 h-5 inline ml-2"></i>
                    </button>
                  `}
                </div>
              ` : ''}

              ${currentIndex === sessionQuestions.length - 1 ? `
                <button 
                  onclick="finishQuiz()" 
                  class="btn-gradient px-8 py-3 rounded-xl text-white font-bold"
                >
                  Finish Quiz
                  <i data-lucide="flag" class="w-5 h-5 inline ml-2"></i>
                </button>
              ` : `
                <button 
                  onclick="nextQuestion()" 
                  class="btn-gradient px-6 py-3 rounded-xl text-white"
                >
                  Next
                  <i data-lucide="chevron-right" class="w-5 h-5 inline ml-1"></i>
                </button>
              `}
            </div>
          </div>
          
          <div class="glass-card rounded-xl p-4">
            <div class="flex items-center gap-2 mb-2">
              <i data-lucide="list-checks" class="w-4 h-4 text-slate-400"></i>
              <span class="text-slate-400 text-sm">Progress</span>
            </div>
            <div class="flex gap-1">
              ${sessionQuestions.map((_, idx) => `
                <div class="flex-1 h-2 rounded-full ${
                  sessionAnswers[idx] !== null ? 'bg-purple-500' : 'bg-white bg-opacity-10'
                }"></div>
              `).join('')}
            </div>
          </div>
        </div>
      `;
    }
    
   function renderQuizResults(container) {
  // ---------- SAFE HELPERS ----------
  const safe = (str) => String(str ?? '')
    .replaceAll('&', '&amp;')
    .replaceAll('<', '&lt;')
    .replaceAll('>', '&gt;')
    .replaceAll('"', '&quot;')
    .replaceAll("'", '&#039;');

  // Ensure flaggedQuestions exists (your file didn’t have it before)
  window.flaggedQuestions = Array.isArray(window.flaggedQuestions) ? window.flaggedQuestions : [];
  const flaggedQuestions = window.flaggedQuestions;

  // Protect against missing data
  const totalQ = Array.isArray(sessionQuestions) ? sessionQuestions.length : 0;
  const answers = Array.isArray(sessionAnswers) ? sessionAnswers : [];
  const questions = Array.isArray(sessionQuestions) ? sessionQuestions : [];

  const correctCount = questions.reduce((acc, q, idx) => {
    const a = answers[idx];
    return acc + (window.isAnswerCorrect(q, a) ? 1 : 0);
  }, 0);

  const incorrectCount = totalQ - correctCount;
  const percentage = totalQ ? Math.round((correctCount / totalQ) * 100) : 0;

  // Optional timer support (won’t crash if you don’t track it)
  const totalSeconds = Number(window.quizTimeSeconds || 0);
  const timeLabel = totalSeconds > 0
    ? `${String(Math.floor(totalSeconds / 60)).padStart(2, '0')}:${String(totalSeconds % 60).padStart(2, '0')}`
    : '--:--';
  const avgPace = totalQ && totalSeconds > 0 ? Math.round(totalSeconds / totalQ) : 0;

  // ---------- TOPIC PERFORMANCE ----------
  const topicAnalysis = {};
  questions.forEach((q, idx) => {
    const t = q.topic || 'unknown';
    if (!topicAnalysis[t]) topicAnalysis[t] = { correct: 0, total: 0 };
    topicAnalysis[t].total++;

    const a = answers[idx];
    if (window.isAnswerCorrect(q, a)) topicAnalysis[t].correct++;
  });

  const topicPerformance = Object.entries(topicAnalysis)
    .map(([topicId, data]) => {
      const topic = topics.find(t => t.id === topicId) || { id: topicId, name: topicId.toUpperCase(), color: '#a855f7', icon: 'tag' };
      const pct = data.total ? Math.round((data.correct / data.total) * 100) : 0;
      return { topicId, topic, ...data, percentage: pct };
    })
    .sort((a, b) => a.percentage - b.percentage);

  const weakTopics = topicPerformance.filter(t => t.total > 0 && t.percentage < 75);
  const weakest = weakTopics[0];

  // ---------- GRADE ----------
  let grade = 'Review Needed';
  let gradeColor = '#ef4444';
  let gradeIcon = 'book-open';
  let gradeMessage = 'Every quiz builds stronger knowledge. Focus on the areas below.';

  if (percentage >= 90) {
    grade = 'Outstanding'; gradeColor = '#22c55e'; gradeIcon = 'trophy';
    gradeMessage = 'Exceptional work — your knowledge is exam-ready.';
  } else if (percentage >= 75) {
    grade = 'Strong Pass'; gradeColor = '#84cc16'; gradeIcon = 'check-circle';
    gradeMessage = 'Great performance — a few tweaks and you’re at mastery level.';
  } else if (percentage >= 60) {
    grade = 'Pass'; gradeColor = '#f59e0b'; gradeIcon = 'trending-up';
    gradeMessage = 'Solid foundation — target your weaker topics to improve quickly.';
  } else if (percentage >= 50) {
    grade = 'Borderline'; gradeColor = '#f97316'; gradeIcon = 'alert-circle';
    gradeMessage = 'You’re close — focus revision on the weakest topic first.';
  }

  // ---------- INSIGHTS ----------
  const insights = [];
  if (weakest) {
    insights.push({
      icon: 'target',
      color: '#f59e0b',
      title: 'Focus Area',
      text: `${safe(weakest.topic.name)}: ${weakest.correct}/${weakest.total} correct (${weakest.percentage}%). Prioritize revision here.`
    });
  }
  if (incorrectCount > 0) {
    insights.push({
      icon: 'arrow-right',
      color: '#a855f7',
      title: 'Next Best Action',
      text: `Review the ${incorrectCount} incorrect answer${incorrectCount !== 1 ? 's' : ''} below—small gaps, easy wins!`
    });
  }

  // ---------- REVIEW LISTS ----------
  const incorrectIdxs = questions
    .map((q, idx) => ({ q, idx }))
    .filter(({ q, idx }) => {
      const a = answers[idx];
      return !window.isAnswerCorrect(q, a);
    });

  const flaggedSet = new Set(flaggedQuestions.map(Number).filter(Number.isFinite));

  window.__quizReviewFilter = window.__quizReviewFilter || 'all'; // 'all' | 'incorrect' | 'flagged'

  const getReviewList = () => {
    if (window.__quizReviewFilter === 'incorrect') return incorrectIdxs;
    if (window.__quizReviewFilter === 'flagged') {
      return questions.map((q, idx) => ({ q, idx })).filter(({ idx }) => flaggedSet.has(idx));
    }
    return questions.map((q, idx) => ({ q, idx }));
  };

  const reviewList = getReviewList();

  // ---------- ACTIONS ----------
  window.setQuizReviewFilter = (filter) => { window.__quizReviewFilter = filter; render(); };

  window.scrollToQuizReview = () => {
    const el = document.getElementById('quiz-review');
    if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
  };

  window.toggleFlagQuestion = (idx) => {
    const i = Number(idx);
    if (!Number.isFinite(i)) return;
    const pos = flaggedQuestions.indexOf(i);
    if (pos > -1) flaggedQuestions.splice(pos, 1);
    else flaggedQuestions.push(i);
    render();
  };

  window.tryAnotherQuiz = () => {
    currentView = 'selection';
    sessionQuestions = [];
    sessionAnswers = [];
    sessionSubmitted = [];
    currentIndex = 0;
    window.quizTimeSeconds = 0;
    window.quizStartedAt = 0;
    flaggedQuestions.length = 0;
    render();
  };

  // ---------- EXTRA PANELS (What you asked for) ----------
  const whatToWorkOnNext = weakest
    ? `Focus revision on <strong>${safe(weakest.topic.name)}</strong> (${weakest.percentage}% accuracy).`
    : 'Pick one topic and re-try a short set to build momentum.';

  const personalPlanTopicBullets = weakest
    ? `<li class="flex items-start gap-2"><span class="text-purple-400 font-bold flex-shrink-0">•</span><span><strong>${safe(weakest.topic.name)}:</strong> Focus on ${weakest.total - weakest.correct} missed question${(weakest.total - weakest.correct) !== 1 ? 's' : ''} — review explanations thoroughly</span></li>`
    : `<li class="flex items-start gap-2"><span class="text-purple-400 font-bold flex-shrink-0">•</span><span><strong>Keep going:</strong> Re-test a small set daily to build retention</span></li>`;



  // ---------- DEEPER INSIGHTS ----------
  // Build per-question events for this session
  const nowIso = new Date().toISOString();
  const approxPerQ = (totalQ && totalSeconds > 0) ? (totalSeconds / totalQ) : 0;

  const sessionEvents = questions.map((q, idx) => {
    const a = answers[idx];
    const correct = window.isAnswerCorrect(q, a);
    const meta = Array.isArray(sessionMeta) ? sessionMeta[idx] : null;

    const timeSecRaw = meta && typeof meta.timeSpentSec === 'number' ? meta.timeSpentSec : 0;
    const timeSec = timeSecRaw > 0 ? timeSecRaw : approxPerQ;

    const confidence = meta?.confidence || null;
    const changes = meta?.changes || 0;
    const concepts = inferConceptTags(q);

    // Multi-select diagnostics for Practice mode: missing vs extra
    let multiselectDiag = null;
    if (q?.type === 'multiselect') {
      multiselectDiag = computeMultiselectDiagnostics(q.correct, a);
    }

    return {
      at: nowIso,
      id: q.id || `q_${idx}`,
      topic: q.topic || 'unknown',
      difficulty: q.difficulty || 'mixed',
      type: (q.type || 'mcq'),
      correct,
      timeSec,
      confidence,
      changes,
      concepts,
      multiselectDiag,
    };
  });

  // Persist to history (localStorage)
  const history = loadHistory();
  saveHistory(history.concat(sessionEvents));

  const allEvents = history.concat(sessionEvents);

  // Speed/accuracy diagnostics
  const times = sessionEvents.map(e => e.timeSec || 0);
  const avgTimeSec = totalQ ? (times.reduce((a,b)=>a+b,0) / totalQ) : 0;

  const fastWrong = sessionEvents.filter(e => !e.correct && e.timeSec > 0 && e.timeSec <= 8);
  const slowWrong = sessionEvents.filter(e => !e.correct && e.timeSec >= 40);
  const slowRight = sessionEvents.filter(e => e.correct && e.timeSec >= 40);

  const totalChanges = sessionEvents.reduce((acc, e) => acc + (e.changes || 0), 0);

  // Confidence calibration
  const confBuckets = { low: { total: 0, correct: 0 }, med: { total: 0, correct: 0 }, high: { total: 0, correct: 0 } };
  sessionEvents.forEach(e => {
    if (!e.confidence || !confBuckets[e.confidence]) return;
    confBuckets[e.confidence].total += 1;
    if (e.correct) confBuckets[e.confidence].correct += 1;
  });

  // Concept mastery from all attempts
  const conceptMastery = computeConceptMastery(allEvents);

  const weakestConcepts = conceptMastery
    .filter(c => c.attempts >= 3)
    .slice(0, 6);

  const strongestConcepts = conceptMastery
    .filter(c => c.attempts >= 3)
    .slice(-4)
    .reverse();

  // Build a next-session plan: focus on 2 weakest concepts with enough data, else weakest topics
  const planConcepts = weakestConcepts.slice(0, 2).map(x => x.tag);
  const planFocus = planConcepts.length ? planConcepts : (topicPerformance || [])
    .filter(tp => tp.total >= 4)
    .sort((a,b)=>a.percentage-b.percentage)
    .slice(0,2)
    .map(tp => tp.topic?.name || tp.topicId);

  const planText = planFocus.length
    ? `Focus next on: <span class="text-white font-bold">${planFocus.map(safe).join('</span>, <span class="text-white font-bold">')}</span>.`
    : `Do a short mixed set next to build a clearer profile.`;

  // Question-type performance (best performing type appears first)
  const typeLabels = { mcq: 'MCQ', tf: 'True/False', multiselect: 'Select all that apply' };
  const typeStats = { mcq: { total: 0, correct: 0 }, tf: { total: 0, correct: 0 }, multiselect: { total: 0, correct: 0 } };
  sessionEvents.forEach(e => {
    const t = (e.type && typeStats[e.type]) ? e.type : 'mcq';
    typeStats[t].total += 1;
    if (e.correct) typeStats[t].correct += 1;
  });

  const typePerf = Object.entries(typeStats)
    .filter(([_, v]) => v.total > 0)
    .map(([k, v]) => ({
      key: k,
      label: typeLabels[k] || k,
      total: v.total,
      correct: v.correct,
      pct: Math.round((v.correct / v.total) * 100)
    }))
    .sort((a,b) => b.pct - a.pct);

  const typeBarsHtml = typePerf.length ? `
    <div class="mt-6 bg-white bg-opacity-5 rounded-2xl p-6 border border-white/10">
      <div class="flex items-center justify-between mb-3">
        <div class="text-white font-bold flex items-center gap-2">
          <i data-lucide="bar-chart-3" class="w-5 h-5 text-pink-400"></i>
          Best performing question type
        </div>
        <div class="text-slate-400 text-xs">This session</div>
      </div>

      <div class="space-y-3">
        ${typePerf.map(t => `
          <div>
            <div class="flex items-center justify-between text-sm mb-1">
              <span class="text-slate-200 font-semibold">${safe(t.label)}</span>
              <span class="text-slate-300">${t.pct}% <span class="text-slate-500">(${t.correct}/${t.total})</span></span>
            </div>
            <div class="h-2 rounded-full bg-white bg-opacity-10 overflow-hidden">
              <div class="h-full rounded-full bg-gradient-to-r from-purple-500 to-pink-400" style="width:${t.pct}%;"></div>
            </div>
          </div>
        `).join('')}
      </div>

      <div class="text-slate-400 text-xs mt-3">
        Tip: if one type is consistently lower, do a short set focusing on that style to boost exam reliability.
      </div>
    </div>
  ` : '';


  const deepInsightsHtml = `
    <!-- DEEP INSIGHTS -->
    <div class="glass-card rounded-2xl p-8 mb-8">
      <h2 class="text-white text-2xl font-bold mb-6 flex items-center gap-3">
        <i data-lucide="brain" class="w-7 h-7 text-pink-400"></i>
        Deep Insights
      </h2>

      <div class="grid md:grid-cols-4 gap-4 mb-8">
        <div class="bg-white bg-opacity-5 rounded-2xl p-5 border border-white border-opacity-10">
          <div class="text-slate-400 text-xs uppercase tracking-wider mb-1">Avg time / Q</div>
          <div class="text-white text-2xl font-extrabold">${avgTimeSec ? `${Math.floor(avgTimeSec/60)}:${String(Math.round(avgTimeSec%60)).padStart(2,'0')}` : '—'}</div>
          <div class="text-slate-400 text-xs mt-1">Speed signal, not a grade.</div>
        </div>

        <div class="bg-white bg-opacity-5 rounded-2xl p-5 border border-white border-opacity-10">
          <div class="text-slate-400 text-xs uppercase tracking-wider mb-1">Fast wrong</div>
          <div class="text-white text-2xl font-extrabold">${fastWrong.length}</div>
          <div class="text-slate-400 text-xs mt-1">≤ 8s (likely guessing / misread)</div>
        </div>

        <div class="bg-white bg-opacity-5 rounded-2xl p-5 border border-white border-opacity-10">
          <div class="text-slate-400 text-xs uppercase tracking-wider mb-1">Slow wrong</div>
          <div class="text-white text-2xl font-extrabold">${slowWrong.length}</div>
          <div class="text-slate-400 text-xs mt-1">≥ 40s (confusion / gap)</div>
        </div>

        <div class="bg-white bg-opacity-5 rounded-2xl p-5 border border-white border-opacity-10">
          <div class="text-slate-400 text-xs uppercase tracking-wider mb-1">Answer edits</div>
          <div class="text-white text-2xl font-extrabold">${totalChanges}</div>
          <div class="text-slate-400 text-xs mt-1">Higher in Exam mode.</div>
        </div>
      </div>

      <div class="grid md:grid-cols-2 gap-6">
        <div class="bg-white bg-opacity-5 rounded-2xl p-6 border border-white border-opacity-10">
          <div class="flex items-center justify-between mb-3">
            <div class="text-white font-bold flex items-center gap-2">
              <i data-lucide="target" class="w-5 h-5 text-purple-400"></i>
              Concept mastery (weakest)
            </div>
            <div class="text-slate-400 text-xs">Based on your recent attempts</div>
          </div>

          ${weakestConcepts.length ? `
            <div class="space-y-3">
              ${weakestConcepts.map(c => {
                const pct = Math.round(c.mastery * 100);
                return `
                  <div>
                    <div class="flex items-center justify-between text-sm mb-1">
                      <span class="text-slate-200 font-semibold">${safe(c.tag)}</span>
                      <span class="text-slate-400">${pct}% · ${c.attempts} attempts</span>
                    </div>
                    <div class="w-full h-2 rounded-full bg-white bg-opacity-10 overflow-hidden">
                      <div class="h-full rounded-full bg-purple-400" style="width:${pct}%;"></div>
                    </div>
                  </div>
                `;
              }).join('')}
            </div>
          ` : `
            <div class="text-slate-300 text-sm">
              Do a couple more sessions and this will become much more accurate (needs ≥ 3 attempts per concept).
            </div>
          `}
        </div>

        <div class="bg-white bg-opacity-5 rounded-2xl p-6 border border-white border-opacity-10">
          <div class="text-white font-bold flex items-center gap-2 mb-3">
            <i data-lucide="activity" class="w-5 h-5 text-cyan-400"></i>
            Confidence calibration
          </div>

          <div class="space-y-3">
            ${['high','med','low'].map(level => {
              const b = confBuckets[level];
              const acc = b.total ? Math.round((b.correct/b.total)*100) : null;
              const label = level === 'high' ? 'High' : level === 'med' ? 'Medium' : 'Low';
              return `
                <div class="flex items-center justify-between text-sm">
                  <span class="text-slate-200">${label}</span>
                  <span class="text-slate-400">
                    ${b.total ? `${acc}% correct (${b.correct}/${b.total})` : '—'}
                  </span>
                </div>
              `;
            }).join('')}
          </div>

          <div class="mt-4 text-slate-300 text-sm">
            Goal: when you select <span class="text-white font-semibold">High</span>, your accuracy should climb over time.
            If High is often wrong → revisit core rules (overconfidence). If Low is often right → push exam timing.
          </div>

          <div class="mt-5 p-4 rounded-2xl bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-white/10">
            <div class="text-white font-bold mb-1">Next session plan</div>
            <div class="text-slate-200 text-sm">${planText}</div>
            <div class="text-slate-400 text-xs mt-2">
              Suggested: 12–18 questions · Practice mode (explanations) if slow-wrong dominates; Exam mode (45m) if accuracy is strong but timing is slow.
            </div>
          </div>
        </div>
      </div>

      ${strongestConcepts.length ? `
        <div class="mt-8">
          <div class="text-slate-300 text-sm mb-3">Strong areas (keep warm):</div>
          <div class="flex flex-wrap gap-2">
            ${strongestConcepts.map(c => `<span class="px-3 py-1 rounded-full bg-white bg-opacity-5 border border-white/10 text-slate-200 text-sm">${safe(c.tag)} · ${Math.round(c.mastery*100)}%</span>`).join('')}
          </div>
        </div>
      ` : ''}

      ${(fastWrong.length || slowWrong.length || slowRight.length) ? `
        <div class="mt-8">
          <div class="text-white font-bold mb-3 flex items-center gap-2">
            <i data-lucide="list-checks" class="w-5 h-5 text-yellow-300"></i>
            Question behavior signals
          </div>
          <div class="grid md:grid-cols-3 gap-4">
            <div class="bg-white bg-opacity-5 rounded-2xl p-5 border border-white/10">
              <div class="text-slate-200 font-semibold mb-1">Fast wrong</div>
              <div class="text-slate-400 text-xs mb-3">Often: misread / rushing / guessing</div>
              <div class="text-slate-300 text-sm">${fastWrong.slice(0,5).map(e => safe(questions.find(q=>q.id===e.id)?.question || e.id)).join('<br>') || '—'}</div>
            </div>
            <div class="bg-white bg-opacity-5 rounded-2xl p-5 border border-white/10">
              <div class="text-slate-200 font-semibold mb-1">Slow wrong</div>
              <div class="text-slate-400 text-xs mb-3">Often: concept gap / confusion</div>
              <div class="text-slate-300 text-sm">${slowWrong.slice(0,5).map(e => safe(questions.find(q=>q.id===e.id)?.question || e.id)).join('<br>') || '—'}</div>
            </div>
            <div class="bg-white bg-opacity-5 rounded-2xl p-5 border border-white/10">
              <div class="text-slate-200 font-semibold mb-1">Slow but right</div>
              <div class="text-slate-400 text-xs mb-3">Knowledge OK — work on speed</div>
              <div class="text-slate-300 text-sm">${slowRight.slice(0,5).map(e => safe(questions.find(q=>q.id===e.id)?.question || e.id)).join('<br>') || '—'}</div>
            </div>
          </div>
        </div>
      ` : ''}
      ${typeBarsHtml}
    </div>
  `;
  // ---------- UI ----------
  container.innerHTML = `
    <div class="fade-in max-w-6xl mx-auto">

      <!-- HERO -->
      <div class="glass-card rounded-3xl p-8 md:p-12 text-center mb-8 relative overflow-hidden">
        <div class="absolute inset-0 opacity-10">
          <div class="absolute top-0 left-0 w-64 h-64 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full blur-3xl"></div>
          <div class="absolute bottom-0 right-0 w-64 h-64 bg-gradient-to-tl from-cyan-400 to-purple-400 rounded-full blur-3xl"></div>
        </div>

        <div class="relative z-10">
          <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full mb-6 ${grade === 'Review Needed' ? 'pulse-red-badge' : ''}" style="background:${gradeColor}22; border:2px solid ${gradeColor};">
            <i data-lucide="${gradeIcon}" class="w-5 h-5" style="color:${gradeColor};"></i>
            <span class="font-bold text-sm" style="color:${gradeColor};">${grade}</span>
          </div>

          <h1 class="text-5xl md:text-6xl font-extrabold text-white mb-4 tracking-tight">Quiz Complete!</h1>
          <p class="text-xl text-slate-300 max-w-2xl mx-auto">${gradeMessage}</p>
        </div>
      </div>

      <!-- KPI ROW -->
      <div class="grid grid-cols-2 md:grid-cols-6 gap-4 mb-8">
        <div class="glass-card rounded-2xl p-5 hover:scale-105 transition-transform">
          <i data-lucide="percent" class="w-5 h-5 text-purple-400 mb-2"></i>
          <div class="text-3xl font-extrabold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent mb-1">${percentage}%</div>
          <div class="text-slate-400 text-xs uppercase tracking-wider">Accuracy</div>
        </div>

        <div class="glass-card rounded-2xl p-5 hover:scale-105 transition-transform">
          <i data-lucide="check-circle" class="w-5 h-5 text-green-400 mb-2"></i>
          <div class="text-3xl font-extrabold text-green-400 mb-1">${correctCount}</div>
          <div class="text-slate-400 text-xs uppercase tracking-wider">Correct</div>
        </div>

        <div class="glass-card rounded-2xl p-5 hover:scale-105 transition-transform">
          <i data-lucide="x-circle" class="w-5 h-5 text-red-400 mb-2"></i>
          <div class="text-3xl font-extrabold text-red-400 mb-1">${incorrectCount}</div>
          <div class="text-slate-400 text-xs uppercase tracking-wider">Incorrect</div>
        </div>

        <div class="glass-card rounded-2xl p-5 hover:scale-105 transition-transform">
          <i data-lucide="clock" class="w-5 h-5 text-cyan-400 mb-2"></i>
          <div class="text-3xl font-extrabold text-cyan-400 mb-1">${timeLabel}</div>
          <div class="text-slate-400 text-xs uppercase tracking-wider">Time</div>
        </div>

        <div class="glass-card rounded-2xl p-5 hover:scale-105 transition-transform">
          <i data-lucide="zap" class="w-5 h-5 text-yellow-400 mb-2"></i>
          <div class="text-3xl font-extrabold text-yellow-400 mb-1">${avgPace ? `${Math.floor(avgPace/60)}:${String(avgPace%60).padStart(2,'0')}` : '—'}</div>
          <div class="text-slate-400 text-xs uppercase tracking-wider">Avg Pace</div>
        </div>

        <div class="glass-card rounded-2xl p-5 hover:scale-105 transition-transform">
          <i data-lucide="flag" class="w-5 h-5 text-pink-400 mb-2"></i>
          <div class="text-3xl font-extrabold text-pink-400 mb-1">${flaggedQuestions.length}</div>
          <div class="text-slate-400 text-xs uppercase tracking-wider">Flagged</div>
        </div>
      </div>

      <!-- SMART INSIGHTS -->
      ${insights.length ? `
        <div class="glass-card rounded-2xl p-8 mb-8">
          <h2 class="text-white text-2xl font-bold mb-6 flex items-center gap-3">
            <i data-lucide="brain" class="w-7 h-7 text-pink-400"></i>
            Smart Insights
          </h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            ${insights.map(ins => `
              <div class="p-4 rounded-xl border-2 transition-all hover:scale-105" style="background:${ins.color}11; border-color:${ins.color}33;">
                <div class="flex items-start gap-3">
                  <div class="p-2 rounded-lg" style="background:${ins.color}22;">
                    <i data-lucide="${ins.icon}" class="w-5 h-5" style="color:${ins.color};"></i>
                  </div>
                  <div class="flex-1">
                    <h4 class="text-white font-bold mb-1">${ins.title}</h4>
                    <p class="text-slate-300 text-sm leading-relaxed">${ins.text}</p>
                  </div>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      ` : ''}

      ${deepInsightsHtml}

      <!-- PERFORMANCE BY TOPIC -->
      <div class="glass-card rounded-2xl p-8 mb-8">
        <h2 class="text-white text-2xl font-bold mb-6 flex items-center gap-3">
          <i data-lucide="bar-chart-3" class="w-7 h-7 text-purple-400"></i>
          Performance by Topic
        </h2>

        <div class="space-y-4">
          ${topicPerformance.map(tp => {
            const isPriority = tp.percentage < 75 && tp.total > 0;
            const color = tp.topic.color || '#a855f7';
            return `
              <div class="p-4 rounded-xl ${isPriority ? 'bg-orange-500 bg-opacity-10 border-2 border-orange-500 border-opacity-30' : 'bg-white bg-opacity-5'}">
                <div class="flex items-center justify-between mb-3">
                  <div class="flex items-center gap-3">
                    <div class="p-2 rounded-lg" style="background:${color}22;">
                      <i data-lucide="${tp.topic.icon || 'tag'}" class="w-5 h-5" style="color:${color};"></i>
                    </div>
                    <div>
                      <div class="flex items-center gap-2">
                        <span class="text-white font-semibold">${safe(tp.topic.name)}</span>
                        ${isPriority ? '<span class="px-2 py-0.5 bg-orange-500 text-white text-xs font-bold rounded-full">PRIORITY</span>' : ''}
                      </div>
                      <span class="text-slate-400 text-sm">${tp.correct}/${tp.total} correct</span>
                    </div>
                  </div>
                  <div class="text-2xl font-bold ${tp.percentage >= 75 ? 'text-green-400' : tp.percentage >= 50 ? 'text-yellow-400' : 'text-red-400'}">${tp.percentage}%</div>
                </div>
                <div class="w-full bg-white bg-opacity-5 rounded-full h-3 overflow-hidden">
                  <div class="h-3 rounded-full transition-all duration-1000 ease-out" style="width:${tp.percentage}%; background:linear-gradient(90deg, ${color}, ${tp.percentage >= 75 ? '#22c55e' : tp.percentage >= 50 ? '#f59e0b' : '#ef4444'});"></div>
                </div>
              </div>
            `;
          }).join('')}
        </div>
      </div>

      <!-- WHAT YOU DID WELL + WHAT NEXT -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <div class="glass-card rounded-2xl p-6 border-2 border-green-500 border-opacity-30">
          <h3 class="text-white text-xl font-bold mb-4 flex items-center gap-2">
            <i data-lucide="thumbs-up" class="w-6 h-6 text-green-400"></i>
            What You Did Well
          </h3>
          <ul class="space-y-3">
            <li class="flex items-start gap-2 text-slate-300 text-sm">
              <i data-lucide="check" class="w-4 h-4 text-green-400 mt-0.5"></i>
              <span>You completed the session — this is active retrieval practice strengthening your memory!</span>
            </li>
            <li class="flex items-start gap-2 text-slate-300 text-sm">
              <i data-lucide="check" class="w-4 h-4 text-green-400 mt-0.5"></i>
              <span>You reviewed multiple topics — the best way to build exam stamina.</span>
            </li>
          </ul>
        </div>

        <div class="glass-card rounded-2xl p-6 border-2 border-orange-500 border-opacity-30">
          <h3 class="text-white text-xl font-bold mb-4 flex items-center gap-2">
            <i data-lucide="alert-circle" class="w-6 h-6 text-orange-400"></i>
            What to Work On Next
          </h3>
          <ul class="space-y-3">
            <li class="flex items-start gap-2 text-slate-300 text-sm">
              <i data-lucide="target" class="w-4 h-4 text-pink-400 mt-0.5"></i>
              <span>${whatToWorkOnNext}</span>
            </li>
            <li class="flex items-start gap-2 text-slate-300 text-sm">
              <i data-lucide="book-open" class="w-4 h-4 text-purple-400 mt-0.5"></i>
              <span>Review all <strong>${incorrectCount}</strong> incorrect answer${incorrectCount !== 1 ? 's' : ''} — focus on understanding <em>why</em>, not memorising.</span>
            </li>
          </ul>
        </div>
      </div>

      <!-- PERSONALIZED STUDY PLAN -->
      <div class="glass-card rounded-2xl p-8 mb-8 border-2 border-purple-500 border-opacity-30">
        <h2 class="text-white text-2xl font-bold mb-6 flex items-center gap-3">
          <i data-lucide="map" class="w-7 h-7 text-purple-400"></i>
          Your Personalized Study Plan
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h4 class="text-purple-300 font-bold mb-4 flex items-center gap-2">
              <i data-lucide="zap" class="w-5 h-5"></i>
              Priority Study Topics
            </h4>
            <ul class="space-y-3 text-slate-300 text-sm">
              ${personalPlanTopicBullets}
            </ul>
          </div>

          <div>
            <h4 class="text-pink-300 font-bold mb-4 flex items-center gap-2">
              <i data-lucide="calendar-check" class="w-5 h-5"></i>
              Your Revision Strategy
            </h4>
            <ul class="space-y-3 text-slate-300 text-sm">
              <li class="flex items-start gap-2"><span class="text-pink-400 font-bold flex-shrink-0">•</span><span><strong>Daily practice:</strong> Tackle 5–10 questions per day on your weakest topic until comfortable</span></li>
              <li class="flex items-start gap-2"><span class="text-pink-400 font-bold flex-shrink-0">•</span><span><strong>Review mistakes:</strong> Spend 2× longer reviewing incorrect answers than taking the quiz</span></li>
              <li class="flex items-start gap-2"><span class="text-pink-400 font-bold flex-shrink-0">•</span><span><strong>Track trends:</strong> Re-take weekly to measure improvement</span></li>
              <li class="flex items-start gap-2"><span class="text-pink-400 font-bold flex-shrink-0">•</span><span><strong>Teach others:</strong> Explaining concepts to peers solidifies understanding</span></li>
            </ul>
          </div>
        </div>
      </div>
      <!-- ESSENTIAL MED FORMULAS -->
      <div class="glass-card rounded-2xl p-8 mb-8">
        <h2 class="text-white text-2xl font-bold mb-2 flex items-center gap-3">
          <i data-lucide="calculator" class="w-7 h-7 text-pink-400"></i>
          Essential Medication Formulas to Revise
        </h2>
        <p class="text-slate-300 text-sm mb-6">
          Master these formulas for safe medication administration. In clinical practice, always double-check calculations and have a second registered nurse verify high-risk drug doses.
        </p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
          <div class="rounded-2xl p-6" style="background: linear-gradient(135deg, rgba(236,72,153,.35), rgba(168,85,247,.25)); border: 1px solid rgba(255,255,255,.12);">
            <div class="text-white font-bold mb-2 flex items-center gap-2"><i data-lucide="scale" class="w-5 h-5"></i>Weight-Based Dosing</div>
            <div class="bg-black bg-opacity-20 rounded-lg p-3 text-slate-100 mono text-sm mb-3">Dose (mg) = Weight (kg) × mg/kg</div>
            <ul class="text-slate-100 text-sm space-y-1">
              <li>• Example: Child weighs 25kg, prescribed 10mg/kg paracetamol → <strong>250mg</strong></li>
              <li>• Critical check: Always verify dose is within safe range in <strong>BNFc</strong></li>
            </ul>
          </div>

          <div class="rounded-2xl p-6" style="background: linear-gradient(135deg, rgba(99,102,241,.35), rgba(34,211,238,.25)); border: 1px solid rgba(255,255,255,.12);">
            <div class="text-white font-bold mb-2 flex items-center gap-2"><i data-lucide="droplet" class="w-5 h-5"></i>Volume Calculation</div>
            <div class="bg-black bg-opacity-20 rounded-lg p-3 text-slate-100 mono text-sm mb-3">Volume = (Dose Required ÷ Stock Strength) × Stock Volume</div>
            <ul class="text-slate-100 text-sm space-y-1">
              <li>• Example: Need 250mg, stock is 100mg/5ml → <strong>12.5ml</strong></li>
              <li>• Memory aid: “What you want ÷ what you’ve got × volume it’s in”</li>
            </ul>
          </div>

          <div class="rounded-2xl p-6" style="background: linear-gradient(135deg, rgba(20,184,166,.35), rgba(34,197,94,.25)); border: 1px solid rgba(255,255,255,.12);">
            <div class="text-white font-bold mb-2 flex items-center gap-2"><i data-lucide="activity" class="w-5 h-5"></i>IV Infusion Rate</div>
            <div class="bg-black bg-opacity-20 rounded-lg p-3 text-slate-100 mono text-sm mb-3">Rate (ml/hr) = Volume (ml) ÷ Time (hours)</div>
            <ul class="text-slate-100 text-sm space-y-1">
              <li>• Example: Infuse 500ml over 4 hours → <strong>125ml/hr</strong></li>
              <li>• Sense-check: Does the rate make sense? Not too fast/slow?</li>
            </ul>
          </div>

          <div class="rounded-2xl p-6" style="background: linear-gradient(135deg, rgba(132,204,22,.35), rgba(234,179,8,.25)); border: 1px solid rgba(255,255,255,.12);">
            <div class="text-white font-bold mb-2 flex items-center gap-2"><i data-lucide="percent" class="w-5 h-5"></i>Percentage Strength</div>
            <div class="bg-black bg-opacity-20 rounded-lg p-3 text-slate-100 mono text-sm mb-3">X% = X grams per 100ml (or X mg per 1ml)</div>
            <ul class="text-slate-100 text-sm space-y-1">
              <li>• Example: 0.9% sodium chloride → 0.9g/100ml → <strong>9mg per ml</strong></li>
              <li>• Common use: Fluid concentrations, local anaesthetics</li>
            </ul>
          </div>
        </div>

        <div class="bg-red-500 bg-opacity-10 border border-red-500 border-opacity-30 rounded-xl p-5">
          <div class="text-red-200 font-bold mb-2 flex items-center gap-2"><i data-lucide="shield-alert" class="w-5 h-5"></i>Critical Safety Checks</div>
          <ul class="text-red-100 text-sm space-y-1">
            <li>• Write it down: Never do calculations mentally — always write them out</li>
            <li>• Check units: mg vs g, ml vs L — decimal errors cause 10-fold mistakes</li>
            <li>• Verify weight: Always use actual documented weight, never estimate</li>
            <li>• Second check: High-risk drugs require independent double-check</li>
            <li>• Sense check: Is the dose realistic? Does volume seem reasonable?</li>
            <li>• BNFc check: Confirm dose is within safe range for age and weight</li>
          </ul>
        </div>
      </div>



      <!-- QUESTION REVIEW -->
      <div id="quiz-review" class="glass-card rounded-2xl p-8 mb-8">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6">
          <h2 class="text-white text-2xl font-bold flex items-center gap-3">
            <i data-lucide="list-checks" class="w-7 h-7 text-cyan-400"></i>
            Question Review
          </h2>

          <div class="flex gap-2">
            <button onclick="setQuizReviewFilter('all')" class="btn-secondary px-4 py-2 rounded-lg text-sm text-white ${window.__quizReviewFilter === 'all' ? 'border border-purple-400' : ''}">All (${totalQ})</button>
            <button onclick="setQuizReviewFilter('incorrect')" class="btn-secondary px-4 py-2 rounded-lg text-sm text-white ${window.__quizReviewFilter === 'incorrect' ? 'border border-purple-400' : ''}">Incorrect (${incorrectCount})</button>
            <button onclick="setQuizReviewFilter('flagged')" class="btn-secondary px-4 py-2 rounded-lg text-sm text-white ${window.__quizReviewFilter === 'flagged' ? 'border border-purple-400' : ''}">Flagged (${flaggedQuestions.length})</button>
          </div>
        </div>

        <div class="space-y-4">
          ${reviewList.map(({ q, idx }) => {
            const userAns = answers[idx];
            const isCorrect = window.isAnswerCorrect(q, userAns);
            const topic = topics.find(t => t.id === q.topic) || { name: q.topic || 'Topic', color: '#a855f7' };
            const isFlagged = flaggedSet.has(idx);
            const correctText = (q.type === 'multiselect')
              ? (Array.isArray(q.correct) ? q.correct.map(i => q.options?.[i]).filter(Boolean).join(', ') : '—')
              : (q.options?.[q.correct] ?? '—');
            const yourText = (q.type === 'multiselect')
              ? (Array.isArray(userAns) ? userAns.map(i => q.options?.[i]).filter(Boolean).join(', ') : '—')
              : (q.options?.[userAns] ?? '—');

            return `
              <div class="rounded-xl border-2 ${isCorrect ? 'border-green-500 border-opacity-25' : 'border-red-500 border-opacity-35'} bg-white bg-opacity-5 overflow-hidden">
                <div class="p-4 flex items-start justify-between gap-4">
                  <div class="flex items-start gap-3">
                    <div class="w-10 h-10 rounded-lg flex items-center justify-center ${isCorrect ? 'bg-green-500 bg-opacity-20' : 'bg-red-500 bg-opacity-20'}">
                      <i data-lucide="${isCorrect ? 'check' : 'x'}" class="w-5 h-5 ${isCorrect ? 'text-green-400' : 'text-red-400'}"></i>
                    </div>

                    <div>
                      <div class="flex items-center gap-2 mb-1">
                        <span class="text-white font-bold">Question ${idx + 1}</span>
                        <span class="text-xs px-2 py-0.5 rounded-full" style="background:${topic.color}22; color:${topic.color};">${safe(topic.name)}</span>
                      </div>
                      <div class="text-slate-200 text-sm">${safe(q.question)}</div>
                    </div>
                  </div>

                  <button onclick="toggleFlagQuestion(${idx})" class="btn-secondary px-3 py-2 rounded-lg text-white text-xs">
                    <i data-lucide="flag" class="w-4 h-4 inline mr-1 ${isFlagged ? 'text-yellow-400 fill-yellow-400' : ''}"></i>
                    ${isFlagged ? 'Flagged' : 'Flag'}
                  </button>
                </div>

                <div class="px-4 pb-4">
                  <div class="bg-white bg-opacity-5 rounded-lg p-4">
                    <div class="text-xs text-slate-400 mb-2">Correct answer:</div>
                    <div class="text-green-300 font-semibold text-sm mb-3">${safe(correctText)}</div>

                    ${!isCorrect ? `
                      <div class="text-xs text-slate-400 mb-2">Your answer:</div>
                      <div class="text-red-300 font-semibold text-sm mb-3">${safe(yourText)}</div>
                    ` : ''}

                    <div class="text-xs text-slate-400 mb-2">Explanation:</div>
                    <div class="text-slate-200 text-sm leading-relaxed">${safe(q.explanation || '—')}</div>
                  </div>
                </div>
              </div>
            `;
          }).join('')}
        </div>
      </div>

      <!-- LEARNING RESOURCES / REVISION MATERIAL -->
      <div class="glass-card rounded-2xl p-6 md:p-8 mb-8">
        <button onclick="toggleLearningResources()" class="w-full flex items-center justify-between text-left">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 rounded-xl flex items-center justify-center"
                 style="background: linear-gradient(135deg, rgba(167,70,224,0.2), rgba(244,114,182,0.2)); border:1px solid rgba(167,70,224,0.3);">
              <i data-lucide="book-open" class="w-6 h-6 text-pink-300"></i>
            </div>
            <div>
              <div class="text-white font-bold text-xl">📚 Revision Material Bank</div>
              <div class="text-slate-400 text-sm">Deep insights and key facts for each topic - expand to revise!</div>
            </div>
          </div>
          <i id="resources-chevron" data-lucide="chevron-down" class="w-6 h-6 text-slate-300 transition-transform"></i>
        </button>

        <div id="learning-resources" class="hidden mt-6 space-y-4">
          ${renderLearningResources()}
        </div>
      </div>

      <!-- ACTION BUTTONS -->
      <div class="flex flex-wrap gap-4 justify-center pb-10">
        <button onclick="downloadQuizResultsPDF()" class="btn-secondary px-10 py-4 rounded-xl text-white font-semibold text-lg hover:scale-105 transition-transform">
          <i data-lucide="download" class="w-6 h-6 inline mr-2"></i>
          Download PDF
        </button>
        <button onclick="scrollToQuizReview()" class="btn-secondary px-10 py-4 rounded-xl text-white font-semibold text-lg hover:scale-105 transition-transform">
          <i data-lucide="eye" class="w-6 h-6 inline mr-2"></i>
          Review Questions
        </button>
        <button onclick="tryAnotherQuiz()" class="btn-gradient px-10 py-4 rounded-xl text-white font-bold text-lg hover:scale-105 transition-transform shadow-2xl">
          <i data-lucide="rotate-cw" class="w-6 h-6 inline mr-2"></i>
          Try Another Quiz
        </button>
      </div>

    </div>
  `;

  if (window.lucide) window.lucide.createIcons();
}

function renderOSCE(container) {
  const currentStation = sessionStations[currentIndex];
  const stationId = currentStation.id;
  const checklist = currentStationChecklist[stationId] || {};
  const isFlagged = flaggedStations.includes(stationId);

  // ✅ % COMPLETE BADGE CALC (ADD THIS)
  const allItems = ['preparation','assessment','interventions','communication','safetyRedFlags','documentation']
    .flatMap(k => currentStation.checklist?.[k] || []);
  const totalItems = allItems.length;
  const checkedItems = allItems.reduce((acc, item) => acc + (checklist[item] ? 1 : 0), 0);
  const stationPct = totalItems ? Math.round((checkedItems / totalItems) * 100) : 0;

  container.innerHTML = `
    <div class="fade-in max-w-6xl mx-auto">

      

        <h1 class="text-3xl text-white font-bold mb-2">${currentStation.title}</h1>

        <div class="flex gap-3 text-sm text-slate-300">
          <span class="px-2 py-1 rounded bg-white bg-opacity-10">
            ${currentStation.estimatedMinutes} mins
          </span>
          <span class="px-2 py-1 rounded bg-white bg-opacity-10 capitalize">
            ${currentStation.difficulty}
          </span>
        </div>
      </div>

      <!-- MAIN GRID -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div class="lg:col-span-2">

          <div class="glass-card rounded-2xl p-2 mb-6">
            <div class="flex gap-2">
              <button onclick="switchTab('brief')" class="tab-button flex-1 px-4 py-2 rounded-lg text-white ${currentTab === 'brief' ? 'active' : ''}">
                Brief
              </button>
              <button onclick="switchTab('checklist')" class="tab-button flex-1 px-4 py-2 rounded-lg text-white ${currentTab === 'checklist' ? 'active' : ''}">
                Checklist
              </button>
              <button onclick="switchTab('notes')" class="tab-button flex-1 px-4 py-2 rounded-lg text-white ${currentTab === 'notes' ? 'active' : ''}">
                Notes
              </button>
            </div>
          </div>

          ${currentTab === 'brief' ? renderBriefTab(currentStation) : ''}
          ${currentTab === 'checklist' ? renderChecklistTab(currentStation, checklist) : ''}
          ${currentTab === 'notes' ? renderNotesTab(stationId) : ''}
        </div>

        <div class="space-y-6">
          ${renderEquipmentPanel(currentStation)}
          ${renderTipsPanel(currentStation)}
          ${renderWarningsPanel(currentStation)}
        </div>
      </div>

      <!-- NAV BUTTONS -->
      <div class="glass-card rounded-2xl p-6 mt-6 flex justify-between items-center">
        <button onclick="previousStation()" ${currentIndex === 0 ? 'disabled' : ''} class="btn-secondary px-6 py-3 rounded-xl text-white disabled:opacity-30">
          Previous
        </button>

        ${currentIndex === sessionStations.length - 1 ? `
          <button onclick="finishOSCE()" class="btn-gradient px-8 py-3 rounded-xl text-white font-bold">
            Finish Practice
          </button>
        ` : `
          <button onclick="nextStation()" class="btn-gradient px-6 py-3 rounded-xl text-white">
            Next Station
          </button>
        `}
      </div>
    </div>
  `;

  if (window.lucide) window.lucide.createIcons();
}

    
    function renderBriefTab(station) {
      return `
        <div class="glass-card rounded-2xl p-8 space-y-6">
          <div>
            <h3 class="text-white font-bold text-lg mb-3">Candidate Instructions</h3>
            <p class="text-slate-300 leading-relaxed text-lg">${station.candidateInstructions}</p>
          </div>
          ${station.mnemonics ? `
            <div class="bg-purple-500 bg-opacity-10 p-4 rounded-xl border border-purple-500 border-opacity-30">
              <h4 class="text-purple-300 font-bold mb-2">Memory Aid</h4>
              <ul class="list-disc pl-5 text-slate-300 space-y-1">
                ${station.mnemonics.map(m => `<li>${m}</li>`).join('')}
              </ul>
            </div>
          ` : ''}
        </div>
      `;
    }

    function renderChecklistTab(station, checklist) {
  const sections = [
    { key: 'safetyRedFlags', label: 'Safety & Red Flags', color: '#ef4444', icon: 'alert-triangle', pinned: true },
    { key: 'preparation', label: 'Preparation', color: '#06b6d4', icon: 'settings' },
    { key: 'assessment', label: 'Assessment', color: '#8b5cf6', icon: 'stethoscope' },
    { key: 'interventions', label: 'Interventions', color: '#22c55e', icon: 'activity' },
    { key: 'communication', label: 'Communication', color: '#f59e0b', icon: 'message-circle' },
    { key: 'documentation', label: 'Documentation', color: '#64748b', icon: 'file-text' }
  ];

  // ---- state: show missed only (persist per-station) ----
  window.__osceShowMissedOnly = window.__osceShowMissedOnly || {};
  const showMissedOnly = !!window.__osceShowMissedOnly[station.id];

  // ---- build flat counts ----
  const getItems = (k) => (station.checklist?.[k] || []);
  const allItems = sections.flatMap(s => getItems(s.key));
  const total = allItems.length;
  const checked = allItems.reduce((acc, item) => acc + (checklist[item] ? 1 : 0), 0);
  const pct = total ? Math.round((checked / total) * 100) : 0;

  // per-domain breakdown
  const domainStats = sections.map(s => {
    const items = getItems(s.key);
    const t = items.length;
    const c = items.reduce((acc, item) => acc + (checklist[item] ? 1 : 0), 0);
    const p = t ? Math.round((c / t) * 100) : 0;
    return { ...s, total: t, checked: c, pct: p, items };
  }).filter(d => d.total > 0);

  // pinned first
  domainStats.sort((a, b) => (b.pinned ? 1 : 0) - (a.pinned ? 1 : 0));

  // ---- actions (safe, no global collisions) ----
  window.toggleOSCEShowMissedOnly = (stationId) => {
    window.__osceShowMissedOnly = window.__osceShowMissedOnly || {};
    window.__osceShowMissedOnly[stationId] = !window.__osceShowMissedOnly[stationId];
    render();
  };

  // ---- UI ----
  return `
    <div class="glass-card rounded-2xl p-6 mb-6">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
          <div class="flex items-center gap-3">
            <h3 class="text-white font-bold text-xl flex items-center gap-2">
              <i data-lucide="list-checks" class="w-6 h-6 text-cyan-400"></i>
              Checklist Progress
            </h3>
            <span class="px-3 py-1 rounded-full text-xs font-bold"
              style="background: rgba(167,70,224,.18); border:1px solid rgba(167,70,224,.35); color:#f472b6;">
              ${pct}% complete
            </span>
          </div>
          <div class="text-slate-400 text-sm mt-1">${checked}/${total} items completed</div>
        </div>

        <button
          onclick="toggleOSCEShowMissedOnly('${station.id}')"
          class="btn-secondary px-4 py-2 rounded-lg text-white text-sm"
          style="${showMissedOnly ? 'border-color: rgba(244,114,182,.6);' : ''}"
        >
          <i data-lucide="${showMissedOnly ? 'filter-x' : 'filter'}" class="w-4 h-4 inline mr-2"></i>
          ${showMissedOnly ? 'Showing missed only' : 'Show missed only'}
        </button>
      </div>

      <div class="mt-4 w-full bg-white bg-opacity-5 rounded-full h-3 overflow-hidden">
        <div class="h-3 rounded-full" style="width:${pct}%; background:linear-gradient(90deg, #a746e0, #f472b6);"></div>
      </div>
    </div>

    <div class="space-y-4">
      ${domainStats.map(domain => {
        // Filter items
        const visibleItems = showMissedOnly
          ? domain.items.filter(item => !checklist[item])
          : domain.items;

        const missed = domain.total - domain.checked;
        const priorityTag = (!domain.pinned && domain.pct < 75) ? `<span class="ml-2 px-2 py-0.5 bg-orange-500 text-white text-xs font-bold rounded-full">PRIORITY</span>` : '';
        const pinnedTag = domain.pinned ? `<span class="ml-2 px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full">CRITICAL</span>` : '';

        return `
          <div class="glass-card rounded-2xl p-6 ${domain.pinned ? 'border-2 border-red-500 border-opacity-30' : ''}">
            <div class="flex items-start justify-between gap-4 mb-4">
              <div class="flex items-start gap-3">
                <div class="p-2 rounded-lg" style="background:${domain.color}22;">
                  <i data-lucide="${domain.icon}" class="w-5 h-5" style="color:${domain.color};"></i>
                </div>
                <div>
                  <div class="flex items-center">
                    <h4 class="text-white font-bold">${domain.label}</h4>
                    ${pinnedTag}
                    ${priorityTag}
                  </div>
                  <div class="text-slate-400 text-sm">
                    ${domain.checked}/${domain.total} • ${domain.pct}% • ${missed} missed
                  </div>
                </div>
              </div>

              <div class="text-right">
                <div class="text-2xl font-bold ${domain.pct >= 75 ? 'text-green-400' : domain.pct >= 50 ? 'text-yellow-400' : 'text-red-400'}">${domain.pct}%</div>
              </div>
            </div>

            <div class="w-full bg-white bg-opacity-5 rounded-full h-3 overflow-hidden mb-4">
              <div class="h-3 rounded-full" style="width:${domain.pct}%; background:linear-gradient(90deg, ${domain.color}, ${domain.pct >= 75 ? '#22c55e' : domain.pct >= 50 ? '#f59e0b' : '#ef4444'});"></div>
            </div>

            ${visibleItems.length ? `
              <div class="space-y-2">
                ${visibleItems.map(item => {
                  const isChecked = !!checklist[item];
                  const isCritical = domain.key === 'safetyRedFlags';
                  const safeItem = String(item).replace(/'/g, "\\'");

                  return `
                    <label class="checklist-item ${isChecked ? 'checked' : ''} ${isCritical ? 'critical' : ''} p-3 rounded-lg flex items-start gap-3 cursor-pointer">
                      <input
                        type="checkbox"
                        ${isChecked ? 'checked' : ''}
                        onchange="toggleChecklistItem('${station.id}', '${safeItem}', this.checked)"
                        class="w-5 h-5 mt-0.5"
                      >
                      <span class="text-slate-300 flex-1">${item}</span>
                      ${isCritical ? `<span class="text-xs font-bold text-red-300">RED FLAG</span>` : ''}
                    </label>
                  `;
                }).join('')}
              </div>
            ` : `
              <div class="bg-white bg-opacity-5 rounded-xl p-4 text-slate-300 text-sm">
                <i data-lucide="check-circle" class="w-4 h-4 inline mr-2 text-green-400"></i>
                ${showMissedOnly ? 'No missed items in this domain 🎉' : 'No items to show.'}
              </div>
            `}
          </div>
        `;
      }).join('')}
    </div>
  `;
}

    function renderNotesTab(stationId) {
      const notes = stationNotes[stationId] || '';
      return `
        <div class="glass-card rounded-2xl p-6">
          <h3 class="text-white font-bold text-lg mb-4">Your Notes</h3>
          <textarea 
            class="w-full h-96 bg-white bg-opacity-5 border border-white border-opacity-10 rounded-xl p-4 text-slate-300 resize-none focus:outline-none focus:border-purple-400"
            placeholder="Type your reflection here..."
            oninput="updateStationNotes('${stationId}', this.value)"
          >${notes}</textarea>
        </div>
      `;
    }

    function renderEquipmentPanel(station) {
      return `
        <div class="glass-card rounded-2xl p-6">
          <h3 class="text-white font-bold mb-4">Equipment</h3>
          <ul class="space-y-2">
            ${station.equipment.map(item => `
              <li class="text-slate-300 text-sm flex items-start gap-2">
                <i data-lucide="box" class="w-4 h-4 text-cyan-400 mt-0.5 flex-shrink-0"></i>
                <span>${item}</span>
              </li>
            `).join('')}
          </ul>
        </div>
      `;
    }

    function renderTipsPanel(station) {
      if (!station.tips || station.tips.length === 0) return '';
      return `
        <div class="glass-card rounded-2xl p-6">
          <h3 class="text-white font-bold mb-4 text-yellow-400">Tips</h3>
          <ul class="space-y-3">
            ${station.tips.map(tip => `
              <li class="text-slate-300 text-sm flex items-start gap-2">
                <i data-lucide="star" class="w-4 h-4 text-yellow-400 mt-0.5 flex-shrink-0"></i>
                <span>${tip}</span>
              </li>
            `).join('')}
          </ul>
        </div>
      `;
    }

    function renderWarningsPanel(station) {
      if (!station.warnings || station.warnings.length === 0) return '';
      return `
        <div class="glass-card rounded-2xl p-6 border border-red-500 border-opacity-30">
          <h3 class="text-red-400 font-bold mb-4">Warnings</h3>
          <ul class="space-y-3">
            ${station.warnings.map(w => `
              <li class="text-red-200 text-sm flex items-start gap-2">
                <i data-lucide="alert-triangle" class="w-4 h-4 text-red-400 mt-0.5 flex-shrink-0"></i>
                <span>${w}</span>
              </li>
            `).join('')}
          </ul>
        </div>
      `;
    }

    function renderOSCEResults(container) {
  // --------- CALCS ----------
  let totalItems = 0;
  let totalChecked = 0;
  const stationResults = [];

  sessionStations.forEach(station => {
    const stId = station.id;
    const checklist = currentStationChecklist[stId] || {};

    const domains = ['preparation','assessment','interventions','communication','safetyRedFlags','documentation'];
    const allItems = domains.flatMap(d => station.checklist?.[d] || []);
    const checkedCount = Object.values(checklist).filter(Boolean).length;

    totalItems += allItems.length;
    totalChecked += checkedCount;

    const domainBreakdown = {};
    domains.forEach(domain => {
      const items = station.checklist?.[domain] || [];
      const checked = items.filter(item => checklist[item]).length;
      domainBreakdown[domain] = {
        checked,
        total: items.length,
        percentage: items.length ? Math.round((checked / items.length) * 100) : 0
      };
    });

    stationResults.push({
      station,
      checkedCount,
      totalCount: allItems.length,
      percentage: allItems.length ? Math.round((checkedCount / allItems.length) * 100) : 0,
      domainBreakdown,
      isFlagged: flaggedStations.includes(stId),
      notes: stationNotes?.[stId] || ''
    });
  });

  const overallPercentage = totalItems ? Math.round((totalChecked / totalItems) * 100) : 0;

  // --------- GRADE ----------
  let grade = 'Needs Work';
  let gradeColor = '#ef4444';
  let gradeIcon = 'book-open';
  let gradeMessage = 'Every practice session strengthens your clinical skills. Focus on the key areas below.';

  if (overallPercentage >= 90) {
    grade = 'Outstanding'; gradeColor = '#22c55e'; gradeIcon = 'trophy';
    gradeMessage = 'Exceptional performance! Your technique and knowledge are OSCE-ready.';
  } else if (overallPercentage >= 75) {
    grade = 'Strong Pass'; gradeColor = '#84cc16'; gradeIcon = 'check-circle';
    gradeMessage = 'Excellent work! Just a few refinements needed to reach mastery.';
  } else if (overallPercentage >= 60) {
    grade = 'Pass'; gradeColor = '#f59e0b'; gradeIcon = 'trending-up';
    gradeMessage = 'Solid foundation! Target the domains below to strengthen your performance.';
  } else if (overallPercentage >= 50) {
    grade = 'Borderline'; gradeColor = '#f97316'; gradeIcon = 'alert-circle';
    gradeMessage = 'You’re close! Focus practice on weak areas to push over the pass mark.';
  }

  // --------- DOMAIN SUMMARY ----------
  const domainLabels = {
    preparation: 'Preparation',
    assessment: 'Assessment',
    interventions: 'Interventions',
    communication: 'Communication',
    safetyRedFlags: 'Safety & Red Flags',
    documentation: 'Documentation'
  };
  const domainIcons = {
    preparation: 'settings',
    assessment: 'stethoscope',
    interventions: 'activity',
    communication: 'message-circle',
    safetyRedFlags: 'alert-triangle',
    documentation: 'file-text'
  };
  const domainColors = {
    preparation: '#06b6d4',
    assessment: '#8b5cf6',
    interventions: '#22c55e',
    communication: '#f59e0b',
    safetyRedFlags: '#ef4444',
    documentation: '#64748b'
  };

  const overallDomains = {};
  Object.keys(domainLabels).forEach(domain => {
    let domainChecked = 0;
    let domainTotal = 0;
    stationResults.forEach(sr => {
      domainChecked += sr.domainBreakdown[domain].checked;
      domainTotal += sr.domainBreakdown[domain].total;
    });
    overallDomains[domain] = {
      checked: domainChecked,
      total: domainTotal,
      percentage: domainTotal ? Math.round((domainChecked / domainTotal) * 100) : 0
    };
  });

  const domainArray = Object.entries(overallDomains)
    .map(([key, data]) => ({
      key,
      label: domainLabels[key],
      icon: domainIcons[key],
      color: domainColors[key],
      ...data
    }))
    .sort((a, b) => a.percentage - b.percentage);

  const weakDomains = domainArray.filter(d => d.total > 0 && d.percentage < 75);
  const strongDomains = domainArray.filter(d => d.total > 0 && d.percentage >= 75).slice(-3);

  // --------- INSIGHTS ----------
  const insights = [];
  if (overallPercentage >= 90) {
    insights.push({ icon:'trophy', color:'#22c55e', title:'Exam Ready', text:'Strong clinical competence across all domains. Maintain this standard!' });
  } else if (overallPercentage >= 75) {
    insights.push({ icon:'target', color:'#84cc16', title:'Nearly There', text:`Just ${90 - overallPercentage}% away from excellence. Perfect your weak domains.` });
  } else {
    insights.push({ icon:'trending-up', color:'#f59e0b', title:'Growth Opportunity', text:`${Math.max(0, 75 - overallPercentage)}% improvement needed to reach strong pass. Target high-impact domains first.` });
  }
  if (weakDomains.length) {
    const w = weakDomains[0];
    insights.push({ icon:'alert-circle', color:'#f97316', title:'Priority Focus Area', text:`${w.label}: ${w.percentage}% (${w.total - w.checked} items missed). This domain needs immediate attention.` });
  }
  if (strongDomains.length) {
    const s = strongDomains[strongDomains.length - 1];
    insights.push({ icon:'award', color:'#8b5cf6', title:'Key Strength', text:`${s.label}: ${s.percentage}%. Keep this as your confidence anchor.` });
  }
  if (flaggedStations.length) {
    insights.push({ icon:'flag', color:'#ec4899', title:'Flagged Stations', text:`You flagged ${flaggedStations.length} station${flaggedStations.length > 1 ? 's' : ''}. Review these carefully.` });
  }

  // --------- CRITICAL SAFETY MISSES ----------
  const missedSafetyItems = [];
  stationResults.forEach((sr, idx) => {
    const checklist = currentStationChecklist[sr.station.id] || {};
    const safetyItems = sr.station.checklist?.safetyRedFlags || [];
    safetyItems.forEach(item => {
      if (!checklist[item]) {
        missedSafetyItems.push({
          stationIndex: idx,
          stationTitle: sr.station.title,
          item
        });
      }
    });
  });

  // --------- RENDER ----------
  container.innerHTML = `
    <div class="fade-in max-w-6xl mx-auto">
    
<!-- HERO -->
<div class="glass-card rounded-3xl p-8 md:p-12 text-center mb-8 relative overflow-hidden">
  <div class="absolute inset-0 opacity-10">
    <div class="absolute top-0 left-0 w-64 h-64 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full blur-3xl"></div>
    <div class="absolute bottom-0 right-0 w-64 h-64 bg-gradient-to-tl from-cyan-400 to-purple-400 rounded-full blur-3xl"></div>
  </div>

  <div class="relative z-10">
    <div
      class="inline-flex items-center gap-2 px-4 py-2 rounded-full mb-6 ${grade === 'Needs Work' ? 'pulse-red-badge' : ''}"
      style="background:${gradeColor}33; border:2px solid ${gradeColor};"
    >
      <i data-lucide="${gradeIcon}" class="w-5 h-5" style="color:${gradeColor};"></i>
      <span class="font-bold text-sm" style="color:${gradeColor};">${grade}</span>
    </div>

    <h1 class="text-5xl md:text-6xl font-extrabold text-white mb-4 tracking-tight">
      OSCE Complete!
    </h1>

    <p class="text-xl text-slate-300 max-w-2xl mx-auto">
      ${gradeMessage}
    </p>
  </div>
</div>

      <!-- KPI GRID -->
      <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-8">
        <div class="glass-card rounded-2xl p-5">
          <i data-lucide="percent" class="w-5 h-5 text-purple-400"></i>
          <div class="text-3xl font-extrabold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent mt-2">${overallPercentage}%</div>
          <div class="text-slate-400 text-xs uppercase tracking-wider">Overall</div>
        </div>
        <div class="glass-card rounded-2xl p-5">
          <i data-lucide="check-square" class="w-5 h-5 text-green-400"></i>
          <div class="text-3xl font-extrabold text-green-400 mt-2">${totalChecked}</div>
          <div class="text-slate-400 text-xs uppercase tracking-wider">Completed</div>
        </div>
        <div class="glass-card rounded-2xl p-5">
          <i data-lucide="square" class="w-5 h-5 text-red-400"></i>
          <div class="text-3xl font-extrabold text-red-400 mt-2">${Math.max(0, totalItems - totalChecked)}</div>
          <div class="text-slate-400 text-xs uppercase tracking-wider">Missed</div>
        </div>
        <div class="glass-card rounded-2xl p-5">
          <i data-lucide="layers" class="w-5 h-5 text-cyan-400"></i>
          <div class="text-3xl font-extrabold text-cyan-400 mt-2">${sessionStations.length}</div>
          <div class="text-slate-400 text-xs uppercase tracking-wider">Stations</div>
        </div>
        <div class="glass-card rounded-2xl p-5">
          <i data-lucide="flag" class="w-5 h-5 text-yellow-400"></i>
          <div class="text-3xl font-extrabold text-yellow-400 mt-2">${flaggedStations.length}</div>
          <div class="text-slate-400 text-xs uppercase tracking-wider">Flagged</div>
        </div>
      </div>

      <!-- INSIGHTS -->
      <div class="glass-card rounded-2xl p-8 mb-8">
        <h2 class="text-white text-2xl font-bold mb-6 flex items-center gap-3">
          <i data-lucide="brain" class="w-7 h-7 text-pink-400"></i>
          Smart Insights
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          ${insights.map(insight => `
            <div class="p-4 rounded-xl border-2" style="background:${insight.color}11; border-color:${insight.color}33;">
              <div class="flex items-start gap-3">
                <div class="p-2 rounded-lg" style="background:${insight.color}22;">
                  <i data-lucide="${insight.icon}" class="w-5 h-5" style="color:${insight.color};"></i>
                </div>
                <div class="flex-1">
                  <h4 class="text-white font-bold mb-1">${insight.title}</h4>
                  <p class="text-slate-300 text-sm leading-relaxed">${insight.text}</p>
                </div>
              </div>
            </div>
          `).join('')}
        </div>
      </div>

      <!-- PERFORMANCE BY DOMAIN -->
      <div class="glass-card rounded-2xl p-8 mb-8">
        <h2 class="text-white text-2xl font-bold mb-6 flex items-center gap-3">
          <i data-lucide="bar-chart-3" class="w-7 h-7 text-purple-400"></i>
          Performance by Domain
        </h2>
        <div class="space-y-4">
          ${domainArray.map(d => {
            const isPriority = d.total > 0 && d.percentage < 75;
            return `
              <div class="p-4 rounded-xl ${isPriority ? 'bg-orange-500 bg-opacity-10 border-2 border-orange-500 border-opacity-30' : 'bg-white bg-opacity-5'}">
                <div class="flex items-center justify-between mb-3">
                  <div class="flex items-center gap-3">
                    <div class="p-2 rounded-lg" style="background:${d.color}22;">
                      <i data-lucide="${d.icon}" class="w-5 h-5" style="color:${d.color};"></i>
                    </div>
                    <div>
                      <div class="flex items-center gap-2">
                        <span class="text-white font-semibold">${d.label}</span>
                        ${isPriority ? '<span class="px-2 py-0.5 bg-orange-500 text-white text-xs font-bold rounded-full">PRIORITY</span>' : ''}
                      </div>
                      <span class="text-slate-400 text-sm">${d.checked}/${d.total} items</span>
                    </div>
                  </div>
                  <div class="text-2xl font-bold ${d.percentage >= 75 ? 'text-green-400' : d.percentage >= 50 ? 'text-yellow-400' : 'text-red-400'}">${d.percentage}%</div>
                </div>
                <div class="w-full bg-white bg-opacity-5 rounded-full h-3 overflow-hidden">
                  <div class="h-3 rounded-full" style="width:${d.percentage}%; background:linear-gradient(90deg, ${d.color}, ${d.percentage >= 75 ? '#22c55e' : d.percentage >= 50 ? '#f59e0b' : '#ef4444'});"></div>
                </div>
              </div>
            `;
          }).join('')}
        </div>
      </div>

      <!-- STATION BREAKDOWN -->
      <div class="glass-card rounded-2xl p-8 mb-8">
        <h2 class="text-white text-2xl font-bold mb-6 flex items-center gap-3">
          <i data-lucide="list-checks" class="w-7 h-7 text-cyan-400"></i>
          Station Breakdown
        </h2>

        <div class="space-y-4">
          ${stationResults.map((sr, idx) => {
            const topic = topics.find(t => t.id === sr.station.topic);
            return `
              <div class="glass-card p-6 rounded-xl border-2 ${sr.percentage >= 75 ? 'border-green-500 border-opacity-30' : sr.percentage >= 50 ? 'border-yellow-500 border-opacity-30' : 'border-red-500 border-opacity-30'}">
                <div class="flex items-start justify-between mb-4">
                  <div class="flex-1">
                    <div class="flex items-center gap-2 mb-2">
                      <span class="text-white font-bold text-lg">Station ${idx + 1}</span>
                      ${sr.isFlagged ? '<i data-lucide="flag" class="w-5 h-5 text-yellow-400"></i>' : ''}
                      ${topic ? `<span class="text-xs px-3 py-1 rounded-full font-semibold" style="background:${topic.color}22; color:${topic.color};">${topic.name}</span>` : ''}
                    </div>
                    <h3 class="text-slate-300 font-semibold mb-1">${sr.station.title}</h3>
                    <p class="text-slate-400 text-sm">
                      <span class="capitalize ${
                        sr.station.difficulty === 'easy' ? 'text-green-400' :
                        sr.station.difficulty === 'medium' ? 'text-yellow-400' : 'text-red-400'
                      }">${sr.station.difficulty}</span> • ${sr.station.estimatedMinutes} minutes
                    </p>
                  </div>

                  <div class="text-right">
                    <div class="text-4xl font-bold ${sr.percentage >= 75 ? 'text-green-400' : sr.percentage >= 50 ? 'text-yellow-400' : 'text-red-400'}">${sr.percentage}%</div>
                    <div class="text-slate-400 text-sm">${sr.checkedCount}/${sr.totalCount} items</div>
                  </div>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                  ${Object.entries(sr.domainBreakdown)
                    .filter(([_, d]) => d.total > 0)
                    .map(([domain, data]) => `
                      <div class="bg-white bg-opacity-5 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                          <span class="text-xs text-slate-400 font-semibold">${domainLabels[domain]}</span>
                          <span class="text-xs text-slate-300 mono font-bold">${data.percentage}%</span>
                        </div>
                        <div class="w-full bg-white bg-opacity-5 rounded-full h-2">
                          <div class="h-2 rounded-full" style="width:${data.percentage}%; background:${domainColors[domain]};"></div>
                        </div>
                      </div>
                    `).join('')}
                </div>

                ${sr.notes ? `
                  <div class="mt-4 p-3 bg-purple-500 bg-opacity-10 border border-purple-500 border-opacity-30 rounded-lg">
                    <div class="text-purple-200 text-xs mb-1 flex items-center gap-1 font-semibold">
                      <i data-lucide="sticky-note" class="w-3 h-3"></i> Your Notes
                    </div>
                    <p class="text-slate-300 text-sm leading-relaxed">${sr.notes.substring(0, 180)}${sr.notes.length > 180 ? '...' : ''}</p>
                  </div>
                ` : ''}
              </div>
            `;
          }).join('')}
        </div>
      </div>

      ${missedSafetyItems.length ? `
        <div class="glass-card rounded-2xl p-8 mb-8 border-2 border-red-500 border-opacity-50">
          <h2 class="text-white text-2xl font-bold mb-4 flex items-center gap-3">
            <i data-lucide="alert-octagon" class="w-7 h-7 text-red-400"></i>
            Critical Safety Items Missed
          </h2>
          <p class="text-red-200 text-sm mb-6 leading-relaxed">
            <strong>Important:</strong> These are patient-safety red flags. Missing them in a real OSCE can trigger immediate fail criteria.
          </p>
          <div class="space-y-3">
            ${missedSafetyItems.map(m => `
              <div class="bg-red-500 bg-opacity-10 border-2 border-red-500 border-opacity-30 rounded-xl p-4">
                <div class="text-red-300 font-bold mb-1">Station ${m.stationIndex + 1}: ${m.stationTitle}</div>
                <p class="text-red-100 text-sm leading-relaxed">${m.item}</p>
              </div>
            `).join('')}
          </div>
        </div>
      ` : ''}

      <!-- Personalized Action Plan -->
      <div class="glass-card rounded-2xl p-8 mb-8 border-2 border-purple-500 border-opacity-30">
        <h2 class="text-white text-2xl font-bold mb-6 flex items-center gap-3">
          <i data-lucide="map" class="w-7 h-7 text-purple-400"></i>
          Your Personalized Action Plan
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Immediate Priorities -->
          <div>
            <h4 class="text-purple-300 font-bold mb-4 flex items-center gap-2">
              <i data-lucide="zap" class="w-5 h-5"></i>
              Immediate Priorities
            </h4>

            <ul class="space-y-3 text-slate-300 text-sm">
              ${weakDomains.length > 0 ? weakDomains.slice(0, 3).map(d => `
                <li class="flex items-start gap-2">
                  <span class="text-purple-400 font-bold flex-shrink-0">•</span>
                  <span>
                    <strong>${d.label}:</strong> Practice ${d.total - d.checked} missed item${(d.total - d.checked) !== 1 ? 's' : ''} until technique is fluent
                    (${d.percentage}% → aim for 90%+)
                  </span>
                </li>
              `).join('') : `
                <li class="flex items-start gap-2">
                  <span class="text-purple-400 font-bold flex-shrink-0">•</span>
                  <span><strong>Maintain excellence:</strong> Your performance is strong across all domains—keep practicing regularly.</span>
                </li>
              `}

              <li class="flex items-start gap-2">
                <span class="text-purple-400 font-bold flex-shrink-0">•</span>
                <span><strong>Checklist mastery:</strong> Aim for 100% completion on all domains—every step matters in real clinical practice</span>
              </li>
            </ul>
          </div>

          <!-- Practice Strategy -->
          <div>
            <h4 class="text-pink-300 font-bold mb-4 flex items-center gap-2">
              <i data-lucide="calendar-check" class="w-5 h-5"></i>
              Practice Strategy
            </h4>

            <ul class="space-y-3 text-slate-300 text-sm">
              <li class="flex items-start gap-2">
                <span class="text-pink-400 font-bold flex-shrink-0">•</span>
                <span><strong>Daily focused practice:</strong> Spend 15–20 minutes daily on your weakest domain until comfortable</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="text-pink-400 font-bold flex-shrink-0">•</span>
                <span><strong>Break it down:</strong> Practice each station section separately (prep → assessment → interventions) before combining</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="text-pink-400 font-bold flex-shrink-0">•</span>
                <span><strong>Real-world application:</strong> Practice on manikins or volunteer for supervised clinical opportunities</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="text-pink-400 font-bold flex-shrink-0">•</span>
                <span><strong>Communication drill:</strong> Practice SBAR handovers and patient explanations out loud until natural and confident</span>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <!-- What You Did Well + Common OSCE Pitfalls -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <div class="glass-card rounded-2xl p-6 border-2 border-green-500 border-opacity-30">
          <h3 class="text-white text-xl font-bold mb-4 flex items-center gap-2">
            <i data-lucide="thumbs-up" class="w-6 h-6 text-green-400"></i>
            What You Did Well
          </h3>
          <ul class="space-y-3">
            <li class="flex items-start gap-2 text-slate-300 text-sm">
              <i data-lucide="check" class="w-4 h-4 text-green-400 mt-0.5 flex-shrink-0"></i>
              <span>You completed ${sessionStations.length} station${sessionStations.length !== 1 ? 's' : ''}—this active practice builds clinical confidence and competence</span>
            </li>
            <li class="flex items-start gap-2 text-slate-300 text-sm">
              <i data-lucide="check" class="w-4 h-4 text-green-400 mt-0.5 flex-shrink-0"></i>
              <span>Used the checklist system effectively—this mirrors real OSCE mark schemes and builds exam technique</span>
            </li>
          </ul>
        </div>

        <div class="glass-card rounded-2xl p-6 border-2 border-orange-500 border-opacity-30">
          <h3 class="text-white text-xl font-bold mb-4 flex items-center gap-2">
            <i data-lucide="alert-circle" class="w-6 h-6 text-orange-400"></i>
            Common OSCE Pitfalls
          </h3>
          <ul class="space-y-3">
            <li class="flex items-start gap-2 text-slate-300 text-sm">
              <i data-lucide="x" class="w-4 h-4 text-orange-400 mt-0.5 flex-shrink-0"></i>
              <span><strong>Skipping introduction:</strong> Always introduce yourself, verify patient ID, and gain consent—first impressions matter</span>
            </li>
            <li class="flex items-start gap-2 text-slate-300 text-sm">
              <i data-lucide="x" class="w-4 h-4 text-orange-400 mt-0.5 flex-shrink-0"></i>
              <span><strong>Silent procedures:</strong> Talk through what you're doing—examiners need to hear your clinical reasoning</span>
            </li>
            <li class="flex items-start gap-2 text-slate-300 text-sm">
              <i data-lucide="x" class="w-4 h-4 text-orange-400 mt-0.5 flex-shrink-0"></i>
              <span><strong>Forgetting hand hygiene:</strong> Wash hands before AND after every patient contact—it's an automatic fail if missed</span>
            </li>
            <li class="flex items-start gap-2 text-slate-300 text-sm">
              <i data-lucide="x" class="w-4 h-4 text-orange-400 mt-0.5 flex-shrink-0"></i>
              <span><strong>Poor time management:</strong> Practice timing yourself—running over time loses marks even if technique is perfect</span>
            </li>
            <li class="flex items-start gap-2 text-slate-300 text-sm">
              <i data-lucide="x" class="w-4 h-4 text-orange-400 mt-0.5 flex-shrink-0"></i>
              <span><strong>Not documenting:</strong> Real clinical practice requires documentation—practice this step even in mock OSCEs</span>
            </li>
          </ul>
        </div>
      </div>


      <!-- ACTIONS -->
      <div class="flex gap-4 justify-center flex-wrap">
        <button onclick="downloadOSCEResultsPDF()" class="btn-secondary px-10 py-4 rounded-xl text-white font-semibold text-lg">
          <i data-lucide="download" class="w-6 h-6 inline mr-2"></i>
          Download PDF
        </button>
        <button onclick="exitToSelection()" class="btn-gradient px-10 py-4 rounded-xl text-white font-bold text-lg">
          <i data-lucide="refresh-cw" class="w-6 h-6 inline mr-2"></i>
          Practice Again
        </button>
      </div>
    </div>
  `;
}


    function renderSelection(container) {
      container.innerHTML = `
        <div class="fade-in max-w-6xl mx-auto">
          <header class="text-center mb-12">
            <h1 class="text-5xl md:text-6xl font-bold text-white mb-4">${config.app_title}</h1>
            <p class="text-xl text-slate-300">${config.app_subtitle}</p>
          </header>

          <!-- Quiz Settings -->
          <div class="glass-card rounded-2xl p-8 mb-8">
            <h2 class="text-white font-bold text-xl mb-6 flex items-center gap-2">
              <i data-lucide="settings" class="w-6 h-6 text-purple-400"></i>
              Quiz Settings
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
              <!-- Questions Count -->
              <div>
                <label class="block text-slate-300 text-sm font-medium mb-3">Questions</label>
                <div class="flex flex-wrap gap-2">
                  <button onclick="setQuizQuestionCount(10)" class="px-4 py-2 rounded-lg text-sm font-medium transition-all ${quizQuestionCount === 10 ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">10</button>
                  <button onclick="setQuizQuestionCount(20)" class="px-4 py-2 rounded-lg text-sm font-medium transition-all ${quizQuestionCount === 20 ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">20</button>
                  <button onclick="setQuizQuestionCount(30)" class="px-4 py-2 rounded-lg text-sm font-medium transition-all ${quizQuestionCount === 30 ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">30</button>
                  <button onclick="setQuizQuestionCount(60)" class="px-4 py-2 rounded-lg text-sm font-medium transition-all ${quizQuestionCount === 60 ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">60</button>
                  <button onclick="setQuizQuestionCount('all')" class="px-4 py-2 rounded-lg text-sm font-medium transition-all ${quizQuestionCount === 'all' ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">All</button>
                </div>
              </div>
              
              <!-- Mode -->
              <div>
                <label class="block text-slate-300 text-sm font-medium mb-3">Mode</label>
                <div class="flex flex-wrap gap-2">
                  <button 
                    onclick="setQuizMode('practice')"
                    class="px-4 py-2 rounded-lg text-sm font-medium transition-all ${quizMode === 'practice' ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}"
                  >
                    Practice
                  </button>
                  <button 
                    onclick="setQuizMode('exam')"
                    class="px-4 py-2 rounded-lg text-sm font-medium transition-all ${quizMode === 'exam' ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}"
                  >
                    Exam
                  </button>
                </div>
                <p class="text-slate-500 text-xs mt-2">${quizMode === 'practice' ? 'See answers after each question' : 'See all answers at the end'}</p>
              </div>
              
              <!-- Difficulty -->
              <div>
                <label class="block text-slate-300 text-sm font-medium mb-3">Difficulty</label>
                <div class="flex flex-wrap gap-2">
                  <button onclick="setQuizDifficulty('mixed')" class="px-3 py-2 rounded-lg text-sm font-medium transition-all ${quizDifficulty === 'mixed' ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">Mixed</button>
                  <button onclick="setQuizDifficulty('easy')" class="px-3 py-2 rounded-lg text-sm font-medium transition-all ${quizDifficulty === 'easy' ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">Easy</button>
                  <button onclick="setQuizDifficulty('medium')" class="px-3 py-2 rounded-lg text-sm font-medium transition-all ${quizDifficulty === 'medium' ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">Medium</button>
                  <button onclick="setQuizDifficulty('hard')" class="px-3 py-2 rounded-lg text-sm font-medium transition-all ${quizDifficulty === 'hard' ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">Hard</button>
                </div>
              </div>
              
              <!-- Timer -->
              <div>
                <label class="block text-slate-300 text-sm font-medium mb-3">Timer</label>

                <button 
                  onclick="toggleQuizTimer()"
                  class="flex items-center gap-3 px-4 py-2 rounded-lg transition-all ${quizTimerEnabled ? 'bg-purple-500' : 'bg-white bg-opacity-10'}"
                >
                  <div class="w-12 h-6 rounded-full relative ${quizTimerEnabled ? 'bg-purple-300' : 'bg-slate-600'}">
                    <div class="absolute top-1 w-4 h-4 rounded-full bg-white transition-all ${quizTimerEnabled ? 'right-1' : 'left-1'}"></div>
                  </div>
                  <span class="text-sm font-medium ${quizTimerEnabled ? 'text-white' : 'text-slate-300'}">${quizTimerEnabled ? 'On' : 'Off'}</span>
                </button>

                ${quizTimerEnabled ? `
                  <div class="mt-3 space-y-2">
                    ${quizMode === 'exam' ? `
                      <div class="text-xs text-slate-400">Overall exam timer</div>
                      <div class="flex flex-wrap gap-2">
                        <button onclick="setQuizExamSeconds(1800)" class="px-3 py-2 rounded-lg text-xs font-semibold transition-all ${quizExamSeconds === 1800 ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">30m</button>
                        <button onclick="setQuizExamSeconds(2700)" class="px-3 py-2 rounded-lg text-xs font-semibold transition-all ${quizExamSeconds === 2700 ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">45m</button>
                        <button onclick="setQuizExamSeconds(3600)" class="px-3 py-2 rounded-lg text-xs font-semibold transition-all ${quizExamSeconds === 3600 ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">60m</button>
                      </div>
                      <p class="text-slate-500 text-xs">Exam mode uses an overall timer (recommended).</p>
                    ` : `
                      <div class="text-xs text-slate-400">Per-question timer</div>
                      <div class="flex flex-wrap gap-2">
                        <button onclick="setQuizPerQuestionSeconds(60)" class="px-3 py-2 rounded-lg text-xs font-semibold transition-all ${quizPerQuestionSeconds === 60 ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">1m</button>
                        <button onclick="setQuizPerQuestionSeconds(180)" class="px-3 py-2 rounded-lg text-xs font-semibold transition-all ${quizPerQuestionSeconds === 180 ? 'bg-purple-500 text-white' : 'bg-white bg-opacity-10 text-slate-300 hover:bg-opacity-20'}">3m</button>
                      </div>
                      <p class="text-slate-500 text-xs">Keeps you moving without rushing.</p>
                    `}
                  </div>
                ` : ''}
              </div>
            </div>
          </div>

          <!-- Topic Selection -->
          <div class="glass-card rounded-2xl p-8 mb-8">
            <div class="flex items-center justify-between mb-6">
              <label class="text-white font-semibold text-lg">Select Topics (${selectedTopics.length} selected)</label>
              <div class="flex gap-2">
                <button onclick="selectAllTopics()" class="btn-secondary px-4 py-2 rounded-lg text-sm text-white">Select All</button>
                <button onclick="clearTopics()" class="btn-secondary px-4 py-2 rounded-lg text-sm text-white">Clear</button>
              </div>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
              ${topics.map(topic => {
                const count = quizBank.filter(q => q.topic === topic.id).length;
                const isSelected = selectedTopics.includes(topic.id);
                
                return `
                  <button 
                    onclick="toggleTopic('${topic.id}')" 
                    class="topic-card p-6 rounded-xl transition-all text-left ${isSelected ? 'selected' : ''}"
                    style="border-color: ${isSelected ? topic.color : 'rgba(167, 70, 224, 0.2)'};"
                  >
                    <div class="flex items-center justify-between mb-3">
                      <i data-lucide="${topic.icon}" class="w-8 h-8" style="color: ${topic.color};"></i>
                      <span class="text-xs mono px-2 py-1 rounded bg-white bg-opacity-10">${count}</span>
                    </div>
                    <h3 class="text-white font-semibold text-base">${topic.name}</h3>
                  </button>
                `;
              }).join('')}
            </div>
          </div>

          <div class="text-center mb-8">
            <button 
              onclick="startSession()" 
              ${selectedTopics.length === 0 ? 'disabled' : ''}
              class="btn-gradient px-12 py-4 rounded-xl text-white font-bold text-lg disabled:opacity-50 disabled:cursor-not-allowed"
            >
              Start Quiz
            </button>
          </div>

          <!-- LEARNING RESOURCES / REVISION MATERIAL -->
          <div class="glass-card rounded-2xl p-6 md:p-8 mb-8">
            <button onclick="toggleLearningResources()" class="w-full flex items-center justify-between text-left">
              <div class="flex items-center gap-3">
                <div class="w-12 h-12 rounded-xl flex items-center justify-center"
                     style="background: linear-gradient(135deg, rgba(167,70,224,0.2), rgba(244,114,182,0.2)); border:1px solid rgba(167,70,224,0.3);">
                  <i data-lucide="book-open" class="w-6 h-6 text-pink-300"></i>
                </div>
                <div>
                  <div class="text-white font-bold text-xl">📚 Revision Material Bank</div>
                  <div class="text-slate-400 text-sm">Deep insights and key facts for each topic - click to expand!</div>
                </div>
              </div>
              <i id="resources-chevron" data-lucide="chevron-down" class="w-6 h-6 text-slate-300 transition-transform"></i>
            </button>

            <div id="learning-resources" class="hidden mt-6 space-y-4">
              ${renderLearningResources()}
            </div>
          </div>
        </div>
      `;
    }

    function renderNavigator() {
      const content = document.getElementById('navigator-content');
      content.innerHTML = `
        <div class="space-y-3">
          ${sessionStations.map((station, idx) => {
            const stId = station.id;
            const stChecklist = currentStationChecklist[stId] || {};
            const stAllItems = [
              ...station.checklist.preparation,
              ...station.checklist.assessment,
              ...station.checklist.interventions,
              ...station.checklist.communication,
              ...station.checklist.safetyRedFlags,
              ...station.checklist.documentation
            ];
            const stCheckedCount = Object.values(stChecklist).filter(v => v).length;
            const completionPercent = stAllItems.length > 0 ? Math.round((stCheckedCount / stAllItems.length) * 100) : 0;
            const isCurrent = idx === currentIndex;
            
            return `
              <button 
                onclick="jumpToStation(${idx}); closeNavigator();"
                class="w-full glass-card p-4 rounded-xl text-left transition-all hover:border-purple-400 ${isCurrent ? 'border-2 border-purple-500' : 'border border-white border-opacity-10'}"
              >
                <div class="flex items-start justify-between mb-2">
                  <div class="flex-1">
                    <div class="text-white font-semibold mb-1">Station ${idx + 1}</div>
                    <div class="text-slate-300 text-sm">${station.title}</div>
                  </div>
                </div>
                <div class="flex items-center gap-2">
                  <div class="flex-1 bg-white bg-opacity-5 rounded-full h-2">
                    <div class="h-2 rounded-full bg-purple-500 transition-all" style="width: ${completionPercent}%"></div>
                  </div>
                  <span class="text-xs text-slate-400 mono">${completionPercent}%</span>
                </div>
              </button>
            `;
          }).join('')}
        </div>
      `;
      if (window.lucide) window.lucide.createIcons();
    }

    // ==================== EVENT HANDLERS ====================
    window.selectMode = (mode) => { sessionMode = mode; render(); };
    window.toggleTopic = (topicId) => {
      const index = selectedTopics.indexOf(topicId);
      if (index > -1) selectedTopics.splice(index, 1);
      else selectedTopics.push(topicId);
      render();
    };
    window.selectAllTopics = () => { selectedTopics = topics.map(t => t.id); render(); };
    window.clearTopics = () => { selectedTopics = []; render(); };
    
    // Quiz Settings Handlers
    window.setQuizQuestionCount = (count) => { quizQuestionCount = count; render(); };

    window.setQuizMode = (mode) => {
      quizMode = mode;
      // Nice default: Exam mode is typically timed (45 mins)
      if (quizMode === 'exam') {
        if (typeof quizExamSeconds !== 'number' || !Number.isFinite(quizExamSeconds) || quizExamSeconds <= 0) {
          quizExamSeconds = 2700;
        }
        // auto-enable timer for exam to match expectation
        quizTimerEnabled = true;
      }
      render();
    };

    window.setQuizDifficulty = (diff) => { quizDifficulty = diff; render(); };

    window.toggleQuizTimer = () => {
      quizTimerEnabled = !quizTimerEnabled;
      // If turning timer on while in exam mode, ensure an exam duration is set
      if (quizTimerEnabled && quizMode === 'exam') {
        if (typeof quizExamSeconds !== 'number' || !Number.isFinite(quizExamSeconds) || quizExamSeconds <= 0) quizExamSeconds = 2700;
      }
      render();
    };

    window.setQuizPerQuestionSeconds = (secs) => {
      const s = Number(secs);
      if (s === 60 || s === 180) quizPerQuestionSeconds = s;
      render();
    };

    window.setQuizExamSeconds = (secs) => {
      const s = Number(secs);
      if ([1800, 2700, 3600].includes(s)) quizExamSeconds = s;
      render();
    };
    
    window.startSession = () => {
      if (selectedTopics.length === 0) return;
      
      if (sessionMode === 'quiz') {
        // Get all questions from selected topics
        let availableQuestions = quizBank.filter(q => selectedTopics.includes(q.topic));
        
        // Filter by difficulty if not mixed
        if (quizDifficulty !== 'mixed') {
          availableQuestions = availableQuestions.filter(q => q.difficulty === quizDifficulty);
        }
        
        if (availableQuestions.length === 0) { 
          alert('No questions available for selected topics and difficulty'); 
          return; 
        }
        
        // Build a mixed set with variety by question type (mcq / tf / multiselect)
        // Weighting is adjusted to availability so it never fails.
        const desiredCount = (quizQuestionCount === 'all') ? availableQuestions.length : Number(quizQuestionCount);
        const n = Math.max(1, Math.min(desiredCount || 10, availableQuestions.length));

        const pools = {
          mcq: shuffleArray(availableQuestions.filter(q => (q.type || 'mcq') === 'mcq')),
          tf: shuffleArray(availableQuestions.filter(q => q.type === 'tf')),
          multiselect: shuffleArray(availableQuestions.filter(q => q.type === 'multiselect')),
        };

        function pull(type, count, picked) {
          const arr = pools[type] || [];
          while (count > 0 && arr.length > 0) {
            picked.push(arr.shift());
            count--;
          }
        }

        if (quizQuestionCount === 'all') {
          sessionQuestions = shuffleArray(availableQuestions);
        } else {
          const picked = [];
          const weights = { mcq: 0.6, tf: 0.2, multiselect: 0.2 };

          // Targets (rounded), then adjusted to total n
          let tfTarget = Math.round(n * weights.tf);
          let msTarget = Math.round(n * weights.multiselect);
          let mcqTarget = n - tfTarget - msTarget;

          // Ensure at least some variety when available
          if (pools.tf.length > 0) tfTarget = Math.max(1, tfTarget);
          if (pools.multiselect.length > 0) msTarget = Math.max(1, msTarget);
          mcqTarget = Math.max(0, n - tfTarget - msTarget);

          pull('tf', tfTarget, picked);
          pull('multiselect', msTarget, picked);
          pull('mcq', mcqTarget, picked);

          // Fill any remainder from whatever is left (dedup by id)
          const allShuffled = shuffleArray(availableQuestions);
          for (const q of allShuffled) {
            if (picked.length >= n) break;
            if (!picked.some(x => x.id === q.id)) picked.push(q);
          }

          sessionQuestions = shuffleArray(picked).slice(0, n);
        }
        sessionAnswers = new Array(sessionQuestions.length).fill(null);
        sessionSubmitted = new Array(sessionQuestions.length).fill(false);
        // Deeper insights telemetry per question
        sessionMeta = sessionQuestions.map(() => ({ startAtMs: 0, timeSpentSec: 0, changes: 0, firstAnswer: null, confidence: null }));
        currentIndex = 0;
        currentQuestionEnteredAtMs = Date.now();
        if (sessionMeta[0]) sessionMeta[0].startAtMs = currentQuestionEnteredAtMs;
        window.quizStartedAt = Date.now();
        window.quizTimeSeconds = 0;
        
        // Track wall-clock start for results (used when timer is off)
        window.quizStartedAt = Date.now();

        // Setup timer if enabled
        if (quizTimerEnabled) {
          if (quizMode === 'exam') {
            // Overall exam timer (default 45 mins)
            quizTimeLimit = Number(quizExamSeconds) || 2700;
          } else {
            // Per-question timer (1m or 3m)
            const perQ = (Number(quizPerQuestionSeconds) === 180) ? 180 : 60;
            quizTimeLimit = sessionQuestions.length * perQ;
          }
          timeRemaining = quizTimeLimit;
          startQuizTimer();
        } else {
          quizTimeLimit = 0;
          timeRemaining = 0;
          stopQuizTimer();
        }
        
        currentView = 'quiz';
      } else {
        // UPGRADE 2: Pick exactly 3 stations per selected topic (or all if fewer than 3)
        const stationsPerTopic = 3;
        let pickedStations = [];
        
        selectedTopics.forEach(topicId => {
          const topicStations = stationBank.filter(s => s.topic === topicId);
          const picked = shuffleAndPickN(topicStations, stationsPerTopic);
          pickedStations = pickedStations.concat(picked);
        });
        
        if (pickedStations.length === 0) { alert('No stations available for selected topics'); return; }
        
        // Final shuffle so topics are interleaved
        sessionStations = shuffleArray(pickedStations);
        currentIndex = 0;
        currentStationChecklist = {};
        stationNotes = {};
        flaggedStations = [];
        currentTab = 'brief';
        currentView = 'osce';
      }
      render();
    };

    window.closeNavigator = () => {
      document.getElementById('navigator-drawer').classList.remove('open');
      document.getElementById('navigator-overlay').classList.remove('visible');
    };
    window.openNavigator = () => {
      document.getElementById('navigator-drawer').classList.add('open');
      document.getElementById('navigator-overlay').classList.add('visible');
      renderNavigator();
    };

    window.isAnswerCorrect = (question, userAnswer) => {
      if (!question) return false;
      if (userAnswer === null || userAnswer === undefined) return false;

      if (question.type === 'multiselect') {
        const correct = Array.isArray(question.correct) ? [...question.correct].sort((a,b)=>a-b) : [];
        const chosen = Array.isArray(userAnswer) ? [...userAnswer].sort((a,b)=>a-b) : [];
        return JSON.stringify(correct) === JSON.stringify(chosen);
      }

      // tf & mcq both stored as single values
      return userAnswer === question.correct;
    };

    window.toggleMultiAnswer = (optionIndex) => {
      const q = sessionQuestions[currentIndex];
      if (!q || q.type !== 'multiselect') return;

      if (!Array.isArray(sessionAnswers[currentIndex])) sessionAnswers[currentIndex] = [];
      const selected = sessionAnswers[currentIndex];

      // Track "changes" as selection edits
      const meta = sessionMeta?.[currentIndex];
      if (meta) meta.changes += 1;

      if (selected.includes(optionIndex)) {
        sessionAnswers[currentIndex] = selected.filter(x => x !== optionIndex);
      } else {
        sessionAnswers[currentIndex] = [...selected, optionIndex].sort((a,b)=>a-b);
      }

      // Capture the first non-empty selection snapshot
      if (meta && (meta.firstAnswer === null || meta.firstAnswer === undefined) && Array.isArray(sessionAnswers[currentIndex]) && sessionAnswers[currentIndex].length) {
        meta.firstAnswer = sessionAnswers[currentIndex].slice();
      }

      render();
    };
    window.submitMultiAnswer = () => {
      const q = sessionQuestions[currentIndex];
      if (!q || q.type !== 'multiselect') return;
      if (!Array.isArray(sessionSubmitted)) sessionSubmitted = [];
      sessionSubmitted[currentIndex] = true;
      render();
    };

    window.editMultiAnswer = () => {
      const q = sessionQuestions[currentIndex];
      if (!q || q.type !== 'multiselect') return;
      if (!Array.isArray(sessionSubmitted)) sessionSubmitted = [];
      sessionSubmitted[currentIndex] = false;
      render();
    };

    window.answerQuestion = (optionIndex) => {
      const q = sessionQuestions[currentIndex];
      const prev = sessionAnswers[currentIndex];

      // Track answer changes (mostly relevant for Exam mode where answers can change)
      const meta = sessionMeta?.[currentIndex];
      if (meta) {
        if (meta.firstAnswer === null || meta.firstAnswer === undefined) meta.firstAnswer = prev;
        if (prev !== null && prev !== undefined && prev !== optionIndex) meta.changes += 1;
      }

      sessionAnswers[currentIndex] = optionIndex;

      if (!Array.isArray(sessionSubmitted)) sessionSubmitted = [];
      // single-select questions submit immediately (Practice + Exam)
      if (!q || q.type !== 'multiselect') sessionSubmitted[currentIndex] = true;
      render();
    };    

    window.setConfidence = (level) => {
      if (!CONFIDENCE_LEVELS.includes(level)) return;
      const meta = sessionMeta?.[currentIndex];
      if (meta) meta.confidence = level;
      render();
    };
function recordTimeOnCurrentQuestion() {
      const meta = sessionMeta?.[currentIndex];
      if (!meta) return;
      const now = Date.now();
      if (meta.startAtMs && now >= meta.startAtMs) {
        meta.timeSpentSec += (now - meta.startAtMs) / 1000;
      }
      meta.startAtMs = now;
      currentQuestionEnteredAtMs = now;
    }

    function enterQuestion(index) {
      const meta = sessionMeta?.[index];
      const now = Date.now();
      if (meta) meta.startAtMs = now;
      currentQuestionEnteredAtMs = now;
    }

    window.nextQuestion = () => {
      recordTimeOnCurrentQuestion();
      if (currentIndex < sessionQuestions.length - 1) {
        currentIndex++;
        enterQuestion(currentIndex);
        render();
      }
    };
    window.previousQuestion = () => {
      recordTimeOnCurrentQuestion();
      if (currentIndex > 0) {
        currentIndex--;
        enterQuestion(currentIndex);
        render();
      }
    };
    window.finishQuiz = () => {
      recordTimeOnCurrentQuestion();
      stopQuizTimer();
      finalizeQuizTime();
      currentView = 'quizResults';
      render();
    };
    
    window.exitToSelection = () => {
      stopQuizTimer();
      currentView = 'selection';
      selectedTopics = [];
      sessionQuestions = [];
      sessionAnswers = [];
      sessionSubmitted = [];
      sessionStations = [];
      currentIndex = 0;
      currentStationChecklist = {};
      stationNotes = {};
      flaggedStations = [];
      render();
    };

    window.nextStation = () => { if (currentIndex < sessionStations.length - 1) { currentIndex++; currentTab = 'brief'; render(); } };
    window.previousStation = () => { if (currentIndex > 0) { currentIndex--; currentTab = 'brief'; render(); } };
    window.jumpToStation = (index) => { currentIndex = index; currentTab = 'brief'; render(); };
    window.switchTab = (tab) => { currentTab = tab; render(); };
    
    window.toggleChecklistItem = (stationId, item, checked) => {
      if (!currentStationChecklist[stationId]) currentStationChecklist[stationId] = {};
      currentStationChecklist[stationId][item] = checked;
      render();
    };
    window.updateStationNotes = (stationId, notes) => { stationNotes[stationId] = notes; };
    window.toggleFlag = () => {
      const stationId = sessionStations[currentIndex].id;
      const index = flaggedStations.indexOf(stationId);
      if (index > -1) flaggedStations.splice(index, 1);
      else flaggedStations.push(stationId);
      render();
    };
    window.finishOSCE = () => { currentView = 'osceResults'; render(); };

    // ==================== INITIALIZATION ====================
    async function onConfigChange(newConfig) {
      config = { ...config, ...newConfig };
      render();
    }

    window.finishOSCE = () => { currentView = 'osceResults'; render(); };

    // ===== Learning Resources Functions =====
    window.toggleLearningResources = function() {
            const resources = document.getElementById('learning-resources');
            const chevron = document.getElementById('resources-chevron');
            
            if (resources && chevron) {
                resources.classList.toggle('hidden');
                chevron.style.transform = resources.classList.contains('hidden') ? '' : 'rotate(180deg)';
                lucide.createIcons();
            }
        };

    window.toggleResourceTopic = function(topicId) {
            const content = document.getElementById('resource-' + topicId);
            const chevron = document.getElementById('resource-chevron-' + topicId);
            
            if (content && chevron) {
                content.classList.toggle('hidden');
                chevron.style.transform = content.classList.contains('hidden') ? '' : 'rotate(180deg)';
            }
        };

function renderLearningResources() {
            const resources = {
                cellBiology: {
                    title: '🔬 Cell Biology',
                    icon: 'microscope',
                    color: '#ec4899',
                    keyFacts: [
                        '<strong>Cell transport:</strong> Passive (no ATP) includes diffusion, osmosis, facilitated diffusion. Active transport requires ATP to move substances against concentration gradient.',
                        '<strong>Key organelles:</strong> Nucleus (genetic control), Mitochondria (ATP production), Ribosomes (protein synthesis), Golgi apparatus (protein modification/packaging).',
                        '<strong>Cell cycle phases:</strong> Interphase (G1, S, G2) for growth and DNA replication. Mitosis (PMAT) for cell division.',
                        '<strong>Cell membrane:</strong> Selectively permeable phospholipid bilayer. Controls substance movement in/out of cell.',
                        '<strong>Na⁺/K⁺ pump:</strong> 3 Na⁺ OUT, 2 K⁺ IN - active transport maintaining resting membrane potential.'
                    ],
                    deepInsights: [
                        '💡 <strong>Why mitochondria matter clinically:</strong> Mitochondrial diseases affect high-energy organs first (brain, heart, muscle). Inherited maternally only (egg contains mitochondria, sperm does not).',
                        '💡 <strong>Apoptosis vs Necrosis:</strong> Apoptosis = programmed cell death (controlled, no inflammation). Necrosis = traumatic death (uncontrolled, causes inflammation). Cancer cells evade apoptosis.',
                        '💡 <strong>Stem cells:</strong> Totipotent (first few divisions) → Pluripotent (can become any cell type) → Multipotent (limited differentiation). Understanding this helps explain regenerative medicine.',
                        '💡 <strong>Clinical link - Cystic Fibrosis:</strong> Defective CFTR chloride channel (cell membrane protein) → thick mucus → lung infections. Shows how one protein defect causes systemic disease.'
                    ],
                    examTips: [
                        '📝 Remember PMAT for mitosis: Prophase, Metaphase, Anaphase, Telophase',
                        '📝 DNA replication = S phase (Synthesis). Common exam question!',
                        '📝 Lysosomes = "suicide bags" - contain digestive enzymes for cellular recycling'
                    ]
                },
                homeostasis: {
                    title: '⚖️ Homeostasis',
                    icon: 'thermometer',
                    color: '#f59e0b',
                    keyFacts: [
                        '<strong>Normal temperature:</strong> 36.5-37.5°C for children. Fever >38°C, hypothermia <35°C.',
                        '<strong>Negative feedback:</strong> Most homeostatic mechanisms. Response counteracts original stimulus.',
                        '<strong>Thermoregulation:</strong> Cold = vasoconstriction + shivering. Heat = vasodilation + sweating.',
                        '<strong>Blood glucose:</strong> High glucose → insulin (lowers). Low glucose → glucagon (raises).',
                        '<strong>Normal blood pH:</strong> 7.35-7.45. Acidosis <7.35, Alkalosis >7.45.'
                    ],
                    deepInsights: [
                        '💡 <strong>Why children get hypothermic faster:</strong> Higher surface area to body mass ratio = more heat loss. Thin subcutaneous fat layer. Immature shivering response in infants. Always warm resuscitation equipment!',
                        '💡 <strong>Fever is protective:</strong> Raises body temp to inhibit pathogen growth and enhance immune function. Don\'t treat fever aggressively unless child is uncomfortable or at risk of febrile seizures.',
                        '💡 <strong>Buffer systems explained simply:</strong> CO₂ + H₂O ⇌ H₂CO₃ ⇌ H⁺ + HCO₃⁻. Lungs control CO₂ (fast), kidneys control HCO₃⁻ (slow). Respiratory compensation is minutes; renal is days.',
                        '💡 <strong>Positive feedback example:</strong> Oxytocin during labour - contractions → oxytocin release → stronger contractions → more oxytocin. Continues until baby delivered (removes stimulus).'
                    ],
                    examTips: [
                        '📝 "What maintains blood glucose?" - Insulin AND glucagon (both needed for balance)',
                        '📝 Negative feedback = most common. Only memorise the few positive feedback examples (labour, blood clotting, lactation)',
                        '📝 pH memory trick: 7.35-7.45 = "35-45 keeps you alive"'
                    ]
                },
                respiratory: {
                    title: '🫁 Respiratory System',
                    icon: 'wind',
                    color: '#06b6d4',
                    keyFacts: [
                        '<strong>Normal RR:</strong> Newborn 30-60, Infant 25-35, Toddler 20-30, School age 18-25, Adolescent 12-20/min.',
                        '<strong>Respiratory distress signs:</strong> Nasal flaring, head bobbing, recession (intercostal/subcostal), tracheal tug, grunting, cyanosis.',
                        '<strong>Stridor:</strong> Inspiratory = upper airway (croup, epiglottitis). Expiratory wheeze = lower airway (asthma, bronchiolitis).',
                        '<strong>SpO₂:</strong> Normal 94-98%. <92% in room air needs oxygen. Aim 94-98% (not 100% - oxygen toxicity risk).',
                        '<strong>Infant airways:</strong> Obligate nose breathers until 4-6 months. Narrow airways = easier obstruction.'
                    ],
                    deepInsights: [
                        '💡 <strong>Why grunting is serious:</strong> Baby exhales against partially closed glottis to maintain positive end-expiratory pressure (PEEP) and keep alveoli open. It\'s the body\'s attempt at self-CPAP. Always escalate!',
                        '💡 <strong>Croup vs Epiglottitis:</strong> Croup = viral, gradual onset, barking cough, can manage at home if mild. Epiglottitis = bacterial, rapid onset, toxic-looking, drooling, tripod position - EMERGENCY, don\'t examine throat!',
                        '💡 <strong>Bronchiolitis key points:</strong> RSV most common cause. <12 months typically. Supportive care only (oxygen, fluids, suction). Chest physio NOT recommended. No role for antibiotics, steroids, or bronchodilators.',
                        '💡 <strong>Why children desaturate faster:</strong> Higher O₂ consumption per kg, smaller functional residual capacity, horizontal ribs (less efficient expansion), diaphragm-dependent breathing.'
                    ],
                    examTips: [
                        '📝 "Barking cough" = croup. "Drooling + tripod" = epiglottitis',
                        '📝 Head bobbing in infants = using accessory muscles = significant distress',
                        '📝 Wheeze = bronchospasm. Stridor = airway narrowing. Know the difference!'
                    ]
                },
                cardiovascular: {
                    title: '❤️ Cardiovascular System',
                    icon: 'heart',
                    color: '#ef4444',
                    keyFacts: [
                        '<strong>Normal HR:</strong> Newborn 100-160, Infant 100-150, Toddler 90-140, School age 70-120, Adolescent 60-100 bpm.',
                        '<strong>Blood pressure:</strong> Systolic ≈ 80 + (age in years × 2). Hypotension is a LATE sign of shock in children.',
                        '<strong>Capillary refill:</strong> Normal <2 seconds. >3 seconds = poor perfusion.',
                        '<strong>Heart failure in infants:</strong> Tachycardia, hepatomegaly, poor feeding, sweating during feeds, failure to thrive.',
                        '<strong>Fetal shunts:</strong> Ductus venosus, Foramen ovale, Ductus arteriosus - all bypass lungs in utero.'
                    ],
                    deepInsights: [
                        '💡 <strong>Why BP is a late sign in children:</strong> Children compensate for hypovolaemia by increasing HR and SVR (vasoconstriction). BP maintained until 25-30% blood volume lost. By the time BP drops, child is critically unwell!',
                        '💡 <strong>Tetralogy of Fallot (4 defects):</strong> VSD + Overriding aorta + Pulmonary stenosis + RV hypertrophy. "Tet spells" = hypercyanotic episodes. Squat position increases SVR and reduces right-to-left shunting.',
                        '💡 <strong>Duct-dependent lesions:</strong> Some CHD relies on PDA staying open (e.g., transposition, critical coarctation). Prostaglandin E (PGE) infusion keeps duct open. Stopping PGE = death. Critical to understand!',
                        '💡 <strong>Innocent vs pathological murmurs:</strong> Innocent = asymptomatic, soft, systolic, varies with position, no radiation, no thrill. Pathological = symptomatic, loud, diastolic, fixed, radiates, associated thrill.'
                    ],
                    examTips: [
                        '📝 Valve flow order: "Try Pulling My Aorta" = Tricuspid → Pulmonary → Mitral → Aortic',
                        '📝 Umbilical VEIN carries oxygenated blood (unusual - veins usually deoxygenated)',
                        '📝 MAP = Diastolic + ⅓(Pulse Pressure). Know this formula!'
                    ]
                },
                childDevelopment: {
                    title: '👶 Child Development',
                    icon: 'baby',
                    color: '#8b5cf6',
                    keyFacts: [
                        '<strong>Gross motor:</strong> 6mo sits, 9mo crawls, 12mo stands, 15mo walks, 2yr runs, 3yr tricycle.',
                        '<strong>Fine motor:</strong> 6mo palmar grasp, 9mo pincer, 15mo tower of 2, 2yr tower of 6, 3yr copies circle.',
                        '<strong>Language:</strong> 6mo babbles, 12mo 1-3 words, 18mo 10-20 words, 2yr 2-word phrases, 3yr sentences.',
                        '<strong>Social:</strong> 6wk social smile, 9mo stranger anxiety, 2yr parallel play, 3yr cooperative play.',
                        '<strong>Fontanelles:</strong> Anterior closes 12-18mo, Posterior closes 2-3mo. Bulging = ↑ICP, Sunken = dehydration.'
                    ],
                    deepInsights: [
                        '💡 <strong>Red flags at any age:</strong> Loss of previously acquired skills (regression), no social smile by 8 weeks, not responding to sounds, persistent fisting beyond 3 months, asymmetric movement.',
                        '💡 <strong>Primitive reflexes:</strong> Present at birth, should disappear by 3-6 months as cortical control develops. Persistence suggests neurological problem. Moro = startle (gone by 4-6mo), Grasp = palm stimulation.',
                        '💡 <strong>Why stranger anxiety is good:</strong> Appears 7-9 months when object permanence develops. Shows healthy attachment and cognitive development - child recognises caregiver vs stranger. Reassure parents this is normal!',
                        '💡 <strong>Developmental screening tools:</strong> ASQ (Ages and Stages Questionnaire), Denver II, PEDS. Know your Trust\'s preferred tool. Screening ≠ diagnosis - always refer concerns.'
                    ],
                    examTips: [
                        '📝 "Walks at 1, runs at 2, tricycle at 3" - easy milestone memory',
                        '📝 Social smile by 6 WEEKS (not months) - common trick question',
                        '📝 Posterior fontanelle closes first (2-3mo), Anterior later (12-18mo)'
                    ]
                },
                genetics: {
                    title: '🧬 Genetics',
                    icon: 'dna',
                    color: '#10b981',
                    keyFacts: [
                        '<strong>Autosomal dominant:</strong> 50% risk if one parent affected. Only one copy needed. Examples: Huntington\'s, Marfan.',
                        '<strong>Autosomal recessive:</strong> 25% affected, 50% carriers, 25% unaffected if both parents carriers. Examples: CF, sickle cell.',
                        '<strong>X-linked recessive:</strong> Mainly affects males (XY). Females usually carriers. Examples: Duchenne, haemophilia.',
                        '<strong>Trisomy 21:</strong> Down syndrome. Most common chromosomal abnormality.',
                        '<strong>Trisomy 18:</strong> Edwards syndrome. More severe, most die within first year.'
                    ],
                    deepInsights: [
                        '💡 <strong>Why X-linked affects males:</strong> Males have XY - only one X chromosome. If that X carries the mutation, they\'re affected (no second X to compensate). Females (XX) have a backup copy, so usually just carriers.',
                        '💡 <strong>Mitochondrial inheritance:</strong> Always maternal (only egg contributes mitochondria). All children of affected mother inherit it. Father cannot pass on mitochondrial conditions.',
                        '💡 <strong>CF carrier frequency:</strong> 1 in 25 Caucasians are CF carriers. If both parents carriers: 1/25 × 1/25 × 1/4 = 1/2500 affected. Explains why it\'s the most common severe AR condition.',
                        '💡 <strong>Down syndrome features:</strong> Hypotonia, flat facial profile, upslanting eyes, single palmar crease, sandal gap toe, congenital heart defects (40-50%), increased leukaemia risk, early Alzheimer\'s.'
                    ],
                    examTips: [
                        '📝 "AD = 50%, AR = 25%" - core genetics ratios',
                        '📝 X-linked recessive: affected males, carrier females',
                        '📝 Trisomy 21 (Down) vs 18 (Edwards) vs 13 (Patau) - know the numbers!'
                    ]
                },
                fluidsElectrolytes: {
                    title: '💧 Fluids & Electrolytes',
                    icon: 'droplet',
                    color: '#3b82f6',
                    keyFacts: [
                        '<strong>TBW:</strong> Newborn 80%, Infant 70%, Child 60%, Adult 60%.',
                        '<strong>Dehydration:</strong> Mild <5%, Moderate 5-10%, Severe >10%.',
                        '<strong>Dehydration signs:</strong> Dry mucous membranes, reduced skin turgor, sunken fontanelle/eyes, tachycardia, reduced urine output.',
                        '<strong>Normal Na⁺:</strong> 135-145 mmol/L. Normal K⁺: 3.5-5.0 mmol/L.',
                        '<strong>Fluid bolus:</strong> 20 ml/kg of 0.9% saline for shock. Reassess and repeat.'
                    ],
                    deepInsights: [
                        '💡 <strong>Why infants dehydrate faster:</strong> Higher surface area:volume ratio (more insensible losses), higher metabolic rate (more water needed), immature kidneys (can\'t concentrate urine well), higher proportion of ECF.',
                        '💡 <strong>ORS science:</strong> Glucose-sodium cotransport in gut. Glucose pulls sodium, sodium pulls water. That\'s why ORS works better than plain water - it\'s absorbed faster. WHO-ORS is gold standard.',
                        '💡 <strong>Hyperkalaemia emergency:</strong> K⁺ >6.5 or ECG changes = emergency. Treatment: Calcium gluconate (cardiac protection), insulin+glucose (shifts K⁺ into cells), salbutamol (also shifts K⁺), dialysis (removes K⁺).',
                        '💡 <strong>Hyponatraemia correction:</strong> Correct slowly! Rapid correction causes osmotic demyelination syndrome (central pontine myelinolysis). Max 8-10 mmol/L per 24 hours.'
                    ],
                    examTips: [
                        '📝 Holliday-Segar: First 10kg = 100ml/kg, Next 10kg = 50ml/kg, Above 20kg = 20ml/kg',
                        '📝 Sunken fontanelle = moderate-severe dehydration (not mild)',
                        '📝 Shock bolus = 20ml/kg 0.9% saline. Always 0.9%, never hypotonic!'
                    ]
                },
                mentalHealth: {
                    title: '🧠 Mental Health',
                    icon: 'brain',
                    color: '#f472b6',
                    keyFacts: [
                        '<strong>Most common:</strong> Anxiety disorders are the most common mental health conditions in children.',
                        '<strong>Anxiety presentation:</strong> Often somatic - headaches, stomach aches, school refusal.',
                        '<strong>Depression in children:</strong> May present as irritability rather than sadness.',
                        '<strong>Suicide risk:</strong> Take ALL mentions of suicide/self-harm seriously. Ask directly - it doesn\'t plant ideas.',
                        '<strong>First-line treatment:</strong> CBT for mild-moderate anxiety/depression. Medication for moderate-severe.'
                    ],
                    deepInsights: [
                        '💡 <strong>Behaviour IS communication:</strong> Children lack vocabulary to express distress. A "naughty" child may be anxious, traumatised, or struggling. Always ask "what happened to this child?" not "what\'s wrong with them?"',
                        '💡 <strong>ACES (Adverse Childhood Experiences):</strong> Abuse, neglect, household dysfunction. More ACEs = higher risk of mental and physical health problems. Trauma-informed care is essential.',
                        '💡 <strong>Asking about suicide:</strong> "Are you having thoughts of hurting yourself or ending your life?" Direct questions are safer than hints. Document response clearly. Always escalate concerns.',
                        '💡 <strong>Self-harm vs suicide attempt:</strong> Self-harm (cutting, burning) is often about emotional regulation, not ending life. But it IS a risk factor for suicide. Both need assessment and support.'
                    ],
                    examTips: [
                        '📝 "Behaviour is communication" - key principle in paediatric mental health',
                        '📝 Ask about suicide directly - it\'s safe and necessary',
                        '📝 CAMHS = Child and Adolescent Mental Health Services (UK referral pathway)'
                    ]
                },
                nutrition: {
                    title: '🍎 Nutrition',
                    icon: 'apple',
                    color: '#84cc16',
                    keyFacts: [
                        '<strong>Exclusive breastfeeding:</strong> WHO recommends for 6 months, then continue with solids up to 2 years.',
                        '<strong>Cow\'s milk:</strong> Not as main drink before 12 months (low iron, renal solute load).',
                        '<strong>Weaning:</strong> Around 6 months. Introduce allergens early, not delayed.',
                        '<strong>Vitamin D:</strong> All breastfed babies need supplement (8.5-10 mcg daily). Prevents rickets.',
                        '<strong>Iron deficiency:</strong> Common in toddlers. Screen at-risk children. Causes anaemia, affects development.'
                    ],
                    deepInsights: [
                        '💡 <strong>Why introduce allergens early:</strong> LEAP study showed early peanut introduction (4-6 months) REDUCED allergy risk by 80%! Delayed introduction increases sensitisation risk. Paradigm shift from old advice.',
                        '💡 <strong>Breastmilk composition changes:</strong> Foremilk (watery, high lactose) → Hindmilk (creamy, high fat). Let baby finish one breast before switching. Colostrum (day 1-3) has more protein and antibodies.',
                        '💡 <strong>Why vitamin D supplementation:</strong> UK has limited sunlight, breastmilk has low vitamin D, darker skin produces less. Deficiency causes rickets (bone deformity). Formula is fortified, breastmilk isn\'t.',
                        '💡 <strong>Failure to thrive definition:</strong> Weight crossing 2+ centile lines downward, or weight <2nd centile. Calculate weight-for-age. Consider: inadequate intake, malabsorption, increased requirements, or non-organic causes.'
                    ],
                    examTips: [
                        '📝 "6 months exclusive breastfeeding" - WHO recommendation',
                        '📝 Introduce allergens EARLY (4-6 months) - new evidence!',
                        '📝 Cow\'s milk as drink from 12 months, in cooking from 6 months'
                    ]
                },
                giLiver: {
                    title: '🫄 GI/Liver',
                    icon: 'pill',
                    color: '#f97316',
                    keyFacts: [
                        '<strong>Gastroenteritis:</strong> Mostly viral. ORS first-line. IV only if severe/failed ORS.',
                        '<strong>Pyloric stenosis:</strong> 2-8 weeks, projectile non-bilious vomiting. Olive mass. Test feed shows peristalsis.',
                        '<strong>Biliary atresia:</strong> Prolonged jaundice + pale stools + dark urine = URGENT referral.',
                        '<strong>Bilious vomiting:</strong> GREEN vomit = surgical emergency until proven otherwise.',
                        '<strong>Coeliac disease:</strong> Gluten intolerance. FTT, diarrhoea, abdominal distension. Serology + biopsy.'
                    ],
                    deepInsights: [
                        '💡 <strong>Why bilious vomiting is urgent:</strong> Bile enters gut below ampulla of Vater. Green vomit = obstruction below this point = malrotation with volvulus until proven otherwise. Can cause bowel necrosis within hours. NEVER delay imaging!',
                        '💡 <strong>Biliary atresia timing:</strong> Kasai procedure (portoenterostomy) must be done before 60 days of age for best outcomes. Delayed diagnosis = liver transplant. Check stool colour chart! Pale/chalky = refer urgently.',
                        '💡 <strong>Pyloric stenosis pathophysiology:</strong> Hypertrophied pyloric muscle causes gastric outlet obstruction. Vomiting loses H⁺ and Cl⁻ → hypochloraemic hypokalaemic metabolic ALKALOSIS (the vomiting paradox).',
                        '💡 <strong>Intussusception classic triad:</strong> Intermittent severe colicky pain, "redcurrant jelly" stools, sausage-shaped mass. Peak age 3-12 months. Air/contrast enema is diagnostic AND therapeutic.'
                    ],
                    examTips: [
                        '📝 "Green vomit = surgical emergency" - never forget this!',
                        '📝 Pyloric stenosis = ALKALOSIS (losing acid), not acidosis',
                        '📝 Prolonged jaundice + pale stools = biliary atresia until proven otherwise'
                    ]
                },
                endocrine: {
                    title: '🦋 Endocrine',
                    icon: 'activity',
                    color: '#a855f7',
                    keyFacts: [
                        '<strong>Type 1 diabetes:</strong> Most common childhood endocrine disorder. Absolute insulin deficiency.',
                        '<strong>DKA presentation:</strong> Polyuria, polydipsia, weight loss, vomiting, abdominal pain, Kussmaul breathing, fruity breath.',
                        '<strong>Hypoglycaemia:</strong> <4 mmol/L. Treat with fast-acting carbs. If unconscious: IM glucagon or IV glucose.',
                        '<strong>HbA1c target:</strong> <48 mmol/mol ideal. Balance control with hypoglycaemia risk.',
                        '<strong>Congenital hypothyroidism:</strong> Newborn bloodspot screening. Treat with levothyroxine. Prevents developmental delay.'
                    ],
                    deepInsights: [
                        '💡 <strong>DKA cerebral oedema risk:</strong> Most dangerous DKA complication. Risk factors: young age, new diagnosis, high urea, severe acidosis, rapid fluid correction. Fluid replacement must be SLOW (over 48 hours). Signs: headache, confusion, bradycardia, hypertension.',
                        '💡 <strong>Honeymoon period:</strong> After T1DM diagnosis, some residual beta cells may recover temporarily. Insulin needs decrease. Parents may think child is "cured". Warn them this is temporary (weeks-months).',
                        '💡 <strong>Sick day rules for diabetes:</strong> Never stop insulin (need MORE during illness). Check BG and ketones frequently. Extra fluids. Adjust doses. Clear guidance prevents DKA admissions.',
                        '💡 <strong>Why newborn thyroid screening matters:</strong> Congenital hypothyroidism affects 1:3000. Brain development depends on thyroid hormone in first 2 years. Without treatment = severe intellectual disability. With early treatment = normal development.'
                    ],
                    examTips: [
                        '📝 DKA fluids = SLOW (48 hours). Rapid = cerebral oedema risk',
                        '📝 Hypoglycaemia = <4 mmol/L. "Four is the floor"',
                        '📝 Kussmaul breathing = deep, rapid breathing to blow off CO₂ (compensating for acidosis)'
                    ]
                },
                skin: {
                    title: '🧴 Skin/Dermatology',
                    icon: 'shield',
                    color: '#ec4899',
                    keyFacts: [
                        '<strong>Eczema management:</strong> Emollients are foundation (use lots, frequently). Topical steroids for flares.',
                        '<strong>Non-blanching rash:</strong> Does NOT fade with glass test. Could be meningococcal septicaemia - URGENT.',
                        '<strong>Impetigo:</strong> Bacterial (Staph/Strep). Honey-crusted lesions. Topical/oral antibiotics.',
                        '<strong>Nappy rash:</strong> Barrier cream, frequent changes, nappy-free time. Consider Candida if persistent.',
                        '<strong>Molluscum contagiosum:</strong> Viral. Pearly papules with central dimple. Self-limiting.'
                    ],
                    deepInsights: [
                        '💡 <strong>Glass test explained:</strong> Press clear glass firmly against rash. Blanching (fades) = increased blood flow, likely viral/allergic. Non-blanching = blood leaked from vessels = petechiae/purpura = possible meningococcal sepsis or other serious causes.',
                        '💡 <strong>Eczema and the atopic march:</strong> Eczema → allergic rhinitis → asthma. Skin barrier dysfunction allows allergen sensitisation. Good eczema control may help prevent allergic diseases.',
                        '💡 <strong>Steroid phobia:</strong> Parents often under-treat due to steroid fears. Explain: "fingertip units", use appropriate strength for body area, short courses are safe, untreated eczema causes more harm than topical steroids.',
                        '💡 <strong>When is a birthmark concerning:</strong> Haemangiomas: most involute naturally by 5-7 years. Refer if: near eye (amblyopia risk), airway (breathing), large/multiple (PHACES syndrome), ulcerated, or segmental pattern.'
                    ],
                    examTips: [
                        '📝 "Non-blanching rash = meningococcal until proven otherwise"',
                        '📝 Eczema: EMOLLIENTS EMOLLIENTS EMOLLIENTS (foundation of treatment)',
                        '📝 Honey-crusted lesions = impetigo'
                    ]
                },
                musculoskeletal: {
                    title: '🦴 Musculoskeletal',
                    icon: 'bone',
                    color: '#6366f1',
                    keyFacts: [
                        '<strong>DDH screening:</strong> Barlow (dislocates) and Ortolani (relocates) tests at birth and 6-8 weeks.',
                        '<strong>DDH risk factors:</strong> Breech, female, first-born, family history.',
                        '<strong>Limp + fever:</strong> Septic arthritis until proven otherwise. URGENT.',
                        '<strong>SUFE:</strong> 10-16 years. Hip/knee pain, externally rotated leg. X-ray frog-leg lateral.',
                        '<strong>Growing pains:</strong> Bilateral, muscular, evening/night, no limp or swelling. Benign.'
                    ],
                    deepInsights: [
                        '💡 <strong>Septic arthritis is time-critical:</strong> Bacteria in joint space destroy cartilage within hours. Hot, swollen joint + fever + unable to weight-bear = joint aspiration and IV antibiotics URGENTLY. Delay = permanent joint damage.',
                        '💡 <strong>Kocher criteria for septic arthritis:</strong> 1) Fever >38.5°C, 2) Non-weight-bearing, 3) ESR >40, 4) WCC >12. 4/4 criteria = 99% probability of septic arthritis.',
                        '💡 <strong>SUFE mechanism:</strong> Femoral head slips posteriorly off the neck through the growth plate. Risk factors: obesity, male, adolescent growth spurt. Bilateral in 20-40%. Avascular necrosis is major complication.',
                        '💡 <strong>The limping child differential by age:</strong> Toddler (1-3y): transient synovitis, trauma, infection. Child (4-10y): Perthes, transient synovitis. Adolescent (10-16y): SUFE, Osgood-Schlatter.'
                    ],
                    examTips: [
                        '📝 "Limp + fever = septic arthritis until proven otherwise"',
                        '📝 SUFE presents with KNEE pain (referred) - don\'t forget to examine the hip!',
                        '📝 Growing pains: NEVER cause limp, swelling, or morning stiffness'
                    ]
                },
                renal: {
                    title: '🫘 Renal System',
                    icon: 'droplets',
                    color: '#0ea5e9',
                    keyFacts: [
                        '<strong>UTI organism:</strong> E. coli causes ~80% of childhood UTIs.',
                        '<strong>Urine output:</strong> Normal = 1 ml/kg/hr. Oliguria = <0.5 ml/kg/hr.',
                        '<strong>Nephrotic syndrome triad:</strong> Proteinuria, hypoalbuminaemia, oedema.',
                        '<strong>UTI in infants:</strong> Presents with fever, poor feeding, irritability - NOT dysuria (can\'t report).',
                        '<strong>VUR:</strong> Backflow from bladder to kidneys. Risk factor for recurrent UTI and renal scarring.'
                    ],
                    deepInsights: [
                        '💡 <strong>Why UTI investigation matters:</strong> Children <6 months with first UTI need ultrasound - looking for structural abnormalities (VUR, obstruction). Early detection and treatment prevents renal scarring → hypertension → chronic kidney disease.',
                        '💡 <strong>Nephrotic vs Nephritic:</strong> Nephrotic = protein loss (massive proteinuria, oedema, normal BP). Nephritic = inflammation (haematuria, hypertension, mild proteinuria). Different diseases, different management.',
                        '💡 <strong>UTI sample collection:</strong> Clean catch for toilet-trained children. For infants: catheter sample or suprapubic aspirate (gold standard). Bag specimens have high contamination rate - only useful if negative.',
                        '💡 <strong>Minimal change nephrotic syndrome:</strong> Most common cause of nephrotic syndrome in children. Usually responds to steroids (steroid-sensitive). Relapses common. Complications: infection (lost antibodies), thrombosis (lost anticoagulant proteins).'
                    ],
                    examTips: [
                        '📝 E. coli = 80% of UTIs (most common organism)',
                        '📝 UTI in infants = non-specific symptoms (fever, irritability, poor feeding)',
                        '📝 Nephrotic = PROTEIN loss. Nephritic = BLOOD loss'
                    ]
                },
                breastfeeding: {
                    title: '🤱 Breastfeeding',
                    icon: 'heart',
                    color: '#f472b6',
                    keyFacts: [
                        '<strong>Colostrum:</strong> Day 1-3. Thick, yellow, antibody-rich. Small volumes normal.',
                        '<strong>Mature milk:</strong> Comes in day 3-5. Expect breast fullness.',
                        '<strong>Frequency:</strong> 8-12 feeds per 24 hours. Responsive/demand feeding.',
                        '<strong>Good latch:</strong> Wide mouth, nipple + areola in mouth, chin touching breast, no pain.',
                        '<strong>Adequate intake signs:</strong> 6+ wet nappies/day by day 5, audible swallowing, content after feeds.'
                    ],
                    deepInsights: [
                        '💡 <strong>Prolactin and oxytocin:</strong> Prolactin = milk PRODUCTION (produced with suckling). Oxytocin = milk EJECTION/let-down (released with suckling, baby cry, or thoughts of baby). Stress inhibits oxytocin → impairs let-down.',
                        '💡 <strong>Supply and demand:</strong> More suckling = more prolactin = more milk. This is why formula supplementation can reduce supply - baby suckles less. Also why pumping/expressing maintains supply when separated.',
                        '💡 <strong>Tongue-tie (ankyloglossia):</strong> Tight frenulum restricts tongue movement → poor latch → ineffective feeding → nipple pain → poor weight gain. Division (frenotomy) often improves feeding. Not all tongue-ties need treatment.',
                        '💡 <strong>Mastitis management:</strong> Continue breastfeeding from affected breast (helps drainage). Ibuprofen for pain/inflammation. Antibiotics if: fever, flu-like symptoms, or no improvement in 24 hours. NOT a reason to stop breastfeeding!'
                    ],
                    examTips: [
                        '📝 Prolactin = Production. Oxytocin = "Out" (ejection)',
                        '📝 Painful breastfeeding = poor latch (not normal!)',
                        '📝 Continue breastfeeding with mastitis - stopping makes it worse'
                    ]
                },
                hospitalPrep: {
                    title: '🏥 Hospital Preparation',
                    icon: 'building-2',
                    color: '#64748b',
                    keyFacts: [
                        '<strong>Timing:</strong> School-age: 1-2 weeks before. Toddlers: 2-3 days (limited time concept).',
                        '<strong>Language:</strong> Avoid "going to sleep" (death association). Use simple, honest terms.',
                        '<strong>Therapeutic play:</strong> Medical play with dolls helps rehearse, express fears, gain control.',
                        '<strong>Never promise no pain:</strong> Say "you might feel pressure/pinch". Builds trust.',
                        '<strong>Parental presence:</strong> Usually beneficial. Prepare parents too - their anxiety transfers.'
                    ],
                    deepInsights: [
                        '💡 <strong>Developmental understanding:</strong> Infants: comfort from parents\' presence. Toddlers: fear of separation, concrete thinking, prepare 2-3 days before. Preschool: magical thinking (may blame themselves), use play. School-age: can understand cause/effect, involve in decisions. Adolescents: privacy important, peer support.',
                        '💡 <strong>Why honesty matters:</strong> Children remember deception. "It won\'t hurt" followed by pain = broken trust = worse anxiety for future procedures. Honest preparation: "You might feel a pinch, and I\'ll help you through it."',
                        '💡 <strong>Distraction techniques:</strong> Bubbles (controls breathing), counting, I-spy, videos, music, virtual reality. Work by competing for attention in the brain. More effective when started BEFORE procedure, not during.',
                        '💡 <strong>Play specialist role:</strong> Trained to prepare children for procedures, provide distraction during, and help process experiences after. Underutilised resource - involve early! Reduces sedation needs and procedure time.'
                    ],
                    examTips: [
                        '📝 "Therapeutic play helps children express what they can\'t verbalise"',
                        '📝 Never say "going to sleep" for anaesthesia - children may fear not waking',
                        '📝 Toddler preparation: 2-3 days before (limited concept of time)'
                    ]
                },
                numeracy: {
                    title: '🔢 Drug Calculations',
                    icon: 'calculator',
                    color: '#14b8a6',
                    keyFacts: [
                        '<strong>Weight-based:</strong> Dose (mg) = Weight (kg) × Dose per kg.',
                        '<strong>Volume to give:</strong> Volume = What you WANT ÷ What you\'ve GOT (per ml).',
                        '<strong>Infusion rate:</strong> Rate (ml/hr) = Volume (ml) ÷ Time (hours).',
                        '<strong>Holliday-Segar:</strong> 0-10kg: 100ml/kg. 10-20kg: +50ml/kg. >20kg: +20ml/kg.',
                        '<strong>Conversions:</strong> 1g = 1000mg. 1mg = 1000mcg. 1L = 1000ml.'
                    ],
                    deepInsights: [
                        '💡 <strong>Why paediatric dosing is high-risk:</strong> 10-fold errors are common (decimal point errors). Doses per kg vary hugely between drugs. Children can\'t tell you if something\'s wrong. Always double-check, use calculators, and sense-check ("does this volume seem right for a baby?").',
                        '💡 <strong>Holliday-Segar logic:</strong> Based on metabolic rate and surface area. Smaller children have higher metabolic rate per kg, so need more fluid per kg. Larger children\'s needs plateau. HOURLY rate = 24hr total ÷ 24.',
                        '💡 <strong>Common calculation errors:</strong> 1) Wrong units (mg vs mcg). 2) Wrong weight (always recheck). 3) Decimal errors. 4) Forgetting maximum doses. 5) Wrong concentration from stock.',
                        '💡 <strong>Safety checks:</strong> Right patient, right drug, right dose, right route, right time. Two-person independent check for high-risk drugs. If answer seems wrong, STOP and recalculate.'
                    ],
                    examTips: [
                        '📝 Always show your working in calculations',
                        '📝 Check units match before calculating',
                        '📝 Holliday-Segar: 100-50-20 rule (ml/kg/day for each 10kg bracket)'
                    ]
                }
            };

            return Object.entries(resources).map(function([id, data]) {
              var keyFactsHtml = data.keyFacts.map(function(point) {
                return '<li class="text-slate-300 text-sm pl-4 border-l-2 border-purple-500 border-opacity-30">' + point + '</li>';
              }).join('');
              
              var insightsHtml = data.deepInsights.map(function(point) {
                return '<li class="text-slate-200 text-sm leading-relaxed">' + point + '</li>';
              }).join('');
              
              var tipsHtml = data.examTips.map(function(tip) {
                return '<li class="text-slate-300 text-sm">' + tip + '</li>';
              }).join('');
              
              return '<div class="bg-white bg-opacity-5 rounded-xl overflow-hidden border border-white border-opacity-10">' +
                '<button onclick="toggleResourceTopic(\'' + id + '\')" class="w-full p-4 flex items-center justify-between hover:bg-white hover:bg-opacity-5 transition-all">' +
                  '<div class="flex items-center gap-3">' +
                    '<div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background: ' + data.color + '22; border: 1px solid ' + data.color + '44;">' +
                      '<span class="text-lg">' + data.title.split(' ')[0] + '</span>' +
                    '</div>' +
                    '<span class="text-white font-semibold">' + data.title + '</span>' +
                  '</div>' +
                  '<i id="resource-chevron-' + id + '" data-lucide="chevron-down" class="w-5 h-5 text-slate-400 transition-transform"></i>' +
                '</button>' +
                '<div id="resource-' + id + '" class="hidden px-4 pb-4">' +
                  '<div class="mb-4">' +
                    '<h4 class="text-purple-300 font-bold text-sm mb-2 flex items-center gap-2"><span>📋</span> KEY FACTS</h4>' +
                    '<ul class="space-y-2">' + keyFactsHtml + '</ul>' +
                  '</div>' +
                  '<div class="mb-4 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg p-4">' +
                    '<h4 class="text-pink-300 font-bold text-sm mb-2 flex items-center gap-2"><span>🧠</span> DEEP INSIGHTS & CLINICAL PEARLS</h4>' +
                    '<ul class="space-y-3">' + insightsHtml + '</ul>' +
                  '</div>' +
                  '<div class="bg-yellow-500/10 rounded-lg p-4">' +
                    '<h4 class="text-yellow-300 font-bold text-sm mb-2 flex items-center gap-2"><span>✏️</span> EXAM TIPS</h4>' +
                    '<ul class="space-y-2">' + tipsHtml + '</ul>' +
                  '</div>' +
                '</div>' +
              '</div>';
            }).join('');
        }

   // ==================== INITIALIZATION ====================
   function init() {
     createParticles();
     render();
   }

   init();
 </script>
</body>
</html>
